"use strict";(self.webpackChunkdocument_management=self.webpackChunkdocument_management||[]).push([[96],{4630:(si,ot,D)=>{D.d(ot,{z:()=>Pt});var B=D(8966),I=D(2075),he=D(2676),X=D(3075),l=D(5e3),ve=D(7033),Se=D(2457),j=D(6107),re=D(7322),ce=D(4107),He=D(9808),at=D(7446),W=D(508),Oe=D(7531),Ce=D(6856),Ne=D(2925);function O(M,H){if(1&M&&(l.TgZ(0,"span"),l.TgZ(1,"p"),l._uU(2),l.qZA(),l.qZA()),2&M){const S=l.oxw();l.xp6(2),l.hij(" ",S.selectedRoles[0].name," ")}}function ge(M,H){if(1&M&&(l.TgZ(0,"span",18),l._uU(1),l.qZA()),2&M){const S=l.oxw();l.xp6(1),l.AsE(" (+",S.selectedRoles.length-1," ",2===S.selectedRoles.length?"other":"others",") ")}}function r(M,H){if(1&M&&(l.TgZ(0,"mat-option",19),l._uU(1),l.qZA()),2&M){const S=H.$implicit;l.Q6J("value",S),l.xp6(1),l.hij(" ",S.name," ")}}function K(M,H){1&M&&(l.TgZ(0,"mat-error"),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"START_DATE_IS_REQURED")," "))}function Je(M,H){1&M&&(l.TgZ(0,"mat-error"),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"END_DATE_IS_REQURED")," "))}function tt(M,H){if(1&M&&(l.TgZ(0,"div",9),l.TgZ(1,"div",20),l.TgZ(2,"mat-form-field",21),l.TgZ(3,"mat-label"),l._uU(4),l.ALo(5,"translate"),l.qZA(),l._UZ(6,"input",22),l._UZ(7,"mat-datepicker-toggle",23),l._UZ(8,"mat-datepicker",null,24),l.YNc(10,K,3,3,"mat-error",6),l.qZA(),l.qZA(),l.TgZ(11,"div",20),l.TgZ(12,"mat-form-field",21),l.TgZ(13,"mat-label"),l._uU(14),l.ALo(15,"translate"),l.qZA(),l._UZ(16,"input",25),l._UZ(17,"mat-datepicker-toggle",23),l._UZ(18,"mat-datepicker",null,26),l.YNc(20,Je,3,3,"mat-error",6),l.qZA(),l.qZA(),l.qZA()),2&M){const S=l.MAs(9),V=l.MAs(19),$=l.oxw();l.xp6(4),l.Oqu(l.lcZ(5,10,"CHOOSE_A_START_DATE")),l.xp6(2),l.Q6J("min",$.minDate)("matDatepicker",S),l.xp6(1),l.Q6J("for",S),l.xp6(3),l.Q6J("ngIf",$.permissionForm.get("startDate").touched&&(null==$.permissionForm.get("startDate").errors?null:$.permissionForm.get("startDate").errors.required)),l.xp6(4),l.Oqu(l.lcZ(15,12,"CHOOSE_A_END_DATE")),l.xp6(2),l.Q6J("min",$.permissionForm.get("startDate").value)("matDatepicker",V),l.xp6(1),l.Q6J("for",V),l.xp6(3),l.Q6J("ngIf",$.permissionForm.get("endDate").touched&&(null==$.permissionForm.get("endDate").errors?null:$.permissionForm.get("endDate").errors.required))}}let st=(()=>{class M extends he.H{constructor(S,V,$,ue,ut,yt){super(),this.documentPermissionService=S,this.toastrService=V,this.data=$,this.dialogRef=ue,this.fb=ut,this.translationService=yt,this.selectedRoles=[],this.minDate=new Date}ngOnInit(){this.createUserPermissionForm()}createUserPermissionForm(){this.permissionForm=this.fb.group({isTimeBound:new X.NI(!1),startDate:[""],endDate:[""],isAllowDownload:new X.NI(!1)})}timeBoundChange(S){S.checked?(this.permissionForm.get("startDate").setValidators([X.kI.required]),this.permissionForm.get("endDate").setValidators([X.kI.required])):(this.permissionForm.get("startDate").clearValidators(),this.permissionForm.get("startDate").updateValueAndValidity(),this.permissionForm.get("endDate").clearValidators(),this.permissionForm.get("endDate").updateValueAndValidity())}saveDocumentRolePermission(){if(!this.permissionForm.valid)return void this.permissionForm.markAllAsTouched();if(0==this.selectedRoles.length)return void this.toastrService.error(this.translationService.getValue("PLEASE_SELECT_ATLEAST_ONE_ROLE"));let S=this.selectedRoles.map(V=>Object.assign({},{id:"",documentId:this.data.documentId,roleId:V.id},this.permissionForm.value));this.sub$.sink=this.documentPermissionService.addDocumentRolePermission(S).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_ADDED_SUCCESSFULLY")),this.dialogRef.close(!0)})}onNoClick(){this.dialogRef.close()}}return M.\u0275fac=function(S){return new(S||M)(l.Y36(ve.m),l.Y36(Se._W),l.Y36(B.WI),l.Y36(B.so),l.Y36(X.qu),l.Y36(j.D))},M.\u0275cmp=l.Xpm({type:M,selectors:[["app-manage-role-permission"]],features:[l.qOj],decls:32,vars:21,consts:[["mat-dialog-title",""],["mat-dialog-content","",3,"formGroup"],[1,"row"],[1,"form-group","col-md-12"],["appearance","fill",1,"full-width"],["multiple","",3,"value","valueChange"],[4,"ngIf"],["class","example-additional-selection",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-12","row"],["color","primary","formControlName","isTimeBound",3,"change"],["class","col-md-12 row",4,"ngIf"],["color","primary","formControlName","isAllowDownload"],["mat-dialog-actions",""],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-right-10",3,"click"],[1,"las","la-save"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"las","la-times-circle"],[1,"example-additional-selection"],[3,"value"],[1,"form-group","col-md-6"],["appearance","fill"],["formControlName","startDate","matInput","",3,"min","matDatepicker"],["matSuffix","",3,"for"],["startDatePicker",""],["formControlName","endDate","matInput","",3,"min","matDatepicker"],["endDatePicker",""]],template:function(S,V){1&S&&(l.TgZ(0,"h1",0),l._uU(1,"Role Permission"),l.qZA(),l.TgZ(2,"div",1),l.TgZ(3,"div",2),l.TgZ(4,"div",3),l.TgZ(5,"mat-form-field",4),l.TgZ(6,"mat-label"),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.TgZ(9,"mat-select",5),l.NdJ("valueChange",function(ue){return V.selectedRoles=ue}),l.TgZ(10,"mat-select-trigger"),l.YNc(11,O,3,1,"span",6),l.YNc(12,ge,2,2,"span",7),l.qZA(),l.YNc(13,r,2,2,"mat-option",8),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(14,"div",9),l.TgZ(15,"mat-checkbox",10),l.NdJ("change",function(ue){return V.timeBoundChange(ue)}),l._uU(16),l.ALo(17,"translate"),l.qZA(),l.qZA(),l.YNc(18,tt,21,14,"div",11),l.TgZ(19,"div",9),l.TgZ(20,"mat-checkbox",12),l._uU(21),l.ALo(22,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(23,"div",13),l.TgZ(24,"button",14),l.NdJ("click",function(){return V.saveDocumentRolePermission()}),l._UZ(25,"i",15),l._uU(26),l.ALo(27,"translate"),l.qZA(),l.TgZ(28,"button",16),l.NdJ("click",function(){return V.onNoClick()}),l._UZ(29,"i",17),l._uU(30),l.ALo(31,"translate"),l.qZA(),l.qZA()),2&S&&(l.xp6(2),l.Q6J("formGroup",V.permissionForm),l.xp6(5),l.Oqu(l.lcZ(8,11,"ROLES")),l.xp6(2),l.Q6J("value",V.selectedRoles),l.xp6(2),l.Q6J("ngIf",V.selectedRoles.length>0),l.xp6(1),l.Q6J("ngIf",V.selectedRoles.length>1),l.xp6(1),l.Q6J("ngForOf",V.data.roles),l.xp6(3),l.hij(" ",l.lcZ(17,13,"SPACIFY_THE_PERIOD"),""),l.xp6(2),l.Q6J("ngIf",V.permissionForm.get("isTimeBound").value),l.xp6(3),l.Oqu(l.lcZ(22,15,"ALLOW_DOWNLOAD")),l.xp6(5),l.hij(" ",l.lcZ(27,17,"SAVE")," "),l.xp6(4),l.hij(" ",l.lcZ(31,19,"CANCEL")," "))},directives:[B.uh,B.xY,X.JL,X.sg,re.KE,re.hX,ce.gD,ce.$L,He.O5,He.sg,at.oG,X.JJ,X.u,B.H8,W.ey,X.Fj,Oe.Nt,Ce.hl,Ce.nW,re.R9,Ce.Mq,re.TO],pipes:[Ne.X$],styles:[""]}),M})();function Ze(M,H){if(1&M&&(l.TgZ(0,"span"),l.TgZ(1,"p"),l._uU(2),l.qZA(),l.qZA()),2&M){const S=l.oxw();l.xp6(2),l.lnq(" ",S.selectedUsers[0].firstName," ",S.selectedUsers[0].lastName," (",S.selectedUsers[0].userName,") ")}}function nt(M,H){if(1&M&&(l.TgZ(0,"span",18),l._uU(1),l.qZA()),2&M){const S=l.oxw();l.xp6(1),l.AsE(" (+",S.selectedUsers.length-1," ",2===S.selectedUsers.length?"other":"others",") ")}}function _t(M,H){if(1&M&&(l.TgZ(0,"mat-option",19),l._uU(1),l.qZA()),2&M){const S=H.$implicit;l.Q6J("value",S),l.xp6(1),l.lnq(" ",S.firstName," ",S.lastName," (",S.userName,") ")}}function lt(M,H){1&M&&(l.TgZ(0,"mat-error"),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"START_DATE_IS_REQURED")," "))}function ct(M,H){1&M&&(l.TgZ(0,"mat-error"),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"END_DATE_IS_REQURED")," "))}function qt(M,H){if(1&M&&(l.TgZ(0,"div",9),l.TgZ(1,"div",20),l.TgZ(2,"mat-form-field",21),l.TgZ(3,"mat-label"),l._uU(4),l.ALo(5,"translate"),l.qZA(),l._UZ(6,"input",22),l._UZ(7,"mat-datepicker-toggle",23),l._UZ(8,"mat-datepicker",null,24),l.YNc(10,lt,3,3,"mat-error",6),l.qZA(),l.qZA(),l.TgZ(11,"div",20),l.TgZ(12,"mat-form-field",21),l.TgZ(13,"mat-label"),l._uU(14),l.ALo(15,"translate"),l.qZA(),l._UZ(16,"input",25),l._UZ(17,"mat-datepicker-toggle",23),l._UZ(18,"mat-datepicker",null,26),l.YNc(20,ct,3,3,"mat-error",6),l.qZA(),l.qZA(),l.qZA()),2&M){const S=l.MAs(9),V=l.MAs(19),$=l.oxw();l.xp6(4),l.Oqu(l.lcZ(5,10,"CHOOSE_A_START_DATE")),l.xp6(2),l.Q6J("min",$.minDate)("matDatepicker",S),l.xp6(1),l.Q6J("for",S),l.xp6(3),l.Q6J("ngIf",$.permissionForm.get("startDate").touched&&(null==$.permissionForm.get("startDate").errors?null:$.permissionForm.get("startDate").errors.required)),l.xp6(4),l.Oqu(l.lcZ(15,12,"CHOOSE_A_END_DATE")),l.xp6(2),l.Q6J("min",$.permissionForm.get("startDate").value)("matDatepicker",V),l.xp6(1),l.Q6J("for",V),l.xp6(3),l.Q6J("ngIf",$.permissionForm.get("startDate").touched&&(null==$.permissionForm.get("endDate").errors?null:$.permissionForm.get("endDate").errors.required))}}let $t=(()=>{class M extends he.H{constructor(S,V,$,ue,ut,yt){super(),this.documentPermissionService=S,this.toastrService=V,this.data=$,this.dialogRef=ue,this.fb=ut,this.translationService=yt,this.selectedUsers=[],this.minDate=new Date}ngOnInit(){this.createUserPermissionForm()}createUserPermissionForm(){this.permissionForm=this.fb.group({isTimeBound:new X.NI(!1),startDate:[""],endDate:[""],isAllowDownload:new X.NI(!1)})}timeBoundChange(S){S.checked?(this.permissionForm.get("startDate").setValidators([X.kI.required]),this.permissionForm.get("endDate").setValidators([X.kI.required])):(this.permissionForm.get("startDate").clearValidators(),this.permissionForm.get("startDate").updateValueAndValidity(),this.permissionForm.get("endDate").clearValidators(),this.permissionForm.get("endDate").updateValueAndValidity())}saveDocumentUserPermission(){if(!this.permissionForm.valid)return void this.permissionForm.markAllAsTouched();if(0==this.selectedUsers.length)return void this.toastrService.error(this.translationService.getValue("PLEASE_SELECT_ATLEAST_ONE_USER"));let S=this.selectedUsers.map(V=>Object.assign({},{id:"",documentId:this.data.documentId,userId:V.id},this.permissionForm.value));this.sub$.sink=this.documentPermissionService.addDocumentUserPermission(S).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_ADDED_SUCCESSFULLY")),this.dialogRef.close(!0)})}onNoClick(){this.dialogRef.close()}}return M.\u0275fac=function(S){return new(S||M)(l.Y36(ve.m),l.Y36(Se._W),l.Y36(B.WI),l.Y36(B.so),l.Y36(X.qu),l.Y36(j.D))},M.\u0275cmp=l.Xpm({type:M,selectors:[["app-manage-user-permission"]],features:[l.qOj],decls:33,vars:24,consts:[["mat-dialog-title",""],["mat-dialog-content","",3,"formGroup"],[1,"row"],[1,"form-group","col-md-12"],["appearance","fill",1,"full-width"],["multiple","",3,"value","valueChange"],[4,"ngIf"],["class","example-additional-selection",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-12","row"],["color","primary","formControlName","isTimeBound",3,"change"],["class","col-md-12 row",4,"ngIf"],["color","primary","formControlName","isAllowDownload"],["mat-dialog-actions",""],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-right-10",3,"click"],[1,"las","la-save"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"las","la-times-circle"],[1,"example-additional-selection"],[3,"value"],[1,"form-group","col-md-6"],["appearance","fill"],["formControlName","startDate","matInput","",3,"min","matDatepicker"],["matSuffix","",3,"for"],["startDatePicker",""],["formControlName","endDate","matInput","",3,"min","matDatepicker"],["endDatePicker",""]],template:function(S,V){1&S&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"div",1),l.TgZ(4,"div",2),l.TgZ(5,"div",3),l.TgZ(6,"mat-form-field",4),l.TgZ(7,"mat-label"),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.TgZ(10,"mat-select",5),l.NdJ("valueChange",function(ue){return V.selectedUsers=ue}),l.TgZ(11,"mat-select-trigger"),l.YNc(12,Ze,3,3,"span",6),l.YNc(13,nt,2,2,"span",7),l.qZA(),l.YNc(14,_t,2,4,"mat-option",8),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(15,"div",9),l.TgZ(16,"mat-checkbox",10),l.NdJ("change",function(ue){return V.timeBoundChange(ue)}),l._uU(17),l.ALo(18,"translate"),l.qZA(),l.qZA(),l.YNc(19,qt,21,14,"div",11),l.TgZ(20,"div",9),l.TgZ(21,"mat-checkbox",12),l._uU(22),l.ALo(23,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(24,"div",13),l.TgZ(25,"button",14),l.NdJ("click",function(){return V.saveDocumentUserPermission()}),l._UZ(26,"i",15),l._uU(27),l.ALo(28,"translate"),l.qZA(),l.TgZ(29,"button",16),l.NdJ("click",function(){return V.onNoClick()}),l._UZ(30,"i",17),l._uU(31),l.ALo(32,"translate"),l.qZA(),l.qZA()),2&S&&(l.xp6(1),l.Oqu(l.lcZ(2,12,"USER_PERMISSION")),l.xp6(2),l.Q6J("formGroup",V.permissionForm),l.xp6(5),l.Oqu(l.lcZ(9,14,"USERS")),l.xp6(2),l.Q6J("value",V.selectedUsers),l.xp6(2),l.Q6J("ngIf",V.selectedUsers.length>0),l.xp6(1),l.Q6J("ngIf",V.selectedUsers.length>1),l.xp6(1),l.Q6J("ngForOf",V.data.users),l.xp6(3),l.hij(" ",l.lcZ(18,16,"SPACIFY_THE_PERIOD"),""),l.xp6(2),l.Q6J("ngIf",V.permissionForm.get("isTimeBound").value),l.xp6(3),l.Oqu(l.lcZ(23,18,"ALLOW_DOWNLOAD")),l.xp6(5),l.hij(" ",l.lcZ(28,20,"SAVE"),""),l.xp6(4),l.hij(" ",l.lcZ(32,22,"CANCEL"),""))},directives:[B.uh,B.xY,X.JL,X.sg,re.KE,re.hX,ce.gD,ce.$L,He.O5,He.sg,at.oG,X.JJ,X.u,B.H8,W.ey,X.Fj,Oe.Nt,Ce.hl,Ce.nW,re.R9,Ce.Mq,re.TO],pipes:[Ne.X$],styles:[""]}),M})();var Xt=D(914),en=D(2554),tn=D(5485),Ut=D(690),Ot=D(6087);const nn=["userPermissionsPaginator"];function rn(M,H){if(1&M&&(l.TgZ(0,"div",32),l.TgZ(1,"p"),l.TgZ(2,"b"),l._uU(3),l.ALo(4,"translate"),l.qZA(),l._uU(5),l.qZA(),l.qZA()),2&M){const S=l.oxw(2);l.xp6(3),l.hij("",l.lcZ(4,2,"DESCRIPTION"),":"),l.xp6(2),l.hij(" ",S.document.description,"")}}function J(M,H){if(1&M&&(l.TgZ(0,"div",29),l.TgZ(1,"div",30),l.TgZ(2,"p"),l.TgZ(3,"b"),l._uU(4),l.ALo(5,"translate"),l.qZA(),l._uU(6),l.qZA(),l.qZA(),l.YNc(7,rn,6,4,"div",31),l.qZA()),2&M){const S=l.oxw();l.xp6(4),l.hij("",l.lcZ(5,3,"DOCUMENT_NAME"),":"),l.xp6(2),l.hij(" ",S.document.name,""),l.xp6(1),l.Q6J("ngIf",S.document.description)}}function oe(M,H){1&M&&(l.TgZ(0,"th",33),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij("",l.lcZ(2,1,"ACTION")," "))}function b(M,H){if(1&M){const S=l.EpF();l.TgZ(0,"button",36),l.NdJ("click",function(){l.CHM(S);const $=l.oxw().$implicit;return l.oxw().deleteDocumentUserPermission($)}),l._UZ(1,"i",37),l._uU(2),l.ALo(3,"translate"),l.qZA()}2&M&&(l.xp6(2),l.hij(" ",l.lcZ(3,1,"DELETE"),""))}function k(M,H){if(1&M){const S=l.EpF();l.TgZ(0,"button",36),l.NdJ("click",function(){l.CHM(S);const $=l.oxw().$implicit;return l.oxw().deleteDocumentRolePermission($)}),l._UZ(1,"i",37),l._uU(2),l.ALo(3,"translate"),l.qZA()}2&M&&(l.xp6(2),l.hij(" ",l.lcZ(3,1,"DELETE"),""))}function Q(M,H){if(1&M&&(l.TgZ(0,"td",34),l.YNc(1,b,4,3,"button",35),l.YNc(2,k,4,3,"button",35),l.qZA()),2&M){const S=H.$implicit;l.xp6(1),l.Q6J("ngIf","User"==S.type),l.xp6(1),l.Q6J("ngIf","Role"==S.type)}}function ie(M,H){1&M&&(l.TgZ(0,"th",38),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij("",l.lcZ(2,1,"ALLOW_DOWNLOAD")," "))}function vt(M,H){1&M&&(l.ynx(0),l._uU(1),l.ALo(2,"translate"),l.BQk()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"YES")," "))}function Ge(M,H){1&M&&(l.ynx(0),l._uU(1),l.ALo(2,"translate"),l.BQk()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"NO")," "))}function bt(M,H){if(1&M&&(l.TgZ(0,"td",39),l.YNc(1,vt,3,3,"ng-container",40),l.YNc(2,Ge,3,3,"ng-container",40),l.qZA()),2&M){const S=H.$implicit;l.xp6(1),l.Q6J("ngIf",S.isAllowDownload),l.xp6(1),l.Q6J("ngIf",!S.isAllowDownload)}}function dt(M,H){1&M&&(l.TgZ(0,"th",38),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij("",l.lcZ(2,1,"TYPE")," "))}function Nt(M,H){if(1&M&&(l.TgZ(0,"td",39),l._uU(1),l.qZA()),2&M){const S=H.$implicit;l.xp6(1),l.hij(" ",S.type," ")}}function on(M,H){1&M&&(l.TgZ(0,"th",38),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"USER_ROLE_NAME")," "))}function Ae(M,H){if(1&M&&(l.TgZ(0,"span"),l._uU(1),l.qZA()),2&M){const S=l.oxw().$implicit;l.xp6(1),l.AsE(" ",S.user.firstName," ",S.user.lastName," ")}}function De(M,H){if(1&M&&(l.TgZ(0,"span"),l._uU(1),l.qZA()),2&M){const S=l.oxw().$implicit;l.xp6(1),l.hij(" ",S.role.name," ")}}function Yt(M,H){if(1&M&&(l.TgZ(0,"td",39),l.YNc(1,Ae,2,2,"span",40),l.YNc(2,De,2,1,"span",40),l.qZA()),2&M){const S=H.$implicit;l.xp6(1),l.Q6J("ngIf","User"==S.type),l.xp6(1),l.Q6J("ngIf","Role"==S.type)}}function kt(M,H){1&M&&(l.TgZ(0,"th",38),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"EMAIL")," "))}function Vn(M,H){if(1&M&&(l.TgZ(0,"span"),l._uU(1),l.qZA()),2&M){const S=l.oxw().$implicit;l.xp6(1),l.hij(" ",S.user.email," ")}}function Ht(M,H){1&M&&(l.TgZ(0,"span"),l._uU(1," -- "),l.qZA())}function Zt(M,H){if(1&M&&(l.TgZ(0,"td",39),l.YNc(1,Vn,2,1,"span",40),l.YNc(2,Ht,2,0,"span",40),l.qZA()),2&M){const S=H.$implicit;l.xp6(1),l.Q6J("ngIf","User"==S.type),l.xp6(1),l.Q6J("ngIf","Role"==S.type)}}function an(M,H){1&M&&(l.TgZ(0,"th",38),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"START_DATE")," "))}function Jt(M,H){if(1&M&&(l.ynx(0),l._uU(1),l.ALo(2,"date"),l.BQk()),2&M){const S=l.oxw().$implicit;l.xp6(1),l.hij(" ",l.xi3(2,1,S.startDate,"dd/MM/yyyy")," ")}}function qn(M,H){1&M&&(l.ynx(0),l._uU(1," -- "),l.BQk())}function Un(M,H){if(1&M&&(l.TgZ(0,"td",39),l.YNc(1,Jt,3,4,"ng-container",40),l.YNc(2,qn,2,0,"ng-container",40),l.qZA()),2&M){const S=H.$implicit;l.xp6(1),l.Q6J("ngIf",S.isTimeBound),l.xp6(1),l.Q6J("ngIf",!S.isTimeBound)}}function li(M,H){1&M&&(l.TgZ(0,"th",38),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&M&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"END_DATE")," "))}function sn(M,H){if(1&M&&(l.ynx(0),l._uU(1),l.ALo(2,"date"),l.BQk()),2&M){const S=l.oxw().$implicit;l.xp6(1),l.hij(" ",l.xi3(2,1,S.endDate,"dd/MM/yyyy")," ")}}function yn(M,H){1&M&&(l.ynx(0),l._uU(1," -- "),l.BQk())}function Ee(M,H){if(1&M&&(l.TgZ(0,"td",39),l.YNc(1,sn,3,4,"ng-container",40),l.YNc(2,yn,2,0,"ng-container",40),l.qZA()),2&M){const S=H.$implicit;l.xp6(1),l.Q6J("ngIf",S.isTimeBound),l.xp6(1),l.Q6J("ngIf",!S.isTimeBound)}}function ln(M,H){1&M&&l._UZ(0,"tr",41)}function xn(M,H){1&M&&l._UZ(0,"tr",42)}const Cn=function(){return[10,20,50,100]};let Pt=(()=>{class M extends he.H{constructor(S,V,$,ue,ut,yt,Dn,zt,Tn,Y){super(),this.documentService=S,this.documentPermissionService=V,this.route=$,this.commonDialogService=ue,this.toastrService=ut,this.dialog=yt,this.commonService=Dn,this.data=zt,this.dialogRef=Tn,this.translationService=Y,this.documentPermissions=[],this.users=[],this.roles=[],this.documentPermissionsColumns=["action","type","isAllowDownload","name","email","startDate","endDate"],this.document=zt}ngOnInit(){this.sub$.sink=this.route.params.subscribe(S=>{this.getDocumentPrmission(),this.getUsers(),this.getRoles()})}getDocumentPrmission(){this.sub$.sink=this.documentPermissionService.getDoucmentPermission(this.document.id).subscribe(S=>{this.documentPermissions=S,this.permissionsDataSource=new I.by(this.documentPermissions),this.permissionsDataSource.paginator=this.userPermissionsPaginator})}getUsers(){this.sub$.sink=this.commonService.getUsers().subscribe(S=>this.users=S)}getRoles(){this.sub$.sink=this.commonService.getRoles().subscribe(S=>this.roles=S)}deleteDocumentUserPermission(S){this.sub$.sink=this.commonDialogService.deleteConformationDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")}?`).subscribe(V=>{V&&(this.sub$.sink=this.documentPermissionService.deleteDocumentUserPermission(S.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_DELETED_SUCCESSFULLY")),this.getDocumentPrmission()}))})}deleteDocumentRolePermission(S){this.sub$.sink=this.commonDialogService.deleteConformationDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")}?`).subscribe(V=>{V&&(this.sub$.sink=this.documentPermissionService.deleteDocumentRolePermission(S.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_DELETED_SUCCESSFULLY")),this.getDocumentPrmission()}))})}addDocumentUserPermission(){const S=this.dialog.open($t,{width:"600px",data:Object.assign({users:this.users,documentId:this.document.id})});this.sub$.sink=S.afterClosed().subscribe(V=>{V&&this.getDocumentPrmission()})}addDocumentRolePermission(){const S=this.dialog.open(st,{width:"600px",data:Object.assign({roles:this.roles,documentId:this.document.id})});this.sub$.sink=S.afterClosed().subscribe(V=>{V&&this.getDocumentPrmission()})}applyPermissionFilter(S){const V=S.target.value.trim();var $=this.documentPermissions.filter(ue=>"User"==ue.type&&(ue.user.firstName.toLocaleLowerCase().includes(V)||ue.user.lastName.toLocaleLowerCase().includes(V)||ue.user.email.toLocaleLowerCase().includes(V))||"Role"==ue.type&&ue.role.name.toLocaleLowerCase().includes(V));this.permissionsDataSource=new I.by($),this.permissionsDataSource.paginator=this.userPermissionsPaginator}closeDialog(){this.dialogRef.close()}}return M.\u0275fac=function(S){return new(S||M)(l.Y36(Xt.Z),l.Y36(ve.m),l.Y36(en.gz),l.Y36(tn.V),l.Y36(Se._W),l.Y36(B.uw),l.Y36(Ut.v),l.Y36(B.WI),l.Y36(B.so),l.Y36(j.D))},M.\u0275cmp=l.Xpm({type:M,selectors:[["app-document-permission-list"]],viewQuery:function(S,V){if(1&S&&l.Gf(nn,5),2&S){let $;l.iGM($=l.CRH())&&(V.userPermissionsPaginator=$.first)}},features:[l.qOj],decls:51,vars:19,consts:[[1,"dialog-header"],[1,"folder-dialog-info"],[1,"section-title"],[1,"close-icon","mt-1","ml-2","text-danger",3,"click"],[1,"material-icons","cursor-pointer"],[1,"d-content"],["class","col-md-12 row pl-0",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm","m-bottom-10","m-top-10",3,"click"],[1,"las","la-plus"],["type","button",1,"btn","btn-success","btn-sm","m-bottom-10","m-top-10","ml-3",3,"click"],[1,"col-md-12"],["matInput","","placeholder","Ex. Admin",3,"keyup"],["input1",""],["mat-table","",1,"table",3,"dataSource"],["matColumnDef","action"],["style","width:20%","mat-header-cell","",4,"matHeaderCellDef"],["style","width:20%","mat-cell","",4,"matCellDef"],["matColumnDef","isAllowDownload"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","startDate"],["matColumnDef","endDate"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"pageSizeOptions"],["userPermissionsPaginator",""],[1,"col-md-12","row","pl-0"],[1,"col-md-4"],["class","col-md-8",4,"ngIf"],[1,"col-md-8"],["mat-header-cell","",2,"width","20%"],["mat-cell","",2,"width","20%"],["class","btn btn-danger btn-sm","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"las","la-trash"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["mat-header-row",""],["mat-row",""]],template:function(S,V){1&S&&(l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.TgZ(2,"div",2),l.TgZ(3,"h2"),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(6,"div",3),l.NdJ("click",function(){return V.closeDialog()}),l.TgZ(7,"span",4),l._uU(8," close "),l.qZA(),l.qZA(),l.qZA(),l.TgZ(9,"div",5),l.YNc(10,J,8,5,"div",6),l.TgZ(11,"button",7),l.NdJ("click",function(){return V.addDocumentUserPermission()}),l._UZ(12,"i",8),l._uU(13),l.ALo(14,"translate"),l.qZA(),l.TgZ(15,"button",9),l.NdJ("click",function(){return V.addDocumentRolePermission()}),l._UZ(16,"i",8),l._uU(17),l.ALo(18,"translate"),l.qZA(),l.TgZ(19,"mat-form-field",10),l.TgZ(20,"mat-label"),l._uU(21),l.ALo(22,"translate"),l.qZA(),l.TgZ(23,"input",11,12),l.NdJ("keyup",function(ue){return V.applyPermissionFilter(ue)}),l.qZA(),l.qZA(),l.TgZ(25,"table",13),l.ynx(26,14),l.YNc(27,oe,3,3,"th",15),l.YNc(28,Q,3,2,"td",16),l.BQk(),l.ynx(29,17),l.YNc(30,ie,3,3,"th",18),l.YNc(31,bt,3,2,"td",19),l.BQk(),l.ynx(32,20),l.YNc(33,dt,3,3,"th",18),l.YNc(34,Nt,2,1,"td",19),l.BQk(),l.ynx(35,21),l.YNc(36,on,3,3,"th",18),l.YNc(37,Yt,3,2,"td",19),l.BQk(),l.ynx(38,22),l.YNc(39,kt,3,3,"th",18),l.YNc(40,Zt,3,2,"td",19),l.BQk(),l.ynx(41,23),l.YNc(42,an,3,3,"th",18),l.YNc(43,Un,3,2,"td",19),l.BQk(),l.ynx(44,24),l.YNc(45,li,3,3,"th",18),l.YNc(46,Ee,3,2,"td",19),l.BQk(),l.YNc(47,ln,1,0,"tr",25),l.YNc(48,xn,1,0,"tr",26),l.qZA(),l._UZ(49,"mat-paginator",27,28),l.qZA()),2&S&&(l.xp6(4),l.Oqu(l.lcZ(5,10,"SHARE_DOCUMENT")),l.xp6(6),l.Q6J("ngIf",V.document),l.xp6(3),l.hij(" ",l.lcZ(14,12,"ASSIGN_USERS")," "),l.xp6(4),l.hij(" ",l.lcZ(18,14,"ASSIGN_ROLES")," "),l.xp6(4),l.Oqu(l.lcZ(22,16,"FILTER")),l.xp6(4),l.Q6J("dataSource",V.permissionsDataSource),l.xp6(22),l.Q6J("matHeaderRowDef",V.documentPermissionsColumns)("matHeaderRowDefSticky",!0),l.xp6(1),l.Q6J("matRowDefColumns",V.documentPermissionsColumns),l.xp6(1),l.Q6J("pageSizeOptions",l.DdM(18,Cn)))},directives:[He.O5,re.KE,re.hX,Oe.Nt,I.BZ,I.w1,I.fO,I.Dz,I.as,I.nj,Ot.NW,I.ge,I.ev,I.XQ,I.Gk],pipes:[Ne.X$,He.uU],styles:[""]}),M})()},3477:(si,ot,D)=>{D.r(ot),D.d(ot,{DocumentPermissionModule:()=>Tn});var B=D(9808),I=D(2075),he=D(8966),X=D(4107),l=D(2368),ve=D(6087),Se=D(7531),j=D(2554),re=D(4630),ce=D(5e3);const He=[{path:":id",component:re.z}];let at=(()=>{class Y{}return Y.\u0275fac=function(A){return new(A||Y)},Y.\u0275mod=ce.oAB({type:Y}),Y.\u0275inj=ce.cJS({imports:[[j.Bz.forChild(He)],j.Bz]}),Y})();var W=D(6856),Oe=D(508),Ce=D(3075),Ne=D(7033),O=D(5664),ge=D(7144),r=D(7429);D(1777),D(925);let ut=(()=>{class Y{}return Y.\u0275fac=function(A){return new(A||Y)},Y.\u0275mod=ce.oAB({type:Y}),Y.\u0275inj=ce.cJS({imports:[[B.ez,Oe.BQ,r.eL,Oe.si,ge.Q8,O.rt],Oe.BQ]}),Y})();var yt=D(7446),Dn=D(2140),zt=D(2925);let Tn=(()=>{class Y{}return Y.\u0275fac=function(A){return new(A||Y)},Y.\u0275mod=ce.oAB({type:Y}),Y.\u0275inj=ce.cJS({providers:[Ne.m,{provide:Oe.Ad,useValue:"en-GB"}],imports:[[at,Ce.u5,Ce.UX,B.ez,I.p0,he.Is,X.LD,l.rP,ve.TU,Se.c,W.FA,Oe.XK,ut,yt.p9,Dn.Hi,zt.aw]]}),Y})()},7033:(si,ot,D)=>{D.d(ot,{m:()=>l});var B=D(7221),I=D(5e3),he=D(520),X=D(8032);let l=(()=>{class ve{constructor(j,re){this.httpClient=j,this.commonHttpErrorService=re}getDoucmentPermission(j){return this.httpClient.get(`DocumentRolePermission/${j}`).pipe((0,B.K)(this.commonHttpErrorService.handleError))}deleteDocumentUserPermission(j){return this.httpClient.delete(`DocumentUserPermission/${j}`).pipe((0,B.K)(this.commonHttpErrorService.handleError))}deleteDocumentRolePermission(j){return this.httpClient.delete(`DocumentRolePermission/${j}`).pipe((0,B.K)(this.commonHttpErrorService.handleError))}addDocumentUserPermission(j){return this.httpClient.post("DocumentUserPermission",{documentUserPermissions:j}).pipe((0,B.K)(this.commonHttpErrorService.handleError))}addDocumentRolePermission(j){return this.httpClient.post("DocumentRolePermission",{documentRolePermissions:j}).pipe((0,B.K)(this.commonHttpErrorService.handleError))}multipleDocumentsToUsersAndRoles(j){return this.httpClient.post("DocumentRolePermission/multiple",j).pipe((0,B.K)(this.commonHttpErrorService.handleError))}}return ve.\u0275fac=function(j){return new(j||ve)(I.LFG(he.eN),I.LFG(X.U))},ve.\u0275prov=I.Yz7({token:ve,factory:ve.\u0275fac,providedIn:"root"}),ve})()},96:(si,ot,D)=>{D.r(ot),D.d(ot,{DocumentModule:()=>nm});var B=D(9808),I=D(2554),he=D(319),X=D(449),l=D(520),ve=D(6087),Se=D(4847),j=D(7954),re=D(4913),ce=D(6927),He=D(6787),at=D(3753),W=D(2868),Oe=D(13),Ce=D(5778),Ne=D(2676),O=D(3075),ge=D(8966),r=D(5e3),K=D(2457),Je=D(914),tt=D(690),st=D(6107),Ze=D(7322),nt=D(4107),_t=D(508),lt=D(9785),ct=D(2925);function qt(n,e){1&n&&(r.TgZ(0,"div",15),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"NAME_IS_REQUIRED")," "))}function $t(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,qt,3,3,"div",14),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.documentForm.get("name").errors?null:t.documentForm.get("name").errors.required)}}function Xt(n,e){if(1&n&&(r.TgZ(0,"mat-option",16),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.hij(" ",t.name," ")}}function en(n,e){1&n&&(r.TgZ(0,"div",15),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"CATEGORY_NAME_IS_REQUIRED")," "))}function tn(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,en,3,3,"div",14),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.documentForm.get("categoryId").errors?null:t.documentForm.get("categoryId").errors.required)}}function Ut(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"button",17),r.NdJ("click",function(){return r.CHM(t),r.oxw().SaveDocument()}),r._UZ(1,"i",18),r._uU(2),r.ALo(3,"translate"),r.qZA()}2&n&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"SAVE"),""))}let Ot=(()=>{class n extends Ne.H{constructor(t,i,o,a,s,c,d){super(),this.fb=t,this.dialogRef=i,this.data=o,this.toastrService=a,this.documentService=s,this.commonService=c,this.translationService=d,this.extension=""}ngOnInit(){this.createDocumentForm(),this.patchDocumentForm()}patchDocumentForm(){this.documentForm.patchValue({name:this.data.document.name,description:this.data.document.description,categoryId:this.data.document.categoryId})}createDocumentForm(){this.documentForm=this.fb.group({name:["",[O.kI.required]],description:[""],categoryId:["",[O.kI.required]]})}SaveDocument(){this.documentForm.valid?this.sub$.sink=this.documentService.updateDocument(this.buildDocumentObject()).subscribe(t=>{this.toastrService.success(this.translationService.getValue("DOCUMENT_UPDATE_SUCCESSFULLY")),this.dialogRef.close("loaded"),this.addDocumentTrail()}):this.markFormGroupTouched(this.documentForm)}addDocumentTrail(){const t={documentId:this.data.document.id,operationName:j.g.Modified.toString()};this.sub$.sink=this.commonService.addDocumentAuditTrail(t).subscribe(i=>{})}markFormGroupTouched(t){Object.values(t.controls).forEach(i=>{i.markAsTouched(),i.controls&&this.markFormGroupTouched(i)})}buildDocumentObject(){return{id:this.data.document.id,categoryId:this.documentForm.get("categoryId").value,description:this.documentForm.get("description").value,name:this.documentForm.get("name").value}}onDocumentCancel(){this.dialogRef.close("canceled")}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(O.qu),r.Y36(ge.so),r.Y36(ge.WI),r.Y36(K._W),r.Y36(Je.Z),r.Y36(tt.v),r.Y36(st.D))},n.\u0275cmp=r.Xpm({type:n,selectors:[["app-document-edit"]],inputs:{categories:"categories",documentInfo:"documentInfo"},features:[r.qOj],decls:34,vars:20,consts:[[3,"formGroup"],[1,"row"],[1,"col-sm-12"],[1,"form-group"],["formControlName","name","type","text",1,"form-control"],[4,"ngIf"],[1,"w-50"],["formControlName","categoryId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","description",1,"form-control"],[1,"m-top-10","col-md-12"],["class","btn btn-success btn-sm m-right-10","cdkFocusInitial","",3,"click",4,"hasClaim"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"las","la-times-circle"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[3,"value"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-right-10",3,"click"],[1,"las","la-save"]],template:function(t,i){1&t&&(r.TgZ(0,"form",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"div",3),r.TgZ(4,"label"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r._UZ(7,"input",4),r.YNc(8,$t,2,1,"div",5),r.qZA(),r.qZA(),r.TgZ(9,"div",2),r.TgZ(10,"div",3),r.TgZ(11,"mat-form-field",6),r.TgZ(12,"mat-label"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"mat-select",7),r.TgZ(16,"mat-option"),r._uU(17),r.ALo(18,"translate"),r.qZA(),r.YNc(19,Xt,2,2,"mat-option",8),r.qZA(),r.qZA(),r.YNc(20,tn,2,1,"div",5),r.qZA(),r.qZA(),r.TgZ(21,"div",2),r.TgZ(22,"div",3),r.TgZ(23,"label"),r._uU(24),r.ALo(25,"translate"),r.qZA(),r.TgZ(26,"textarea",9),r._uU(27,"        "),r.qZA(),r.qZA(),r.qZA(),r.TgZ(28,"div",10),r.YNc(29,Ut,4,3,"button",11),r.TgZ(30,"button",12),r.NdJ("click",function(){return i.onDocumentCancel()}),r._UZ(31,"i",13),r._uU(32),r.ALo(33,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t&&(r.Q6J("formGroup",i.documentForm),r.xp6(5),r.Oqu(r.lcZ(6,10,"Name")),r.xp6(3),r.Q6J("ngIf",i.documentForm.get("name").touched&&i.documentForm.get("name").errors),r.xp6(5),r.Oqu(r.lcZ(14,12,"CATEGORY")),r.xp6(4),r.hij("-- ",r.lcZ(18,14,"NONE")," --"),r.xp6(2),r.Q6J("ngForOf",i.data.categories),r.xp6(1),r.Q6J("ngIf",i.documentForm.get("categoryId").touched&&i.documentForm.get("categoryId").errors),r.xp6(4),r.Oqu(r.lcZ(25,16,"DESCRIPTION")),r.xp6(5),r.Q6J("hasClaim","all_documents_edit_document"),r.xp6(3),r.hij(" ",r.lcZ(33,18,"CANCEL"),""))},directives:[O._Y,O.JL,O.sg,O.Fj,O.JJ,O.u,B.O5,Ze.KE,Ze.hX,nt.gD,_t.ey,B.sg,lt.d],pipes:[ct.X$],styles:[""]}),n})();var nn=D(4630),rn=D(7033),J=D(5485),oe=D(2140),b=D(7446),k=D(7531),Q=D(6856);function ie(n,e){if(1&n&&(r.TgZ(0,"mat-chip",23),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.xp6(1),r.Oqu(t.name)}}function vt(n,e){if(1&n&&(r.TgZ(0,"mat-option",24),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.lnq(" ",t.firstName," ",t.lastName," (",t.userName,") ")}}function Ge(n,e){if(1&n&&(r.TgZ(0,"mat-option",24),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.hij(" ",t.name," ")}}function bt(n,e){1&n&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"START_DATE_IS_REQURED")," "))}function dt(n,e){1&n&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"END_DATE_IS_REQURED")," "))}function Nt(n,e){1&n&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"END_DATE_SHOULD_BE_GREATER_THAN_TODAY_DATE")," "))}function on(n,e){if(1&n&&(r.TgZ(0,"div",15),r.TgZ(1,"div",25),r.TgZ(2,"mat-form-field",26),r.TgZ(3,"mat-label"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r._UZ(6,"input",27),r._UZ(7,"mat-datepicker-toggle",28),r._UZ(8,"mat-datepicker",null,29),r.YNc(10,bt,3,3,"mat-error",30),r.qZA(),r.qZA(),r.TgZ(11,"div",25),r.TgZ(12,"mat-form-field",26),r.TgZ(13,"mat-label"),r._uU(14),r.ALo(15,"translate"),r.qZA(),r._UZ(16,"input",31),r._UZ(17,"mat-datepicker-toggle",28),r._UZ(18,"mat-datepicker",null,32),r.YNc(20,dt,3,3,"mat-error",30),r.YNc(21,Nt,3,3,"mat-error",30),r.qZA(),r.qZA(),r.qZA()),2&n){const t=r.MAs(9),i=r.MAs(19),o=r.oxw();r.xp6(4),r.Oqu(r.lcZ(5,11,"CHOOSE_A_START_DATE")),r.xp6(2),r.Q6J("min",o.minDate)("matDatepicker",t),r.xp6(1),r.Q6J("for",t),r.xp6(3),r.Q6J("ngIf",o.permissionForm.get("startDate").touched&&(null==o.permissionForm.get("startDate").errors?null:o.permissionForm.get("startDate").errors.required)),r.xp6(4),r.Oqu(r.lcZ(15,13,"CHOOSE_A_END_DATE")),r.xp6(2),r.Q6J("min",o.permissionForm.get("startDate").value)("matDatepicker",i),r.xp6(1),r.Q6J("for",i),r.xp6(3),r.Q6J("ngIf",o.permissionForm.get("endDate").touched&&(null==o.permissionForm.get("endDate").errors?null:o.permissionForm.get("endDate").errors.required)),r.xp6(1),r.Q6J("ngIf",o.permissionForm.get("endDate").touched&&(null==o.permissionForm.get("endDate").errors?null:o.permissionForm.get("endDate").errors.min))}}let Ae=(()=>{class n extends Ne.H{constructor(t,i,o,a,s,c,d,p,f,m){super(),this.documentService=t,this.documentPermissionService=i,this.commonDialogService=o,this.toastrService=a,this.dialog=s,this.commonService=c,this.data=d,this.dialogRef=p,this.fb=f,this.translationService=m,this.documentPermissions=[],this.users=[],this.roles=[],this.minDate=new Date}ngOnInit(){this.documents=this.data,this.getUsers(),this.getRoles(),this.createFormGroup()}createFormGroup(){this.permissionForm=this.fb.group({roles:[],users:[],isTimeBound:[!1],startDate:[],endDate:[],isAllowDownload:[!1]})}timeBoundChange(t){t.checked?(this.permissionForm.get("startDate").setValidators([O.kI.required]),this.permissionForm.get("endDate").setValidators([O.kI.required]),this.permissionForm.updateValueAndValidity()):(this.permissionForm.get("startDate").clearValidators(),this.permissionForm.get("endDate").clearValidators(),this.permissionForm.updateValueAndValidity())}buildObject(){return{roles:this.permissionForm.get("roles").value,users:this.permissionForm.get("users").value,isTimeBound:this.permissionForm.get("isTimeBound").value,startDate:this.permissionForm.get("startDate").value,endDate:this.permissionForm.get("endDate").value,isAllowDownload:this.permissionForm.get("isAllowDownload").value,documents:this.documents.map(i=>i.id)}}saveDocumentUserPermission(){if(!this.permissionForm.valid)return void this.permissionForm.markAllAsTouched();const t=this.buildObject();!t.roles&&!t.users&&this.toastrService.error(this.translationService.getValue("PLEASE_SELECT_EITHER_ROLES_OR_USERS")),this.sub$.sink=this.documentPermissionService.multipleDocumentsToUsersAndRoles(t).subscribe(i=>{this.toastrService.success(this.translationService.getValue("DOCUMENTS_PERMISSION_ASSIGN_TO_USERS_AND_ROLES")),this.dialogRef.close()})}getUsers(){this.sub$.sink=this.commonService.getUsers().subscribe(t=>this.users=t)}getRoles(){this.sub$.sink=this.commonService.getRoles().subscribe(t=>this.roles=t)}closeDialog(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(Je.Z),r.Y36(rn.m),r.Y36(J.V),r.Y36(K._W),r.Y36(ge.uw),r.Y36(tt.v),r.Y36(ge.WI),r.Y36(ge.so),r.Y36(O.qu),r.Y36(st.D))},n.\u0275cmp=r.Xpm({type:n,selectors:[["app-document-permission-multiple"]],features:[r.qOj],decls:51,vars:29,consts:[[1,"dialog-header"],[1,"folder-dialog-info"],[1,"section-title"],[1,"close-icon","mt-1","ml-2","text-danger",3,"click"],[1,"material-icons","cursor-pointer"],[1,"d-content"],[1,"row"],[1,"col-sm-12"],["color","primary",4,"ngFor","ngForOf"],[1,"row","mt-2",3,"formGroup"],[1,"col-md-6"],["formControlName","users","multiple","",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",1,"full-width"],["formControlName","roles","multiple",""],[1,"col-md-12"],["color","primary","formControlName","isTimeBound",3,"change"],["class","col-md-12",4,"ngIf"],["color","primary","formControlName","isAllowDownload"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-right-10",3,"click"],[1,"las","la-save"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"las","la-times-circle"],["color","primary"],[3,"value"],[1,"form-group","col-md-6"],["appearance","fill"],["formControlName","startDate","matInput","",3,"min","matDatepicker"],["matSuffix","",3,"for"],["startDatePicker",""],[4,"ngIf"],["formControlName","endDate","matInput","",3,"min","matDatepicker"],["endDatePicker",""]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"h2"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"div",3),r.NdJ("click",function(){return i.closeDialog()}),r.TgZ(7,"span",4),r._uU(8," close "),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",5),r.TgZ(10,"div",6),r.TgZ(11,"div",7),r.TgZ(12,"h3"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(15,"div",6),r.TgZ(16,"div",7),r.TgZ(17,"mat-chip-list"),r.YNc(18,ie,2,1,"mat-chip",8),r.qZA(),r.qZA(),r.qZA(),r.TgZ(19,"div",9),r.TgZ(20,"div",10),r.TgZ(21,"mat-label"),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.TgZ(24,"mat-select",11),r.YNc(25,vt,2,4,"mat-option",12),r.qZA(),r.qZA(),r.TgZ(26,"div",10),r.TgZ(27,"mat-form-field",13),r.TgZ(28,"mat-label"),r._uU(29),r.ALo(30,"translate"),r.qZA(),r.TgZ(31,"mat-select",14),r.YNc(32,Ge,2,2,"mat-option",12),r.qZA(),r.qZA(),r.qZA(),r.TgZ(33,"div",15),r.TgZ(34,"mat-checkbox",16),r.NdJ("change",function(a){return i.timeBoundChange(a)}),r._uU(35),r.ALo(36,"translate"),r.qZA(),r.qZA(),r.YNc(37,on,22,15,"div",17),r.TgZ(38,"div",15),r.TgZ(39,"mat-checkbox",18),r._uU(40),r.ALo(41,"translate"),r.qZA(),r.qZA(),r.TgZ(42,"div",15),r.TgZ(43,"button",19),r.NdJ("click",function(){return i.saveDocumentUserPermission()}),r._UZ(44,"i",20),r._uU(45),r.ALo(46,"translate"),r.qZA(),r.TgZ(47,"button",21),r.NdJ("click",function(){return i.closeDialog()}),r._UZ(48,"i",22),r._uU(49),r.ALo(50,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t&&(r.xp6(4),r.Oqu(r.lcZ(5,13,"SHARE_DOCUMENTS")),r.xp6(9),r.hij(" ",r.lcZ(14,15,"SELECTED_DOCUMENTS"),""),r.xp6(5),r.Q6J("ngForOf",i.documents),r.xp6(1),r.Q6J("formGroup",i.permissionForm),r.xp6(3),r.Oqu(r.lcZ(23,17,"USERS")),r.xp6(3),r.Q6J("ngForOf",i.users),r.xp6(4),r.Oqu(r.lcZ(30,19,"ROLES")),r.xp6(3),r.Q6J("ngForOf",i.roles),r.xp6(3),r.hij(" ",r.lcZ(36,21,"SPACIFY_THE_PERIOD")," "),r.xp6(2),r.Q6J("ngIf",i.permissionForm.get("isTimeBound").value),r.xp6(3),r.Oqu(r.lcZ(41,23,"ALLOW_DOWNLOAD")),r.xp6(5),r.hij(" ",r.lcZ(46,25,"SAVE")," "),r.xp6(4),r.hij(" ",r.lcZ(50,27,"CANCEL"),""))},directives:[oe.qn,B.sg,O.JL,O.sg,Ze.hX,nt.gD,O.JJ,O.u,Ze.KE,b.oG,B.O5,oe.HS,_t.ey,O.Fj,k.Nt,Q.hl,Q.nW,Ze.R9,Q.Mq,Ze.TO],pipes:[ct.X$],styles:[""]}),n})();var De=D(2851),Yt=D(4598),kt=D(1357),Vn=D(3037),Ht=D(9814),Zt=D(6370),an=D(773);function Jt(n,e){1&n&&(r.TgZ(0,"div",31),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"SUBJECT_IS_REQUIRED")," "))}function qn(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Jt,3,3,"div",30),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.reminderForm.get("subject").errors?null:t.reminderForm.get("subject").errors.required)}}function Un(n,e){1&n&&(r.TgZ(0,"div",31),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"MESSAGE_IS_REQUIRED")," "))}function li(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Un,3,3,"div",30),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.reminderForm.get("message").errors?null:t.reminderForm.get("message").errors.required)}}function sn(n,e){if(1&n&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.AsE(" ",t.selectedUsers[0].firstName," ",t.selectedUsers[0].lastName," ")}}function yn(n,e){if(1&n&&(r.TgZ(0,"span",32),r._uU(1),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.AsE(" (+",t.selectedUsers.length-1," ",2===t.selectedUsers.length?"other":"others",") ")}}function Ee(n,e){if(1&n&&(r.TgZ(0,"mat-option",33),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t),r.xp6(1),r.AsE("",t.firstName," ",t.lastName,"")}}function ln(n,e){if(1&n&&(r.TgZ(0,"option",33),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",null==t?null:t.id),r.xp6(1),r.hij(" ",null==t?null:t.name," ")}}function xn(n,e){1&n&&(r.TgZ(0,"div"),r.TgZ(1,"div",31),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&n&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"FREQUENCY_IS_REQUIRED")," "))}function Cn(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"div",6),r.TgZ(1,"div",34),r.TgZ(2,"label",35),r._uU(3),r.ALo(4,"translate"),r.qZA(),r.TgZ(5,"select",36),r.NdJ("change",function(){return r.CHM(t),r.oxw().onFrequencyChange()}),r.TgZ(6,"option",37),r._uU(7,"--None--"),r.qZA(),r.YNc(8,ln,2,2,"option",21),r.qZA(),r.YNc(9,xn,4,3,"div",12),r.qZA(),r.qZA()}if(2&n){const t=r.oxw();r.xp6(3),r.hij(" ",r.lcZ(4,3,"FREQUENCY"),""),r.xp6(5),r.Q6J("ngForOf",t.reminderFrequencies),r.xp6(1),r.Q6J("ngIf",null==t.reminderForm.get("frequency").errors?null:t.reminderForm.get("frequency").errors.required)}}function Pt(n,e){if(1&n&&(r.TgZ(0,"div",44),r.ynx(1,45),r.TgZ(2,"mat-checkbox",46),r._uU(3),r.qZA(),r.BQk(),r.qZA()),2&n){const t=e.$implicit,i=e.index;r.xp6(1),r.Q6J("formGroupName",i),r.xp6(2),r.hij(" ",t.controls.name.value," ")}}function M(n,e){if(1&n&&(r.TgZ(0,"div",40),r.TgZ(1,"label",41),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",42),r.YNc(5,Pt,4,2,"div",43),r.qZA(),r.qZA()),2&n){const t=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,2,"WEEK_DAYS")),r.xp6(3),r.Q6J("ngForOf",t.dailyRemindersArray.controls)}}function H(n,e){if(1&n&&(r.TgZ(0,"mat-radio-button",51),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.Oqu(t.name)}}function S(n,e){if(1&n&&(r.TgZ(0,"div",40),r.TgZ(1,"label",47),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",48),r.TgZ(5,"mat-radio-group",49),r.YNc(6,H,2,2,"mat-radio-button",50),r.qZA(),r.qZA(),r.qZA()),2&n){const t=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,2,"WEEK_DAYS")),r.xp6(4),r.Q6J("ngForOf",t.dayOfWeek)}}function V(n,e){if(1&n&&(r.TgZ(0,"option",33),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.hij(" ",t.name," ")}}function $(n,e){if(1&n&&(r.TgZ(0,"option",33),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t),r.xp6(1),r.hij(" ",t," ")}}function ue(n,e){1&n&&(r.TgZ(0,"div"),r.TgZ(1,"div",31),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&n&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"PLEASE_SELECT_VALID_DAY")," "))}function ut(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"tr"),r.ynx(1,45),r.TgZ(2,"td"),r._uU(3),r.qZA(),r.TgZ(4,"td"),r.TgZ(5,"select",57),r.NdJ("change",function(){const a=r.CHM(t).$implicit;return r.oxw(3).onDateChange(a)}),r.YNc(6,V,2,2,"option",21),r.qZA(),r.qZA(),r.TgZ(7,"td"),r.TgZ(8,"select",58),r.NdJ("change",function(){const a=r.CHM(t).$implicit;return r.oxw(3).onDateChange(a)}),r.YNc(9,$,2,2,"option",21),r.qZA(),r.YNc(10,ue,4,3,"div",12),r.qZA(),r.BQk(),r.qZA()}if(2&n){const t=e.$implicit,i=e.index,o=r.oxw(3);r.xp6(1),r.Q6J("formGroupName",i),r.xp6(2),r.Oqu(t.controls.name.value),r.xp6(3),r.Q6J("ngForOf",t.controls.monthValues.value),r.xp6(3),r.Q6J("ngForOf",o.days),r.xp6(1),r.Q6J("ngIf",t.get("day").touched&&t.hasError("invalidDate"))}}function yt(n,e){if(1&n&&(r.TgZ(0,"div",40),r.TgZ(1,"label",52),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",53),r.TgZ(5,"table",54),r.TgZ(6,"thead"),r.TgZ(7,"tr"),r._UZ(8,"th"),r.TgZ(9,"th"),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"th"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(15,"tbody",55),r.YNc(16,ut,11,5,"tr",56),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&n){const t=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,4,"SELECT_QUARTER_DATE")),r.xp6(8),r.Oqu(r.lcZ(11,6,"SELECT_REMINDER_MONTH")),r.xp6(3),r.Oqu(r.lcZ(14,8,"SELECT_REMINDER_DAY")),r.xp6(3),r.Q6J("ngForOf",t.quarterlyRemindersArray.controls)}}function Dn(n,e){if(1&n&&(r.TgZ(0,"option",33),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.hij(" ",t.name," ")}}function zt(n,e){if(1&n&&(r.TgZ(0,"option",33),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t),r.xp6(1),r.hij(" ",t," ")}}function Tn(n,e){1&n&&(r.TgZ(0,"div"),r.TgZ(1,"div",31),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&n&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"PLEASE_SELECT_VALID_DAY")," "))}function Y(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"tr"),r.ynx(1,45),r.TgZ(2,"td"),r._uU(3),r.qZA(),r.TgZ(4,"td"),r.TgZ(5,"select",57),r.NdJ("change",function(){const a=r.CHM(t).$implicit;return r.oxw(3).onDateChange(a)}),r.YNc(6,Dn,2,2,"option",21),r.qZA(),r.qZA(),r.TgZ(7,"td"),r.TgZ(8,"select",58),r.NdJ("change",function(){const a=r.CHM(t).$implicit;return r.oxw(3).onDateChange(a)}),r.YNc(9,zt,2,2,"option",21),r.qZA(),r.YNc(10,Tn,4,3,"div",12),r.qZA(),r.BQk(),r.qZA()}if(2&n){const t=e.$implicit,i=e.index,o=r.oxw(3);r.xp6(1),r.Q6J("formGroupName",i),r.xp6(2),r.Oqu(t.controls.name.value),r.xp6(3),r.Q6J("ngForOf",t.controls.monthValues.value),r.xp6(3),r.Q6J("ngForOf",o.days),r.xp6(1),r.Q6J("ngIf",t.get("day").touched&&t.hasError("invalidDate"))}}function L(n,e){if(1&n&&(r.TgZ(0,"div",40),r.TgZ(1,"label",59),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",60),r.TgZ(5,"table",54),r.TgZ(6,"thead"),r.TgZ(7,"tr"),r._UZ(8,"th"),r.TgZ(9,"th"),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"th"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(15,"tbody",61),r.YNc(16,Y,11,5,"tr",56),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&n){const t=r.oxw(2);r.xp6(2),r.Oqu(r.lcZ(3,4,"SELECT_DATE")),r.xp6(8),r.Oqu(r.lcZ(11,6,"SELECT_REMINDER_MONTH")),r.xp6(3),r.Oqu(r.lcZ(14,8,"SELECT_REMINDER_DAY")),r.xp6(3),r.Q6J("ngForOf",t.halfYearlyRemindersArray.controls)}}function A(n,e){if(1&n&&(r.TgZ(0,"div",6),r.TgZ(1,"div",38),r.YNc(2,M,6,4,"div",39),r.YNc(3,S,7,4,"div",39),r.YNc(4,yt,17,10,"div",39),r.YNc(5,L,17,10,"div",39),r.qZA(),r.qZA()),2&n){const t=r.oxw();r.xp6(2),r.Q6J("ngIf","0"==t.reminderForm.get("frequency").value),r.xp6(1),r.Q6J("ngIf","1"==t.reminderForm.get("frequency").value),r.xp6(1),r.Q6J("ngIf","3"==t.reminderForm.get("frequency").value),r.xp6(1),r.Q6J("ngIf","4"==t.reminderForm.get("frequency").value)}}function Z(n,e){1&n&&(r.TgZ(0,"div",31),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"DATE_IS_REQUIRED")," "))}function P(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Z,3,3,"div",30),r.qZA()),2&n){const t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",null==t.reminderForm.get("startDate").errors?null:t.reminderForm.get("startDate").errors.required)}}function ne(n,e){1&n&&(r.TgZ(0,"div",31),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"START_DATE_SHOULD_BE_GREATER_THEN_CURRENT_DATE_TIME")," "))}function Pe(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,ne,3,3,"div",30),r.qZA()),2&n){const t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",null==t.reminderForm.get("startDate").errors?null:t.reminderForm.get("startDate").errors.owlDateTimeMin)}}function it(n,e){if(1&n&&(r.TgZ(0,"div",34),r.TgZ(1,"label",35),r._uU(2),r.ALo(3,"translate"),r.qZA(),r._UZ(4,"input",62),r.YNc(5,P,2,1,"div",12),r.YNc(6,Pe,2,1,"div",12),r._UZ(7,"owl-date-time",null,63),r.qZA()),2&n){const t=r.MAs(8),i=r.oxw();r.xp6(2),r.hij(" ",r.lcZ(3,6,"REMINDER_DATE"),""),r.xp6(2),r.Q6J("owlDateTimeTrigger",t)("min",i.minDate)("owlDateTime",t),r.xp6(1),r.Q6J("ngIf",i.reminderForm.get("startDate").touched&&i.reminderForm.get("startDate").errors),r.xp6(1),r.Q6J("ngIf",i.reminderForm.get("startDate").touched&&i.reminderForm.get("startDate").errors)}}function xt(n,e){1&n&&(r.TgZ(0,"div",31),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"START_DATE_IS_REQUIRED")," "))}function ci(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,xt,3,3,"div",30),r.qZA()),2&n){const t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",null==t.reminderForm.get("startDate").errors?null:t.reminderForm.get("startDate").errors.required)}}function Yn(n,e){1&n&&(r.TgZ(0,"div",31),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"START_DATE_SHOULD_BE_GREATER_THEN_CURRENT_DATE_TIME")," "))}function sr(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Yn,3,3,"div",30),r.qZA()),2&n){const t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",null==t.reminderForm.get("startDate").errors?null:t.reminderForm.get("startDate").errors.owlDateTimeMin)}}function lr(n,e){if(1&n&&(r.TgZ(0,"div",34),r.TgZ(1,"label",35),r._uU(2),r.ALo(3,"translate"),r.qZA(),r._UZ(4,"input",64),r.YNc(5,ci,2,1,"div",12),r.YNc(6,sr,2,1,"div",12),r._UZ(7,"owl-date-time",null,65),r.qZA()),2&n){const t=r.MAs(8),i=r.oxw();r.xp6(2),r.hij(" ",r.lcZ(3,6,"REMINDER_START_DATE"),""),r.xp6(2),r.Q6J("owlDateTimeTrigger",t)("min",i.minDate)("owlDateTime",t),r.xp6(1),r.Q6J("ngIf",i.reminderForm.get("startDate").touched&&i.reminderForm.get("startDate").errors),r.xp6(1),r.Q6J("ngIf",i.reminderForm.get("startDate").touched&&i.reminderForm.get("startDate").errors)}}function Ao(n,e){if(1&n&&(r.TgZ(0,"div",34),r.TgZ(1,"label",35),r._uU(2),r.ALo(3,"translate"),r.qZA(),r._UZ(4,"input",66),r._UZ(5,"owl-date-time",null,67),r.qZA()),2&n){const t=r.MAs(6);r.xp6(2),r.Oqu(r.lcZ(3,3,"REMINDER_END_DATE")),r.xp6(2),r.Q6J("owlDateTimeTrigger",t)("owlDateTime",t)}}function ko(n,e){1&n&&(r.TgZ(0,"div",68),r._UZ(1,"mat-spinner"),r.qZA())}let So=(()=>{class n extends Ne.H{constructor(t,i,o,a,s,c,d){super(),this.fb=t,this.reminderService=i,this.commonService=o,this.toastrService=a,this.data=s,this.dialogRef=c,this.translationService=d,this.reminderFrequencies=[],this.minDate=new Date,this.users=[],this.selectedUsers=[],this.isLoading=!1,this.dayOfWeek=[{id:0,name:"Sunday"},{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"}],this.months=[{id:1,name:"January"},{id:2,name:"February"},{id:3,name:"March"},{id:4,name:"April"},{id:5,name:"May"},{id:6,name:"June"},{id:7,name:"July"},{id:8,name:"August"},{id:9,name:"September"},{id:10,name:"October"},{id:11,name:"November"},{id:12,name:"December"}],this.days=[]}get dailyRemindersArray(){return this.reminderForm.get("dailyReminders")}get quarterlyRemindersArray(){return this.reminderForm.get("quarterlyReminders")}get halfYearlyRemindersArray(){return this.reminderForm.get("halfYearlyReminders")}ngOnInit(){for(let t=1;t<=31;t++)this.days.push(t);this.getReminderFrequency(),this.createReminderForm(),this.getUsers()}closeDialog(){this.dialogRef.close()}getReminderFrequency(){this.sub$.sink=this.commonService.getReminderFrequency().subscribe(t=>this.reminderFrequencies=[...t])}createReminderForm(){var t=new Date;this.reminderForm=this.fb.group({id:[""],subject:["",[O.kI.required]],message:["",[O.kI.required]],frequency:[""],isRepeated:[!1],isEmailNotification:[!1],startDate:[t,[O.kI.required]],endDate:[null],dayOfWeek:[2],documentId:[this.data.id]})}checkData(t){t.checked?this.reminderForm.get("frequency").setValidators([O.kI.required]):this.reminderForm.get("frequency").setValidators([]),this.reminderForm.markAllAsTouched()}createReminder(){if(!this.reminderForm.valid)return void this.reminderForm.markAllAsTouched();let t=this.reminderForm.value;t.reminderUsers=this.selectedUsers.map(i=>({reminderId:t.id,userId:i.id})),t.isRepeated||(t.dailyReminders=[],t.quarterlyReminders=[],t.halfYearlyReminders=[]),this.reminder?(t.dailyReminders&&(t.dailyReminders=t.dailyReminders.map(i=>(i.reminderId=this.reminder.id,i))),t.quarterlyReminders&&(t.quarterlyReminders=t.quarterlyReminders.map(i=>(i.reminderId=this.reminder.id,i))),t.halfYearlyReminders&&(t.halfYearlyReminders=t.halfYearlyReminders.map(i=>(i.reminderId=this.reminder.id,i))),this.isLoading=!0,this.sub$.sink=this.reminderService.updateReminder(t).subscribe(i=>{this.toastrService.success(this.translationService.getValue("REMINDER_UPDATED_SUCCESSFULLY")),this.dialogRef.close(),this.isLoading=!1},()=>this.isLoading=!1)):(this.isLoading=!0,this.sub$.sink=this.reminderService.addReminder(t).subscribe(i=>{this.toastrService.success(this.translationService.getValue("REMINDER_CREATED_SUCCESSFULLY")),this.dialogRef.close(),this.isLoading=!1},()=>this.isLoading=!1))}getUsers(){this.sub$.sink=this.commonService.getUsers().subscribe(t=>{if(this.users=t,this.reminder){const i=this.reminder.reminderUsers.map(o=>o.userId);this.selectedUsers=this.users.filter(o=>i.indexOf(o.id)>=0)}})}onFrequencyChange(){let t=this.reminderForm.get("frequency").value;t=0==t?"0":t,t==Yt.D.Daily.toString()?(this.removeQuarterlyReminders(),this.removeHalfYearlyReminders(),this.addDailReminders(),this.reminderForm.get("dayOfWeek").setValue("")):t==Yt.D.Weekly.toString()?(this.removeDailReminders(),this.removeQuarterlyReminders(),this.removeHalfYearlyReminders(),this.reminderForm.get("dayOfWeek").setValue(2)):t==Yt.D.Quarterly.toString()?(this.removeDailReminders(),this.removeHalfYearlyReminders(),this.addQuarterlyReminders(),this.reminderForm.get("dayOfWeek").setValue("")):t==Yt.D.HalfYearly.toString()?(this.removeDailReminders(),this.removeQuarterlyReminders(),this.addHalfYearlyReminders(),this.reminderForm.get("dayOfWeek").setValue("")):(this.removeDailReminders(),this.removeQuarterlyReminders(),this.removeHalfYearlyReminders(),this.reminderForm.get("dayOfWeek").setValue(""))}addDailReminders(){if(!this.reminderForm.contains("dailyReminders")){var t=this.fb.array([]);t.push(this.createDailyReminderFormGroup(De.e.Sunday)),t.push(this.createDailyReminderFormGroup(De.e.Monday)),t.push(this.createDailyReminderFormGroup(De.e.Tuesday)),t.push(this.createDailyReminderFormGroup(De.e.Wednesday)),t.push(this.createDailyReminderFormGroup(De.e.Thursday)),t.push(this.createDailyReminderFormGroup(De.e.Friday)),t.push(this.createDailyReminderFormGroup(De.e.Saturday)),this.reminderForm.addControl("dailyReminders",t)}}addQuarterlyReminders(){if(!this.reminderForm.contains("quarterlyReminders")){var t=this.fb.array([]),i=this.months.filter(c=>[1,2,3].indexOf(c.id)>=0),o=this.months.filter(c=>[4,5,6].indexOf(c.id)>=0),a=this.months.filter(c=>[7,8,9].indexOf(c.id)>=0),s=this.months.filter(c=>[10,11,12].indexOf(c.id)>=0);t.push(this.createQuarterlyReminderFormGroup(kt.y.Quarter1,"Jan - Mar",i)),t.push(this.createQuarterlyReminderFormGroup(kt.y.Quarter2,"Apr - Jun",o)),t.push(this.createQuarterlyReminderFormGroup(kt.y.Quarter3,"Jul - Sept",a)),t.push(this.createQuarterlyReminderFormGroup(kt.y.Quarter4,"Oct - Dec",s)),this.reminderForm.addControl("quarterlyReminders",t)}}addHalfYearlyReminders(){if(!this.reminderForm.contains("halfYearlyReminders")){var t=this.fb.array([]),i=this.months.filter(a=>[1,2,3,4,5,6].indexOf(a.id)>=0),o=this.months.filter(a=>[7,8,9,10,11,13].indexOf(a.id)>=0);t.push(this.createHalfYearlyReminderFormGroup(kt.y.Quarter1,"Jan - Jun",i)),t.push(this.createHalfYearlyReminderFormGroup(kt.y.Quarter2,"Jul - Dec",o)),this.reminderForm.addControl("halfYearlyReminders",t)}}removeDailReminders(){this.reminderForm.contains("dailyReminders")&&this.reminderForm.removeControl("dailyReminders")}removeQuarterlyReminders(){this.reminderForm.contains("quarterlyReminders")&&this.reminderForm.removeControl("quarterlyReminders")}removeHalfYearlyReminders(){this.reminderForm.contains("halfYearlyReminders")&&this.reminderForm.removeControl("halfYearlyReminders")}createDailyReminderFormGroup(t){return this.fb.group({id:[""],reminderId:[""],dayOfWeek:[t],isActive:[!0],name:[De.e[t]]})}createQuarterlyReminderFormGroup(t,i,o){return this.fb.group({id:[""],reminderId:[""],quarter:[t],day:[this.getCurrentDay()],month:[o[0]],name:[i],monthValues:[o]})}createHalfYearlyReminderFormGroup(t,i,o){return this.fb.group({id:[""],reminderId:[""],quarter:[t],day:[this.getCurrentDay()],month:[o[0]],name:[i],monthValues:[o]})}getCurrentDay(){return(new Date).getDate()}onDateChange(t){const i=t.get("day").value,o=t.get("month").value;i>new Date((new Date).getFullYear(),Number.parseInt(o),0).getDate()&&(t.setErrors({invalidDate:"Invalid Date"}),t.markAllAsTouched())}onCancel(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(O.qu),r.Y36(Vn.Z),r.Y36(tt.v),r.Y36(K._W),r.Y36(ge.WI),r.Y36(ge.so),r.Y36(st.D))},n.\u0275cmp=r.Xpm({type:n,selectors:[["app-document-reminder"]],features:[r.qOj],decls:58,vars:35,consts:[[1,"dialog-header"],[1,"folder-dialog-info"],[1,"section-title"],[1,"close-icon","m-2","text-danger",3,"click"],[1,"material-icons","cursor-pointer"],[1,"d-content"],[1,"row"],[1,"col-sm-12"],[3,"formGroup"],[1,"form-group","col-md-12"],["for","subject"],["formControlName","subject","type","text","id","subject",1,"form-control"],[4,"ngIf"],["for","message"],["formControlName","message","id","message","cols","30",1,"form-control"],[1,"col-md-2"],["color","primary","formControlName","isRepeated",3,"change"],["color","primary","formControlName","isEmailNotification"],[1,"col-md-4"],["placeholder","Select Users","multiple","",1,"form-control",3,"value","valueChange"],["class","example-additional-selection",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["class","form-group col-md-6",4,"ngIf"],[1,"mt-2","col-md-12"],["type","submit",1,"btn","btn-success","btn-sm","m-right-10",3,"click"],[1,"fas","fa-save"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"fas","fa-times-circle"],["class","loading-shade",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"example-additional-selection"],[3,"value"],[1,"form-group","col-md-6"],["for","frequency"],["formControlName","frequency","id","frequency",1,"form-control",3,"change"],["value",""],[1,"col-md-12"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","weekDays"],["id","weekDays",1,"row"],["class","col-sm-auto mr-1","formArrayName","dailyReminders",4,"ngFor","ngForOf"],["formArrayName","dailyReminders",1,"col-sm-auto","mr-1"],[3,"formGroupName"],["color","primary","formControlName","isActive",1,"mr-1"],["for","weekDay"],["id","weekDay"],["formControlName","dayOfWeek"],["class","mr-2","color","primary",3,"value",4,"ngFor","ngForOf"],["color","primary",1,"mr-2",3,"value"],["for","Quarterly"],["id","Quarterly",1,"row"],[1,"table"],["formArrayName","quarterlyReminders"],[4,"ngFor","ngForOf"],["formControlName","month",1,"form-control",3,"change"],["formControlName","day",1,"form-control",3,"change"],["for","HalfYearly"],["id","HalfYearly",1,"row"],["formArrayName","halfYearlyReminders"],["formControlName","startDate","placeholder","Date",1,"form-control",3,"owlDateTimeTrigger","min","owlDateTime"],["dt2",""],["formControlName","startDate","placeholder","Start Date",1,"form-control",3,"owlDateTimeTrigger","min","owlDateTime"],["dt3",""],["formControlName","endDate","placeholder","End Date",1,"form-control",3,"owlDateTimeTrigger","owlDateTime"],["dt4",""],[1,"loading-shade"]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"h2"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"div",3),r.NdJ("click",function(){return i.closeDialog()}),r.TgZ(7,"span",4),r._uU(8," close "),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",5),r.TgZ(10,"div",6),r.TgZ(11,"div",7),r.TgZ(12,"form",8),r.TgZ(13,"div",6),r.TgZ(14,"div",9),r.TgZ(15,"label",10),r._uU(16),r.ALo(17,"translate"),r.qZA(),r._UZ(18,"input",11),r.YNc(19,qn,2,1,"div",12),r.qZA(),r.qZA(),r.TgZ(20,"div",6),r.TgZ(21,"div",9),r.TgZ(22,"label",13),r._uU(23),r.ALo(24,"translate"),r.qZA(),r._UZ(25,"textarea",14),r.YNc(26,li,2,1,"div",12),r.qZA(),r.qZA(),r.TgZ(27,"div",6),r.TgZ(28,"div",15),r.TgZ(29,"mat-checkbox",16),r.NdJ("change",function(a){return i.checkData(a)}),r._uU(30),r.ALo(31,"translate"),r.qZA(),r.qZA(),r.TgZ(32,"div",15),r.TgZ(33,"mat-checkbox",17),r._uU(34),r.ALo(35,"translate"),r.qZA(),r.qZA(),r.TgZ(36,"div",18),r.TgZ(37,"mat-select",19),r.NdJ("valueChange",function(a){return i.selectedUsers=a}),r.TgZ(38,"mat-select-trigger"),r.YNc(39,sn,2,2,"span",12),r.YNc(40,yn,2,2,"span",20),r.qZA(),r.YNc(41,Ee,2,3,"mat-option",21),r.qZA(),r.qZA(),r.qZA(),r.YNc(42,Cn,10,5,"div",22),r.YNc(43,A,6,4,"div",22),r.TgZ(44,"div",6),r.YNc(45,it,9,8,"div",23),r.YNc(46,lr,9,8,"div",23),r.YNc(47,Ao,7,5,"div",23),r.TgZ(48,"div",24),r.TgZ(49,"button",25),r.NdJ("click",function(){return i.createReminder()}),r._UZ(50,"i",26),r._uU(51),r.ALo(52,"translate"),r.qZA(),r.TgZ(53,"button",27),r.NdJ("click",function(){return i.onCancel()}),r._UZ(54,"i",28),r._uU(55),r.ALo(56,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.YNc(57,ko,2,0,"div",29),r.qZA()),2&t&&(r.xp6(4),r.AsE("",r.lcZ(5,21,"ADD_REMINDER"),":: ",null==i.data?null:i.data.name,""),r.xp6(8),r.Q6J("formGroup",i.reminderForm),r.xp6(4),r.hij(" ",r.lcZ(17,23,"SUBJECT"),""),r.xp6(3),r.Q6J("ngIf",i.reminderForm.get("subject").touched&&i.reminderForm.get("subject").errors),r.xp6(4),r.hij(" ",r.lcZ(24,25,"MESSAGE"),""),r.xp6(3),r.Q6J("ngIf",i.reminderForm.get("message").touched&&i.reminderForm.get("message").errors),r.xp6(4),r.hij(" ",r.lcZ(31,27,"REPEATE_REMINDER")," "),r.xp6(4),r.hij("",r.lcZ(35,29,"SEND_EMAIL")," "),r.xp6(3),r.Q6J("value",i.selectedUsers),r.xp6(2),r.Q6J("ngIf",i.selectedUsers.length>0),r.xp6(1),r.Q6J("ngIf",i.selectedUsers.length>1),r.xp6(1),r.Q6J("ngForOf",i.users),r.xp6(1),r.Q6J("ngIf",i.reminderForm.get("isRepeated").value),r.xp6(1),r.Q6J("ngIf",i.reminderForm.get("isRepeated").value),r.xp6(2),r.Q6J("ngIf",!i.reminderForm.get("isRepeated").value),r.xp6(1),r.Q6J("ngIf",i.reminderForm.get("isRepeated").value),r.xp6(1),r.Q6J("ngIf",i.reminderForm.get("isRepeated").value),r.xp6(4),r.hij(" ",r.lcZ(52,31,"SAVE")," "),r.xp6(4),r.hij(" ",r.lcZ(56,33,"CANCEL")," "),r.xp6(2),r.Q6J("ngIf",i.isLoading))},directives:[O._Y,O.JL,O.sg,O.Fj,O.JJ,O.u,B.O5,b.oG,nt.gD,nt.$L,B.sg,_t.ey,O.EJ,O.YN,O.Kr,O.CE,O.x0,Ht.VQ,Ht.U0,Zt.BO,Zt.sZ,Zt.hV,an.$g],pipes:[ct.X$],styles:[""]}),n})();function Fe(n){this.content=n}Fe.prototype={constructor:Fe,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return-1==e?void 0:this.content[e+1]},update:function(n,e,t){var i=t&&t!=n?this.remove(t):this,o=i.find(n),a=i.content.slice();return-1==o?a.push(t||n,e):(a[o+1]=e,t&&(a[o]=t)),new Fe(a)},remove:function(n){var e=this.find(n);if(-1==e)return this;var t=this.content.slice();return t.splice(e,2),new Fe(t)},addToStart:function(n,e){return new Fe([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Fe(t)},addBefore:function(n,e,t){var i=this.remove(e),o=i.content.slice(),a=i.find(n);return o.splice(-1==a?o.length:a,0,e,t),new Fe(o)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return(n=Fe.from(n)).size?new Fe(n.content.concat(this.subtract(n).content)):this},append:function(n){return(n=Fe.from(n)).size?new Fe(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Fe.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},get size(){return this.content.length>>1}},Fe.from=function(n){if(n instanceof Fe)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Fe(e)};const cr=Fe;function dr(n,e,t){for(var i=0;;i++){if(i==n.childCount||i==e.childCount)return n.childCount==e.childCount?null:t;var o=n.child(i),a=e.child(i);if(o!=a){if(!o.sameMarkup(a))return t;if(o.isText&&o.text!=a.text){for(var s=0;o.text[s]==a.text[s];s++)t++;return t}if(o.content.size||a.content.size){var c=dr(o.content,a.content,t+1);if(null!=c)return c}t+=o.nodeSize}else t+=o.nodeSize}}function ur(n,e,t,i){for(var o=n.childCount,a=e.childCount;;){if(0==o||0==a)return o==a?null:{a:t,b:i};var s=n.child(--o),c=e.child(--a),d=s.nodeSize;if(s!=c){if(!s.sameMarkup(c))return{a:t,b:i};if(s.isText&&s.text!=c.text){for(var p=0,f=Math.min(s.text.length,c.text.length);p<f&&s.text[s.text.length-p-1]==c.text[c.text.length-p-1];)p++,t--,i--;return{a:t,b:i}}if(s.content.size||c.content.size){var m=ur(s.content,c.content,t-1,i-1);if(m)return m}t-=d,i-=d}else t-=d,i-=d}}var w=function(e,t){if(this.content=e,this.size=t||0,null==t)for(var i=0;i<e.length;i++)this.size+=e[i].nodeSize},di={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};w.prototype.nodesBetween=function(e,t,i,o,a){void 0===o&&(o=0);for(var s=0,c=0;c<t;s++){var d=this.content[s],p=c+d.nodeSize;if(p>e&&!1!==i(d,o+c,a,s)&&d.content.size){var f=c+1;d.nodesBetween(Math.max(0,e-f),Math.min(d.content.size,t-f),i,o+f)}c=p}},w.prototype.descendants=function(e){this.nodesBetween(0,this.size,e)},w.prototype.textBetween=function(e,t,i,o){var a="",s=!0;return this.nodesBetween(e,t,function(c,d){c.isText?(a+=c.text.slice(Math.max(e,d)-d,t-d),s=!i):c.isLeaf&&o?(a+="function"==typeof o?o(c):o,s=!i):!s&&c.isBlock&&(a+=i,s=!0)},0),a},w.prototype.append=function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,i=e.firstChild,o=this.content.slice(),a=0;for(t.isText&&t.sameMarkup(i)&&(o[o.length-1]=t.withText(t.text+i.text),a=1);a<e.content.length;a++)o.push(e.content[a]);return new w(o,this.size+e.size)},w.prototype.cut=function(e,t){if(null==t&&(t=this.size),0==e&&t==this.size)return this;var i=[],o=0;if(t>e)for(var a=0,s=0;s<t;a++){var c=this.content[a],d=s+c.nodeSize;d>e&&((s<e||d>t)&&(c=c.isText?c.cut(Math.max(0,e-s),Math.min(c.text.length,t-s)):c.cut(Math.max(0,e-s-1),Math.min(c.content.size,t-s-1))),i.push(c),o+=c.nodeSize),s=d}return new w(i,o)},w.prototype.cutByIndex=function(e,t){return e==t?w.empty:0==e&&t==this.content.length?this:new w(this.content.slice(e,t))},w.prototype.replaceChild=function(e,t){var i=this.content[e];if(i==t)return this;var o=this.content.slice(),a=this.size+t.nodeSize-i.nodeSize;return o[e]=t,new w(o,a)},w.prototype.addToStart=function(e){return new w([e].concat(this.content),this.size+e.nodeSize)},w.prototype.addToEnd=function(e){return new w(this.content.concat(e),this.size+e.nodeSize)},w.prototype.eq=function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0},di.firstChild.get=function(){return this.content.length?this.content[0]:null},di.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},di.childCount.get=function(){return this.content.length},w.prototype.child=function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t},w.prototype.maybeChild=function(e){return this.content[e]},w.prototype.forEach=function(e){for(var t=0,i=0;t<this.content.length;t++){var o=this.content[t];e(o,i,t),i+=o.nodeSize}},w.prototype.findDiffStart=function(e,t){return void 0===t&&(t=0),dr(this,e,t)},w.prototype.findDiffEnd=function(e,t,i){return void 0===t&&(t=this.size),void 0===i&&(i=e.size),ur(this,e,t,i)},w.prototype.findIndex=function(e,t){if(void 0===t&&(t=-1),0==e)return Hn(0,e);if(e==this.size)return Hn(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position "+e+" outside of fragment ("+this+")");for(var i=0,o=0;;i++){var s=o+this.child(i).nodeSize;if(s>=e)return s==e||t>0?Hn(i+1,s):Hn(i,o);o=s}},w.prototype.toString=function(){return"<"+this.toStringInner()+">"},w.prototype.toStringInner=function(){return this.content.join(", ")},w.prototype.toJSON=function(){return this.content.length?this.content.map(function(e){return e.toJSON()}):null},w.fromJSON=function(e,t){if(!t)return w.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new w(t.map(e.nodeFromJSON))},w.fromArray=function(e){if(!e.length)return w.empty;for(var t,i=0,o=0;o<e.length;o++){var a=e[o];i+=a.nodeSize,o&&a.isText&&e[o-1].sameMarkup(a)?(t||(t=e.slice(0,o)),t[t.length-1]=a.withText(t[t.length-1].text+a.text)):t&&t.push(a)}return new w(t||e,i)},w.from=function(e){if(!e)return w.empty;if(e instanceof w)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new w([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(w.prototype,di);var Zi={index:0,offset:0};function Hn(n,e){return Zi.index=n,Zi.offset=e,Zi}function v(n,e){if(n===e)return!0;if(!n||"object"!=typeof n||!e||"object"!=typeof e)return!1;var t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(var i=0;i<n.length;i++)if(!v(n[i],e[i]))return!1}else{for(var o in n)if(!(o in e)||!v(n[o],e[o]))return!1;for(var a in e)if(!(a in n))return!1}return!0}w.empty=new w([],0);var C=function(e,t){this.type=e,this.attrs=t};function u(n){var e=Error.call(this,n);return e.__proto__=u.prototype,e}C.prototype.addToSet=function(e){for(var t,i=!1,o=0;o<e.length;o++){var a=e[o];if(this.eq(a))return e;if(this.type.excludes(a.type))t||(t=e.slice(0,o));else{if(a.type.excludes(this.type))return e;!i&&a.type.rank>this.type.rank&&(t||(t=e.slice(0,o)),t.push(this),i=!0),t&&t.push(a)}}return t||(t=e.slice()),i||t.push(this),t},C.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e},C.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1},C.prototype.eq=function(e){return this==e||this.type==e.type&&v(this.attrs,e.attrs)},C.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e},C.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var i=e.marks[t.type];if(!i)throw new RangeError("There is no mark type "+t.type+" in this schema");return i.create(t.attrs)},C.sameSet=function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(!e[i].eq(t[i]))return!1;return!0},C.setFrom=function(e){if(!e||0==e.length)return C.none;if(e instanceof C)return[e];var t=e.slice();return t.sort(function(i,o){return i.type.rank-o.type.rank}),t},C.none=[],(u.prototype=Object.create(Error.prototype)).constructor=u,u.prototype.name="ReplaceError";var h=function(e,t,i){this.content=e,this.openStart=t,this.openEnd=i},_={size:{configurable:!0}};function x(n,e,t){var i=n.findIndex(e),o=i.index,a=i.offset,s=n.maybeChild(o),c=n.findIndex(t),d=c.index;if(a==e||s.isText){if(c.offset!=t&&!n.child(d).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(o!=d)throw new RangeError("Removing non-flat range");return n.replaceChild(o,s.copy(x(s.content,e-a-1,t-a-1)))}function U(n,e,t,i){var o=n.findIndex(e),a=o.index,s=o.offset,c=n.maybeChild(a);if(s==e||c.isText)return i&&!i.canReplace(a,a,t)?null:n.cut(0,e).append(t).append(n.cut(e));var d=U(c.content,e-s-1,t);return d&&n.replaceChild(a,c.copy(d))}function le(n,e,t){if(t.openStart>n.depth)throw new u("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new u("Inconsistent open depths");return pt(n,e,t,0)}function pt(n,e,t,i){var o=n.index(i),a=n.node(i);if(o==e.index(i)&&i<n.depth-t.openStart){var s=pt(n,e,t,i+1);return a.copy(a.content.replaceChild(o,s))}if(t.content.size){if(t.openStart||t.openEnd||n.depth!=i||e.depth!=i){var p=function(n,e){for(var t=e.depth-n.openStart,o=e.node(t).copy(n.content),a=t-1;a>=0;a--)o=e.node(a).copy(w.from(o));return{start:o.resolveNoCache(n.openStart+t),end:o.resolveNoCache(o.content.size-n.openEnd-t)}}(t,n);return kn(a,wo(n,p.start,p.end,e,i))}var c=n.parent,d=c.content;return kn(c,d.cut(0,n.parentOffset).append(t.content).append(d.cut(e.parentOffset)))}return kn(a,Pi(n,e,i))}function Mn(n,e){if(!e.type.compatibleContent(n.type))throw new u("Cannot join "+e.type.name+" onto "+n.type.name)}function ui(n,e,t){var i=n.node(t);return Mn(i,e.node(t)),i}function jt(n,e){var t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function An(n,e,t,i){var o=(e||n).node(t),a=0,s=e?e.index(t):o.childCount;n&&(a=n.index(t),n.depth>t?a++:n.textOffset&&(jt(n.nodeAfter,i),a++));for(var c=a;c<s;c++)jt(o.child(c),i);e&&e.depth==t&&e.textOffset&&jt(e.nodeBefore,i)}function kn(n,e){if(!n.type.validContent(e))throw new u("Invalid content for node "+n.type.name);return n.copy(e)}function wo(n,e,t,i,o){var a=n.depth>o&&ui(n,e,o+1),s=i.depth>o&&ui(t,i,o+1),c=[];return An(null,n,o,c),a&&s&&e.index(o)==t.index(o)?(Mn(a,s),jt(kn(a,wo(n,e,t,i,o+1)),c)):(a&&jt(kn(a,Pi(n,e,o+1)),c),An(e,t,o,c),s&&jt(kn(s,Pi(t,i,o+1)),c)),An(i,null,o,c),new w(c)}function Pi(n,e,t){var i=[];return An(null,n,t,i),n.depth>t&&jt(kn(ui(n,e,t+1),Pi(n,e,t+1)),i),An(e,null,t,i),new w(i)}_.size.get=function(){return this.content.size-this.openStart-this.openEnd},h.prototype.insertAt=function(e,t){var i=U(this.content,e+this.openStart,t,null);return i&&new h(i,this.openStart,this.openEnd)},h.prototype.removeBetween=function(e,t){return new h(x(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)},h.prototype.eq=function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd},h.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},h.prototype.toJSON=function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e},h.fromJSON=function(e,t){if(!t)return h.empty;var i=t.openStart||0,o=t.openEnd||0;if("number"!=typeof i||"number"!=typeof o)throw new RangeError("Invalid input for Slice.fromJSON");return new h(w.fromJSON(e,t.content),i,o)},h.maxOpen=function(e,t){void 0===t&&(t=!0);for(var i=0,o=0,a=e.firstChild;a&&!a.isLeaf&&(t||!a.type.spec.isolating);a=a.firstChild)i++;for(var s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)o++;return new h(e,i,o)},Object.defineProperties(h.prototype,_),h.empty=new h(w.empty,0,0);var _e=function(e,t,i){this.pos=e,this.path=t,this.depth=t.length/3-1,this.parentOffset=i},Jn={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};_e.prototype.resolveDepth=function(e){return null==e?this.depth:e<0?this.depth+e:e},Jn.parent.get=function(){return this.node(this.depth)},Jn.doc.get=function(){return this.node(0)},_e.prototype.node=function(e){return this.path[3*this.resolveDepth(e)]},_e.prototype.index=function(e){return this.path[3*this.resolveDepth(e)+1]},_e.prototype.indexAfter=function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)},_e.prototype.start=function(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1},_e.prototype.end=function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size},_e.prototype.before=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]},_e.prototype.after=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize},Jn.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Jn.nodeAfter.get=function(){var n=this.parent,e=this.index(this.depth);if(e==n.childCount)return null;var t=this.pos-this.path[this.path.length-1],i=n.child(e);return t?n.child(e).cut(t):i},Jn.nodeBefore.get=function(){var n=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(n).cut(0,e):0==n?null:this.parent.child(n-1)},_e.prototype.posAtIndex=function(e,t){t=this.resolveDepth(t);for(var i=this.path[3*t],o=0==t?0:this.path[3*t-1]+1,a=0;a<e;a++)o+=i.child(a).nodeSize;return o},_e.prototype.marks=function(){var e=this.parent,t=this.index();if(0==e.content.size)return C.none;if(this.textOffset)return e.child(t).marks;var i=e.maybeChild(t-1),o=e.maybeChild(t);if(!i){var a=i;i=o,o=a}for(var s=i.marks,c=0;c<s.length;c++)!1===s[c].type.spec.inclusive&&(!o||!s[c].isInSet(o.marks))&&(s=s[c--].removeFromSet(s));return s},_e.prototype.marksAcross=function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var i=t.marks,o=e.parent.maybeChild(e.index()),a=0;a<i.length;a++)!1===i[a].type.spec.inclusive&&(!o||!i[a].isInSet(o.marks))&&(i=i[a--].removeFromSet(i));return i},_e.prototype.sharedDepth=function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0},_e.prototype.blockRange=function(e,t){if(void 0===e&&(e=this),e.pos<this.pos)return e.blockRange(this);for(var i=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);i>=0;i--)if(e.pos<=this.end(i)&&(!t||t(this.node(i))))return new pi(this,e,i)},_e.prototype.sameParent=function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset},_e.prototype.max=function(e){return e.pos>this.pos?e:this},_e.prototype.min=function(e){return e.pos<this.pos?e:this},_e.prototype.toString=function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset},_e.resolve=function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var i=[],o=0,a=t,s=e;;){var c=s.content.findIndex(a),d=c.index,p=c.offset,f=a-p;if(i.push(s,d,o+p),!f||(s=s.child(d)).isText)break;a=f-1,o+=p+1}return new _e(t,i,a)},_e.resolveCached=function(e,t){for(var i=0;i<pr.length;i++){var o=pr[i];if(o.pos==t&&o.doc==e)return o}var a=pr[hr]=_e.resolve(e,t);return hr=(hr+1)%fl,a},Object.defineProperties(_e.prototype,Jn);var pr=[],hr=0,fl=12,pi=function(e,t,i){this.$from=e,this.$to=t,this.depth=i},zn={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};zn.start.get=function(){return this.$from.before(this.depth+1)},zn.end.get=function(){return this.$to.after(this.depth+1)},zn.parent.get=function(){return this.$from.node(this.depth)},zn.startIndex.get=function(){return this.$from.index(this.depth)},zn.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(pi.prototype,zn);var ml=Object.create(null),ae=function(e,t,i,o){this.type=e,this.attrs=t,this.content=i||w.empty,this.marks=o||C.none},ht={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};ht.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},ht.childCount.get=function(){return this.content.childCount},ae.prototype.child=function(e){return this.content.child(e)},ae.prototype.maybeChild=function(e){return this.content.maybeChild(e)},ae.prototype.forEach=function(e){this.content.forEach(e)},ae.prototype.nodesBetween=function(e,t,i,o){void 0===o&&(o=0),this.content.nodesBetween(e,t,i,o,this)},ae.prototype.descendants=function(e){this.nodesBetween(0,this.content.size,e)},ht.textContent.get=function(){return this.textBetween(0,this.content.size,"")},ae.prototype.textBetween=function(e,t,i,o){return this.content.textBetween(e,t,i,o)},ht.firstChild.get=function(){return this.content.firstChild},ht.lastChild.get=function(){return this.content.lastChild},ae.prototype.eq=function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)},ae.prototype.sameMarkup=function(e){return this.hasMarkup(e.type,e.attrs,e.marks)},ae.prototype.hasMarkup=function(e,t,i){return this.type==e&&v(this.attrs,t||e.defaultAttrs||ml)&&C.sameSet(this.marks,i||C.none)},ae.prototype.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new this.constructor(this.type,this.attrs,e,this.marks)},ae.prototype.mark=function(e){return e==this.marks?this:new this.constructor(this.type,this.attrs,this.content,e)},ae.prototype.cut=function(e,t){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))},ae.prototype.slice=function(e,t,i){if(void 0===t&&(t=this.content.size),void 0===i&&(i=!1),e==t)return h.empty;var o=this.resolve(e),a=this.resolve(t),s=i?0:o.sharedDepth(t),c=o.start(s),p=o.node(s).content.cut(o.pos-c,a.pos-c);return new h(p,o.depth-s,a.depth-s)},ae.prototype.replace=function(e,t,i){return le(this.resolve(e),this.resolve(t),i)},ae.prototype.nodeAt=function(e){for(var t=this;;){var i=t.content.findIndex(e),a=i.offset;if(!(t=t.maybeChild(i.index)))return null;if(a==e||t.isText)return t;e-=a+1}},ae.prototype.childAfter=function(e){var t=this.content.findIndex(e),i=t.index,o=t.offset;return{node:this.content.maybeChild(i),index:i,offset:o}},ae.prototype.childBefore=function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),i=t.index,o=t.offset;if(o<e)return{node:this.content.child(i),index:i,offset:o};var a=this.content.child(i-1);return{node:a,index:i-1,offset:o-a.nodeSize}},ae.prototype.resolve=function(e){return _e.resolveCached(this,e)},ae.prototype.resolveNoCache=function(e){return _e.resolve(this,e)},ae.prototype.rangeHasMark=function(e,t,i){var o=!1;return t>e&&this.nodesBetween(e,t,function(a){return i.isInSet(a.marks)&&(o=!0),!o}),o},ht.isBlock.get=function(){return this.type.isBlock},ht.isTextblock.get=function(){return this.type.isTextblock},ht.inlineContent.get=function(){return this.type.inlineContent},ht.isInline.get=function(){return this.type.isInline},ht.isText.get=function(){return this.type.isText},ht.isLeaf.get=function(){return this.type.isLeaf},ht.isAtom.get=function(){return this.type.isAtom},ae.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Io(this.marks,e)},ae.prototype.contentMatchAt=function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},ae.prototype.canReplace=function(e,t,i,o,a){void 0===i&&(i=w.empty),void 0===o&&(o=0),void 0===a&&(a=i.childCount);var s=this.contentMatchAt(e).matchFragment(i,o,a),c=s&&s.matchFragment(this.content,t);if(!c||!c.validEnd)return!1;for(var d=o;d<a;d++)if(!this.type.allowsMarks(i.child(d).marks))return!1;return!0},ae.prototype.canReplaceWith=function(e,t,i,o){if(o&&!this.type.allowsMarks(o))return!1;var a=this.contentMatchAt(e).matchType(i),s=a&&a.matchFragment(this.content,t);return!!s&&s.validEnd},ae.prototype.canAppend=function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)},ae.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var e=C.none,t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!C.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map(function(i){return i.type.name}));this.content.forEach(function(i){return i.check()})},ae.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(function(i){return i.toJSON()})),e},ae.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var i=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");i=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,i)}var o=w.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,o,i)},Object.defineProperties(ae.prototype,ht);var gl=function(n){function e(i,o,a,s){if(n.call(this,i,o,null,s),!a)throw new RangeError("Empty text nodes are not allowed");this.text=a}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Io(this.marks,JSON.stringify(this.text))},t.textContent.get=function(){return this.text},e.prototype.textBetween=function(o,a){return this.text.slice(o,a)},t.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(o){return o==this.marks?this:new e(this.type,this.attrs,this.text,o)},e.prototype.withText=function(o){return o==this.text?this:new e(this.type,this.attrs,o,this.marks)},e.prototype.cut=function(o,a){return void 0===o&&(o=0),void 0===a&&(a=this.text.length),0==o&&a==this.text.length?this:this.withText(this.text.slice(o,a))},e.prototype.eq=function(o){return this.sameMarkup(o)&&this.text==o.text},e.prototype.toJSON=function(){var o=n.prototype.toJSON.call(this);return o.text=this.text,o},Object.defineProperties(e.prototype,t),e}(ae);function Io(n,e){for(var t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}var ze=function(e){this.validEnd=e,this.next=[],this.wrapCache=[]},Fi={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};ze.parse=function(e,t){var i=new Li(e,t);if(null==i.next)return ze.empty;var o=Oo(i);i.next&&i.err("Unexpected trailing text");var a=function(n){var e=Object.create(null);return function t(i){var o=[];i.forEach(function(d){n[d].forEach(function(p){var f=p.term,m=p.to;if(f){var g=o.indexOf(f),y=g>-1&&o[g+1];Po(n,m).forEach(function(T){y||o.push(f,y=[]),-1==y.indexOf(T)&&y.push(T)})}})});for(var a=e[i.join(",")]=new ze(i.indexOf(n.length-1)>-1),s=0;s<o.length;s+=2){var c=o[s+1].sort(Zo);a.next.push(o[s],e[c.join(",")]||t(c))}return a}(Po(n,0))}(function(n){var e=[[]];return o(function a(s,c){if("choice"==s.type)return s.exprs.reduce(function(q,N){return q.concat(a(N,c))},[]);if("seq"==s.type)for(var d=0;;d++){var p=a(s.exprs[d],c);if(d==s.exprs.length-1)return p;o(p,c=t())}else{if("star"==s.type){var f=t();return i(c,f),o(a(s.expr,f),f),[i(f)]}if("plus"==s.type){var m=t();return o(a(s.expr,c),m),o(a(s.expr,m),m),[i(m)]}if("opt"==s.type)return[i(c)].concat(a(s.expr,c));if("range"==s.type){for(var g=c,y=0;y<s.min;y++){var T=t();o(a(s.expr,g),T),g=T}if(-1==s.max)o(a(s.expr,g),g);else for(var E=s.min;E<s.max;E++){var F=t();i(g,F),o(a(s.expr,g),F),g=F}return[i(g)]}if("name"==s.type)return[i(c,null,s.value)]}}(n,0),t()),e;function t(){return e.push([])-1}function i(s,c,d){var p={term:d,to:c};return e[s].push(p),p}function o(s,c){s.forEach(function(d){return d.to=c})}}(o));return function(n,e){for(var t=0,i=[n];t<i.length;t++){for(var o=i[t],a=!o.validEnd,s=[],c=0;c<o.next.length;c+=2){var d=o.next[c],p=o.next[c+1];s.push(d.name),a&&!(d.isText||d.hasRequiredAttrs())&&(a=!1),-1==i.indexOf(p)&&i.push(p)}a&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(a,i),a},ze.prototype.matchType=function(e){for(var t=0;t<this.next.length;t+=2)if(this.next[t]==e)return this.next[t+1];return null},ze.prototype.matchFragment=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=e.childCount);for(var o=this,a=t;o&&a<i;a++)o=o.matchType(e.child(a).type);return o},Fi.inlineContent.get=function(){var n=this.next[0];return!!n&&n.isInline},Fi.defaultType.get=function(){for(var n=0;n<this.next.length;n+=2){var e=this.next[n];if(!e.isText&&!e.hasRequiredAttrs())return e}},ze.prototype.compatible=function(e){for(var t=0;t<this.next.length;t+=2)for(var i=0;i<e.next.length;i+=2)if(this.next[t]==e.next[i])return!0;return!1},ze.prototype.fillBefore=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=0);var o=[this];return function a(s,c){var d=s.matchFragment(e,i);if(d&&(!t||d.validEnd))return w.from(c.map(function(y){return y.createAndFill()}));for(var p=0;p<s.next.length;p+=2){var f=s.next[p],m=s.next[p+1];if(!f.isText&&!f.hasRequiredAttrs()&&-1==o.indexOf(m)){o.push(m);var g=a(m,c.concat(f));if(g)return g}}}(this,[])},ze.prototype.findWrapping=function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var i=this.computeWrapping(e);return this.wrapCache.push(e,i),i},ze.prototype.computeWrapping=function(e){for(var t=Object.create(null),i=[{match:this,type:null,via:null}];i.length;){var o=i.shift(),a=o.match;if(a.matchType(e)){for(var s=[],c=o;c.type;c=c.via)s.push(c.type);return s.reverse()}for(var d=0;d<a.next.length;d+=2){var p=a.next[d];!p.isLeaf&&!p.hasRequiredAttrs()&&!(p.name in t)&&(!o.type||a.next[d+1].validEnd)&&(i.push({match:p.contentMatch,type:p,via:o}),t[p.name]=!0)}}},Fi.edgeCount.get=function(){return this.next.length>>1},ze.prototype.edge=function(e){var t=e<<1;if(t>=this.next.length)throw new RangeError("There's no "+e+"th edge in this content match");return{type:this.next[t],next:this.next[t+1]}},ze.prototype.toString=function(){var e=[];return function t(i){e.push(i);for(var o=1;o<i.next.length;o+=2)-1==e.indexOf(i.next[o])&&t(i.next[o])}(this),e.map(function(i,o){for(var a=o+(i.validEnd?"*":" ")+" ",s=0;s<i.next.length;s+=2)a+=(s?", ":"")+i.next[s].name+"->"+e.indexOf(i.next[s+1]);return a}).join("\n")},Object.defineProperties(ze.prototype,Fi),ze.empty=new ze(!0);var Li=function(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},Ro={next:{configurable:!0}};function Oo(n){var e=[];do{e.push(_l(n))}while(n.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function _l(n){var e=[];do{e.push(vl(n))}while(n.next&&")"!=n.next&&"|"!=n.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function vl(n){for(var e=function(n){if(n.eat("(")){var e=Oo(n);return n.eat(")")||n.err("Missing closing paren"),e}if(!/\W/.test(n.next)){var t=function(n,e){var t=n.nodeTypes,i=t[e];if(i)return[i];var o=[];for(var a in t){var s=t[a];s.groups.indexOf(e)>-1&&o.push(s)}return 0==o.length&&n.err("No node type or group '"+e+"' found"),o}(n,n.next).map(function(i){return null==n.inline?n.inline=i.isInline:n.inline!=i.isInline&&n.err("Mixing inline and block content"),{type:"name",value:i}});return n.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}n.err("Unexpected token '"+n.next+"'")}(n);;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else{if(!n.eat("{"))break;e=bl(n,e)}return e}function No(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");var e=Number(n.next);return n.pos++,e}function bl(n,e){var t=No(n),i=t;return n.eat(",")&&(i="}"!=n.next?No(n):-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:i,expr:e}}function Zo(n,e){return e-n}function Po(n,e){var t=[];return function i(o){var a=n[o];if(1==a.length&&!a[0].term)return i(a[0].to);t.push(o);for(var s=0;s<a.length;s++){var c=a[s],p=c.to;!c.term&&-1==t.indexOf(p)&&i(p)}}(e),t.sort(Zo)}function Fo(n){var e=Object.create(null);for(var t in n){var i=n[t];if(!i.hasDefault)return null;e[t]=i.default}return e}function Lo(n,e){var t=Object.create(null);for(var i in n){var o=e&&e[i];if(void 0===o){var a=n[i];if(!a.hasDefault)throw new RangeError("No value supplied for attribute "+i);o=a.default}t[i]=o}return t}function Bo(n){var e=Object.create(null);if(n)for(var t in n)e[t]=new Vo(n[t]);return e}Ro.next.get=function(){return this.tokens[this.pos]},Li.prototype.eat=function(e){return this.next==e&&(this.pos++||!0)},Li.prototype.err=function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")},Object.defineProperties(Li.prototype,Ro);var Ke=function(e,t,i){this.name=e,this.schema=t,this.spec=i,this.groups=i.group?i.group.split(" "):[],this.attrs=Bo(i.attrs),this.defaultAttrs=Fo(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(i.inline||"text"==e),this.isText="text"==e},hi={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};hi.isInline.get=function(){return!this.isBlock},hi.isTextblock.get=function(){return this.isBlock&&this.inlineContent},hi.isLeaf.get=function(){return this.contentMatch==ze.empty},hi.isAtom.get=function(){return this.isLeaf||this.spec.atom},Ke.prototype.hasRequiredAttrs=function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1},Ke.prototype.compatibleContent=function(e){return this==e||this.contentMatch.compatible(e.contentMatch)},Ke.prototype.computeAttrs=function(e){return!e&&this.defaultAttrs?this.defaultAttrs:Lo(this.attrs,e)},Ke.prototype.create=function(e,t,i){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ae(this,this.computeAttrs(e),w.from(t),C.setFrom(i))},Ke.prototype.createChecked=function(e,t,i){if(t=w.from(t),!this.validContent(t))throw new RangeError("Invalid content for node "+this.name);return new ae(this,this.computeAttrs(e),t,C.setFrom(i))},Ke.prototype.createAndFill=function(e,t,i){if(e=this.computeAttrs(e),(t=w.from(t)).size){var o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}var a=this.contentMatch.matchFragment(t).fillBefore(w.empty,!0);return a?new ae(this,e,t.append(a),C.setFrom(i)):null},Ke.prototype.validContent=function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var i=0;i<e.childCount;i++)if(!this.allowsMarks(e.child(i).marks))return!1;return!0},Ke.prototype.allowsMarkType=function(e){return null==this.markSet||this.markSet.indexOf(e)>-1},Ke.prototype.allowsMarks=function(e){if(null==this.markSet)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0},Ke.prototype.allowedMarks=function(e){if(null==this.markSet)return e;for(var t,i=0;i<e.length;i++)this.allowsMarkType(e[i].type)?t&&t.push(e[i]):t||(t=e.slice(0,i));return t?t.length?t:C.empty:e},Ke.compile=function(e,t){var i=Object.create(null);e.forEach(function(s,c){return i[s]=new Ke(s,t,c)});var o=t.spec.topNode||"doc";if(!i[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(var a in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i},Object.defineProperties(Ke.prototype,hi);var Vo=function(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default},qo={isRequired:{configurable:!0}};qo.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Vo.prototype,qo);var cn=function(e,t,i,o){this.name=e,this.schema=i,this.spec=o,this.attrs=Bo(o.attrs),this.rank=t,this.excluded=null;var a=Fo(this.attrs);this.instance=a&&new C(this,a)};cn.prototype.create=function(e){return!e&&this.instance?this.instance:new C(this,Lo(this.attrs,e))},cn.compile=function(e,t){var i=Object.create(null),o=0;return e.forEach(function(a,s){return i[a]=new cn(a,o++,t,s)}),i},cn.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e},cn.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]},cn.prototype.excludes=function(e){return this.excluded.indexOf(e)>-1};var Sn=function(e){for(var t in this.spec={},e)this.spec[t]=e[t];this.spec.nodes=cr.from(e.nodes),this.spec.marks=cr.from(e.marks),this.nodes=Ke.compile(this.spec.nodes,this),this.marks=cn.compile(this.spec.marks,this);var i=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var a=this.nodes[o],s=a.spec.content||"",c=a.spec.marks;a.contentMatch=i[s]||(i[s]=ze.parse(s,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.markSet="_"==c?null:c?Uo(this,c.split(" ")):""!=c&&a.inlineContent?null:[]}for(var d in this.marks){var p=this.marks[d],f=p.spec.excludes;p.excluded=null==f?[p]:""==f?[]:Uo(this,f.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Uo(n,e){for(var t=[],i=0;i<e.length;i++){var o=e[i],a=n.marks[o],s=a;if(a)t.push(a);else for(var c in n.marks){var d=n.marks[c];("_"==o||d.spec.group&&d.spec.group.split(" ").indexOf(o)>-1)&&t.push(s=d)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return t}Sn.prototype.node=function(e,t,i,o){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof Ke))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,i,o)},Sn.prototype.text=function(e,t){var i=this.nodes.text;return new gl(i,i.defaultAttrs,e,C.setFrom(t))},Sn.prototype.mark=function(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)},Sn.prototype.nodeFromJSON=function(e){return ae.fromJSON(this,e)},Sn.prototype.markFromJSON=function(e){return C.fromJSON(this,e)},Sn.prototype.nodeType=function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t};var Ct=function(e,t){var i=this;this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(function(o){o.tag?i.tags.push(o):o.style&&i.styles.push(o)}),this.normalizeLists=!this.tags.some(function(o){if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;var a=e.nodes[o.node];return a.contentMatch.matchType(a)})};Ct.prototype.parse=function(e,t){void 0===t&&(t={});var i=new me(this,t,!1);return i.addAll(e,null,t.from,t.to),i.finish()},Ct.prototype.parseSlice=function(e,t){void 0===t&&(t={});var i=new me(this,t,!0);return i.addAll(e,null,t.from,t.to),h.maxOpen(i.finish())},Ct.prototype.matchTag=function(e,t,i){for(var o=i?this.tags.indexOf(i)+1:0;o<this.tags.length;o++){var a=this.tags[o];if(kl(e,a.tag)&&(void 0===a.namespace||e.namespaceURI==a.namespace)&&(!a.context||t.matchesContext(a.context))){if(a.getAttrs){var s=a.getAttrs(e);if(!1===s)continue;a.attrs=s}return a}}},Ct.prototype.matchStyle=function(e,t,i,o){for(var a=o?this.styles.indexOf(o)+1:0;a<this.styles.length;a++){var s=this.styles[a];if(!(0!=s.style.indexOf(e)||s.context&&!i.matchesContext(s.context)||s.style.length>e.length&&(61!=s.style.charCodeAt(e.length)||s.style.slice(e.length+1)!=t))){if(s.getAttrs){var c=s.getAttrs(t);if(!1===c)continue;s.attrs=c}return s}}},Ct.schemaRules=function(e){var t=[];function i(d){for(var p=null==d.priority?50:d.priority,f=0;f<t.length;f++){var m=t[f];if((null==m.priority?50:m.priority)<p)break}t.splice(f,0,d)}var p,o=function(d){var p=e.marks[d].spec.parseDOM;p&&p.forEach(function(f){i(f=Jo(f)),f.mark=d})};for(var a in e.marks)o(a);for(var c in e.nodes)p=void 0,(p=e.nodes[c].spec.parseDOM)&&p.forEach(function(f){i(f=Jo(f)),f.node=c});return t},Ct.fromSchema=function(e){return e.cached.domParser||(e.cached.domParser=new Ct(e,Ct.schemaRules(e)))};var fr={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ml={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Yo={ol:!0,ul:!0};function Ho(n){return(n?1:0)|("full"===n?2:0)}var Qt=function(e,t,i,o,a,s,c){this.type=e,this.attrs=t,this.solid=a,this.match=s||(4&c?null:e.contentMatch),this.options=c,this.content=[],this.marks=i,this.activeMarks=C.none,this.pendingMarks=o,this.stashMarks=[]};Qt.prototype.findWrapping=function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(w.from(e));if(!t){var o,i=this.type.contentMatch;return(o=i.findWrapping(e.type))?(this.match=i,o):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)},Qt.prototype.finish=function(e){if(!(1&this.options)){var i,t=this.content[this.content.length-1];t&&t.isText&&(i=/[ \t\r\n\u000c]+$/.exec(t.text))&&(t.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=t.withText(t.text.slice(0,t.text.length-i[0].length)))}var o=w.from(this.content);return!e&&this.match&&(o=o.append(this.match.fillBefore(w.empty,!0))),this.type?this.type.create(this.attrs,o,this.marks):o},Qt.prototype.popFromStashMark=function(e){for(var t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]},Qt.prototype.applyPending=function(e){for(var t=0,i=this.pendingMarks;t<i.length;t++){var o=i[t];(this.type?this.type.allowsMarkType(o.type):El(o.type,e))&&!o.isInSet(this.activeMarks)&&(this.activeMarks=o.addToSet(this.activeMarks),this.pendingMarks=o.removeFromSet(this.pendingMarks))}},Qt.prototype.inlineContext=function(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!fr.hasOwnProperty(e.parentNode.nodeName.toLowerCase())};var me=function(e,t,i){this.parser=e,this.options=t,this.isOpen=i;var a,o=t.topNode,s=Ho(t.preserveWhitespace)|(i?4:0);a=o?new Qt(o.type,o.attrs,C.none,C.none,!0,t.topMatch||o.type.contentMatch,s):new Qt(i?null:e.schema.topNodeType,null,C.none,C.none,!0,null,s),this.nodes=[a],this.open=0,this.find=t.findPositions,this.needsBlock=!1},_r={top:{configurable:!0},currentPos:{configurable:!0}};function kl(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Jo(n){var e={};for(var t in n)e[t]=n[t];return e}function El(n,e){var t=e.schema.nodes,i=function(s){var c=t[s];if(c.allowsMarkType(n)){var d=[],p=function(f){d.push(f);for(var m=0;m<f.edgeCount;m++){var g=f.edge(m),T=g.next;if(g.type==e||d.indexOf(T)<0&&p(T))return!0}};if(p(c.contentMatch))return{v:!0}}};for(var o in t){var a=i(o);if(a)return a.v}}_r.top.get=function(){return this.nodes[this.open]},me.prototype.addDOM=function(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var t=e.getAttribute("style"),i=t?this.readStyles(function(n){for(var t,e=/\s*([\w-]+)\s*:\s*([^;]+)/g,i=[];t=e.exec(n);)i.push(t[1],t[2].trim());return i}(t)):null,o=this.top;if(null!=i)for(var a=0;a<i.length;a++)this.addPendingMark(i[a]);if(this.addElement(e),null!=i)for(var s=0;s<i.length;s++)this.removePendingMark(i[s],o)}},me.prototype.addTextNode=function(e){var t=e.nodeValue,i=this.top;if(2&i.options||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&i.options)t=2&i.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){var o=i.content[i.content.length-1],a=e.previousSibling;(!o||a&&"BR"==a.nodeName||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)},me.prototype.addElement=function(e,t){var o,i=e.nodeName.toLowerCase();Yo.hasOwnProperty(i)&&this.parser.normalizeLists&&function(n){for(var e=n.firstChild,t=null;e;e=e.nextSibling){var i=1==e.nodeType?e.nodeName.toLowerCase():null;i&&Yo.hasOwnProperty(i)&&t?(t.appendChild(e),e=t):"li"==i?t=e:i&&(t=null)}}(e);var a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,t));if(a?a.ignore:Ml.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);var s,c=this.top,d=this.needsBlock;if(fr.hasOwnProperty(i))s=!0,c.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),s&&this.sync(c),this.needsBlock=d}else this.addElementByRule(e,a,!1===a.consuming?o:null)},me.prototype.leafFallback=function(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))},me.prototype.ignoreFallback=function(e){"BR"==e.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))},me.prototype.readStyles=function(e){var t=C.none;e:for(var i=0;i<e.length;i+=2)for(var o=null;;){var a=this.parser.matchStyle(e[i],e[i+1],this,o);if(!a)continue e;if(a.ignore)return null;if(t=this.parser.schema.marks[a.mark].create(a.attrs).addToSet(t),!1!==a.consuming)break;o=a}return t},me.prototype.addElementByRule=function(e,t,i){var a,s,d,o=this;t.node?(s=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):a=this.enter(s,t.attrs,t.preserveWhitespace):(d=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(d));var p=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(function(m){return o.insertNode(m)});else{var f=t.contentElement;"string"==typeof f?f=e.querySelector(f):"function"==typeof f&&(f=f(e)),f||(f=e),this.findAround(e,f,!0),this.addAll(f,a)}a&&(this.sync(p),this.open--),d&&this.removePendingMark(d,p)},me.prototype.addAll=function(e,t,i,o){for(var a=i||0,s=i?e.childNodes[i]:e.firstChild,c=null==o?null:e.childNodes[o];s!=c;s=s.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(s),t&&fr.hasOwnProperty(s.nodeName.toLowerCase())&&this.sync(t);this.findAtPoint(e,a)},me.prototype.findPlace=function(e){for(var t,i,o=this.open;o>=0;o--){var a=this.nodes[o],s=a.findWrapping(e);if(s&&(!t||t.length>s.length)&&(t=s,i=a,!s.length)||a.solid)break}if(!t)return!1;this.sync(i);for(var c=0;c<t.length;c++)this.enterInner(t[c],null,!1);return!0},me.prototype.insertNode=function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var i=this.top;i.applyPending(e.type),i.match&&(i.match=i.match.matchType(e.type));for(var o=i.activeMarks,a=0;a<e.marks.length;a++)(!i.type||i.type.allowsMarkType(e.marks[a].type))&&(o=e.marks[a].addToSet(o));return i.content.push(e.mark(o)),!0}return!1},me.prototype.enter=function(e,t,i){var o=this.findPlace(e.create(t));return o&&this.enterInner(e,t,!0,i),o},me.prototype.enterInner=function(e,t,i,o){this.closeExtra();var a=this.top;a.applyPending(e),a.match=a.match&&a.match.matchType(e,t);var s=null==o?-5&a.options:Ho(o);4&a.options&&0==a.content.length&&(s|=4),this.nodes.push(new Qt(e,t,a.activeMarks,a.pendingMarks,i,null,s)),this.open++},me.prototype.closeExtra=function(e){var t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}},me.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},me.prototype.sync=function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return void(this.open=t)},_r.currentPos.get=function(){this.closeExtra();for(var n=0,e=this.open;e>=0;e--){for(var t=this.nodes[e].content,i=t.length-1;i>=0;i--)n+=t[i].nodeSize;e&&n++}return n},me.prototype.findAtPoint=function(e,t){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==e&&this.find[i].offset==t&&(this.find[i].pos=this.currentPos)},me.prototype.findInside=function(e){if(this.find)for(var t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)},me.prototype.findAround=function(e,t,i){if(e!=t&&this.find)for(var o=0;o<this.find.length;o++)null==this.find[o].pos&&1==e.nodeType&&e.contains(this.find[o].node)&&t.compareDocumentPosition(this.find[o].node)&(i?2:4)&&(this.find[o].pos=this.currentPos)},me.prototype.findInText=function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))},me.prototype.matchesContext=function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var i=e.split("/"),o=this.options.context,a=!(this.isOpen||o&&o.parent.type!=this.nodes[0].type),s=(a?0:1)-(o?o.depth+1:0),c=function(d,p){for(;d>=0;d--){var f=i[d];if(""==f){if(d==i.length-1||0==d)continue;for(;p>=s;p--)if(c(d-1,p))return!0;return!1}var m=p>0||0==p&&a?t.nodes[p].type:o&&p>=s?o.node(p-s).type:null;if(!m||m.name!=f&&-1==m.groups.indexOf(f))return!1;p--}return!0};return c(i.length-1,this.open)},me.prototype.textblockFromContext=function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var i=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(var o in this.parser.schema.nodes){var a=this.parser.schema.nodes[o];if(a.isTextblock&&a.defaultAttrs)return a}},me.prototype.addPendingMark=function(e){var t=function(n,e){for(var t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)},me.prototype.removePendingMark=function(e,t){for(var i=this.open;i>=0;i--){var o=this.nodes[i];if(o.pendingMarks.lastIndexOf(e)>-1)o.pendingMarks=e.removeFromSet(o.pendingMarks);else{o.activeMarks=e.removeFromSet(o.activeMarks);var s=o.popFromStashMark(e);s&&o.type&&o.type.allowsMarkType(s.type)&&(o.activeMarks=s.addToSet(o.activeMarks))}if(o==t)break}},Object.defineProperties(me.prototype,_r);var Le=function(e,t){this.nodes=e||{},this.marks=t||{}};function zo(n){var e={};for(var t in n){var i=n[t].spec.toDOM;i&&(e[t]=i)}return e}function vr(n){return n.document||window.document}Le.prototype.serializeFragment=function(e,t,i){var o=this;void 0===t&&(t={}),i||(i=vr(t).createDocumentFragment());var a=i,s=null;return e.forEach(function(c){if(s||c.marks.length){s||(s=[]);for(var d=0,p=0;d<s.length&&p<c.marks.length;){var f=c.marks[p];if(o.marks[f.type.name]){if(!f.eq(s[d])||!1===f.type.spec.spanning)break;d+=2,p++}else p++}for(;d<s.length;)a=s.pop(),s.pop();for(;p<c.marks.length;){var m=c.marks[p++],g=o.serializeMark(m,c.isInline,t);g&&(s.push(m,a),a.appendChild(g.dom),a=g.contentDOM||g.dom)}}a.appendChild(o.serializeNodeInner(c,t))}),i},Le.prototype.serializeNodeInner=function(e,t){void 0===t&&(t={});var i=Le.renderSpec(vr(t),this.nodes[e.type.name](e)),o=i.dom,a=i.contentDOM;if(a){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");t.onContent?t.onContent(e,a,t):this.serializeFragment(e.content,t,a)}return o},Le.prototype.serializeNode=function(e,t){void 0===t&&(t={});for(var i=this.serializeNodeInner(e,t),o=e.marks.length-1;o>=0;o--){var a=this.serializeMark(e.marks[o],e.isInline,t);a&&((a.contentDOM||a.dom).appendChild(i),i=a.dom)}return i},Le.prototype.serializeMark=function(e,t,i){void 0===i&&(i={});var o=this.marks[e.type.name];return o&&Le.renderSpec(vr(i),o(e,t))},Le.renderSpec=function(e,t,i){if(void 0===i&&(i=null),"string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;var o=t[0],a=o.indexOf(" ");a>0&&(i=o.slice(0,a),o=o.slice(a+1));var s=null,c=i?e.createElementNS(i,o):e.createElement(o),d=t[1],p=1;if(d&&"object"==typeof d&&null==d.nodeType&&!Array.isArray(d))for(var f in p=2,d)if(null!=d[f]){var m=f.indexOf(" ");m>0?c.setAttributeNS(f.slice(0,m),f.slice(m+1),d[f]):c.setAttribute(f,d[f])}for(var g=p;g<t.length;g++){var y=t[g];if(0===y){if(g<t.length-1||g>p)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}var T=Le.renderSpec(e,y,i),F=T.contentDOM;if(c.appendChild(T.dom),F){if(s)throw new RangeError("Multiple content holes");s=F}}return{dom:c,contentDOM:s}},Le.fromSchema=function(e){return e.cached.domSerializer||(e.cached.domSerializer=new Le(this.nodesFromSchema(e),this.marksFromSchema(e)))},Le.nodesFromSchema=function(e){var t=zo(e.nodes);return t.text||(t.text=function(i){return i.text}),t},Le.marksFromSchema=function(e){return zo(e.marks)};var Qo=Math.pow(2,16);function Il(n,e){return n+e*Qo}function Wo(n){return 65535&n}var br=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=null),this.pos=e,this.deleted=t,this.recover=i},Be=function(e,t){void 0===t&&(t=!1),this.ranges=e,this.inverted=t};Be.prototype.recover=function(e){var n,t=0,i=Wo(e);if(!this.inverted)for(var o=0;o<i;o++)t+=this.ranges[3*o+2]-this.ranges[3*o+1];return this.ranges[3*i]+t+((n=e)-(65535&n))/Qo},Be.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},Be.prototype.map=function(e,t){return void 0===t&&(t=1),this._map(e,t,!0)},Be.prototype._map=function(e,t,i){for(var o=0,a=this.inverted?2:1,s=this.inverted?1:2,c=0;c<this.ranges.length;c+=3){var d=this.ranges[c]-(this.inverted?o:0);if(d>e)break;var p=this.ranges[c+a],f=this.ranges[c+s],m=d+p;if(e<=m){var y=d+o+((p?e==d?-1:e==m?1:t:t)<0?0:f);if(i)return y;var T=e==(t<0?d:m)?null:Il(c/3,e-d);return new br(y,t<0?e!=d:e!=m,T)}o+=f-p}return i?e+o:new br(e+o)},Be.prototype.touches=function(e,t){for(var i=0,o=Wo(t),a=this.inverted?2:1,s=this.inverted?1:2,c=0;c<this.ranges.length;c+=3){var d=this.ranges[c]-(this.inverted?i:0);if(d>e)break;var p=this.ranges[c+a];if(e<=d+p&&c==3*o)return!0;i+=this.ranges[c+s]-p}return!1},Be.prototype.forEach=function(e){for(var t=this.inverted?2:1,i=this.inverted?1:2,o=0,a=0;o<this.ranges.length;o+=3){var s=this.ranges[o],c=s-(this.inverted?a:0),d=s+(this.inverted?0:a),p=this.ranges[o+t],f=this.ranges[o+i];e(c,c+p,d,d+f),a+=f-p}},Be.prototype.invert=function(){return new Be(this.ranges,!this.inverted)},Be.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},Be.offset=function(e){return 0==e?Be.empty:new Be(e<0?[0,-e,0]:[0,0,e])},Be.empty=new Be([]);var je=function(e,t,i,o){this.maps=e||[],this.from=i||0,this.to=null==o?this.maps.length:o,this.mirror=t};function jn(n){var e=Error.call(this,n);return e.__proto__=jn.prototype,e}je.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.maps.length),new je(this.maps,this.mirror,e,t)},je.prototype.copy=function(){return new je(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},je.prototype.appendMap=function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)},je.prototype.appendMapping=function(e){for(var t=0,i=this.maps.length;t<e.maps.length;t++){var o=e.getMirror(t);this.appendMap(e.maps[t],null!=o&&o<t?i+o:null)}},je.prototype.getMirror=function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]},je.prototype.setMirror=function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)},je.prototype.appendMappingInverted=function(e){for(var t=e.maps.length-1,i=this.maps.length+e.maps.length;t>=0;t--){var o=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=o&&o>t?i-o-1:null)}},je.prototype.invert=function(){var e=new je;return e.appendMappingInverted(this),e},je.prototype.map=function(e,t){if(void 0===t&&(t=1),this.mirror)return this._map(e,t,!0);for(var i=this.from;i<this.to;i++)e=this.maps[i].map(e,t);return e},je.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},je.prototype._map=function(e,t,i){for(var o=!1,a=this.from;a<this.to;a++){var c=this.maps[a].mapResult(e,t);if(null!=c.recover){var d=this.getMirror(a);if(null!=d&&d>a&&d<this.to){a=d,e=this.maps[d].recover(c.recover);continue}}c.deleted&&(o=!0),e=c.pos}return i?e:new br(e,o)},(jn.prototype=Object.create(Error.prototype)).constructor=jn,jn.prototype.name="TransformError";var ye=function(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new je},yr={before:{configurable:!0},docChanged:{configurable:!0}};function Bi(){throw new Error("Override me")}yr.before.get=function(){return this.docs.length?this.docs[0]:this.doc},ye.prototype.step=function(e){var t=this.maybeStep(e);if(t.failed)throw new jn(t.failed);return this},ye.prototype.maybeStep=function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t},yr.docChanged.get=function(){return this.steps.length>0},ye.prototype.addStep=function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t},Object.defineProperties(ye.prototype,yr);var xr=Object.create(null),Qe=function(){};Qe.prototype.apply=function(e){return Bi()},Qe.prototype.getMap=function(){return Be.empty},Qe.prototype.invert=function(e){return Bi()},Qe.prototype.map=function(e){return Bi()},Qe.prototype.merge=function(e){return null},Qe.prototype.toJSON=function(){return Bi()},Qe.fromJSON=function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var i=xr[t.stepType];if(!i)throw new RangeError("No step type "+t.stepType+" defined");return i.fromJSON(e,t)},Qe.jsonID=function(e,t){if(e in xr)throw new RangeError("Duplicate use of step JSON ID "+e);return xr[e]=t,t.prototype.jsonID=e,t};var $e=function(e,t){this.doc=e,this.failed=t};$e.ok=function(e){return new $e(e,null)},$e.fail=function(e){return new $e(null,e)},$e.fromReplace=function(e,t,i,o){try{return $e.ok(e.replace(t,i,o))}catch(a){if(a instanceof u)return $e.fail(a.message);throw a}};var dn=function(n){function e(t,i,o,a){n.call(this),this.from=t,this.to=i,this.slice=o,this.structure=!!a}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.apply=function(i){return this.structure&&Cr(i,this.from,this.to)?$e.fail("Structure replace would overwrite content"):$e.fromReplace(i,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new Be([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(i){return new e(this.from,this.from+this.slice.size,i.slice(this.from,this.to))},e.prototype.map=function(i){var o=i.mapResult(this.from,1),a=i.mapResult(this.to,-1);return o.deleted&&a.deleted?null:new e(o.pos,Math.max(o.pos,a.pos),this.slice)},e.prototype.merge=function(i){if(!(i instanceof e)||i.structure||this.structure)return null;if(this.from+this.slice.size!=i.from||this.slice.openEnd||i.slice.openStart){if(i.to!=this.from||this.slice.openStart||i.slice.openEnd)return null;var a=this.slice.size+i.slice.size==0?h.empty:new h(i.slice.content.append(this.slice.content),i.slice.openStart,this.slice.openEnd);return new e(i.from,this.to,a,this.structure)}var o=this.slice.size+i.slice.size==0?h.empty:new h(this.slice.content.append(i.slice.content),this.slice.openStart,i.slice.openEnd);return new e(this.from,this.to+(i.to-i.from),o,this.structure)},e.prototype.toJSON=function(){var i={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(i.slice=this.slice.toJSON()),this.structure&&(i.structure=!0),i},e.fromJSON=function(i,o){if("number"!=typeof o.from||"number"!=typeof o.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(o.from,o.to,h.fromJSON(i,o.slice),!!o.structure)},e}(Qe);Qe.jsonID("replace",dn);var ft=function(n){function e(t,i,o,a,s,c,d){n.call(this),this.from=t,this.to=i,this.gapFrom=o,this.gapTo=a,this.slice=s,this.insert=c,this.structure=!!d}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.apply=function(i){if(this.structure&&(Cr(i,this.from,this.gapFrom)||Cr(i,this.gapTo,this.to)))return $e.fail("Structure gap-replace would overwrite content");var o=i.slice(this.gapFrom,this.gapTo);if(o.openStart||o.openEnd)return $e.fail("Gap is not a flat range");var a=this.slice.insertAt(this.insert,o.content);return a?$e.fromReplace(i,this.from,this.to,a):$e.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new Be([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(i){var o=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+o,this.from+this.insert,this.from+this.insert+o,i.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(i){var o=i.mapResult(this.from,1),a=i.mapResult(this.to,-1),s=i.map(this.gapFrom,-1),c=i.map(this.gapTo,1);return o.deleted&&a.deleted||s<o.pos||c>a.pos?null:new e(o.pos,a.pos,s,c,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var i={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(i.slice=this.slice.toJSON()),this.structure&&(i.structure=!0),i},e.fromJSON=function(i,o){if("number"!=typeof o.from||"number"!=typeof o.to||"number"!=typeof o.gapFrom||"number"!=typeof o.gapTo||"number"!=typeof o.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(o.from,o.to,o.gapFrom,o.gapTo,h.fromJSON(i,o.slice),o.insert,!!o.structure)},e}(Qe);function Cr(n,e,t){for(var i=n.resolve(e),o=t-e,a=i.depth;o>0&&a>0&&i.indexAfter(a)==i.node(a).childCount;)a--,o--;if(o>0)for(var s=i.node(a).maybeChild(i.indexAfter(a));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function Ol(n,e,t){return(0==e||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function mi(n){for(var t=n.parent.content.cutByIndex(n.startIndex,n.endIndex),i=n.depth;;--i){var o=n.$from.node(i),a=n.$from.index(i),s=n.$to.indexAfter(i);if(i<n.depth&&o.canReplace(a,s,t))return i;if(0==i||o.type.spec.isolating||!Ol(o,a,s))break}}function Dr(n,e,t,i){void 0===i&&(i=n);var o=function(n,e){var t=n.parent,i=n.startIndex,o=n.endIndex,a=t.contentMatchAt(i).findWrapping(e);return a&&t.canReplaceWith(i,o,a.length?a[0]:e)?a:null}(n,e),a=o&&function(n,e){var t=n.parent,i=n.startIndex,o=n.endIndex,a=t.child(i),s=e.contentMatch.findWrapping(a.type);if(!s)return null;for(var d=(s.length?s[s.length-1]:e).contentMatch,p=i;d&&p<o;p++)d=d.matchType(t.child(p).type);return d&&d.validEnd?s:null}(i,e);return a?o.map(Go).concat({type:e,attrs:t}).concat(a.map(Go)):null}function Go(n){return{type:n,attrs:null}}function Qn(n,e,t,i){void 0===t&&(t=1);var o=n.resolve(e),a=o.depth-t,s=i&&i[i.length-1]||o.parent;if(a<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var c=o.depth-1,d=t-2;c>a;c--,d--){var p=o.node(c),f=o.index(c);if(p.type.spec.isolating)return!1;var m=p.content.cutByIndex(f,p.childCount),g=i&&i[d]||p;if(g!=p&&(m=m.replaceChild(0,g.type.create(g.attrs))),!p.canReplace(f+1,p.childCount)||!g.type.validContent(m))return!1}var y=o.indexAfter(a),T=i&&i[0];return o.node(a).canReplaceWith(y,y,T?T.type:o.node(a+1).type)}function Tr(n,e){var t=n.resolve(e),i=t.index();return function(n,e){return n&&e&&!n.isLeaf&&n.canAppend(e)}(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(i,i+1)}function Mr(n,e,t){for(var i=[],o=0;o<n.childCount;o++){var a=n.child(o);a.content.size&&(a=a.copy(Mr(a.content,e,a))),a.isInline&&(a=e(a,t,o)),i.push(a)}return w.fromArray(i)}Qe.jsonID("replaceAround",ft),ye.prototype.lift=function(n,e){for(var t=n.$from,i=n.$to,o=n.depth,a=t.before(o+1),s=i.after(o+1),c=a,d=s,p=w.empty,f=0,m=o,g=!1;m>e;m--)g||t.index(m)>0?(g=!0,p=w.from(t.node(m).copy(p)),f++):c--;for(var y=w.empty,T=0,E=o,F=!1;E>e;E--)F||i.after(E+1)<i.end(E)?(F=!0,y=w.from(i.node(E).copy(y)),T++):d++;return this.step(new ft(c,d,a,s,new h(p.append(y),f,T),p.size-f,!0))},ye.prototype.wrap=function(n,e){for(var t=w.empty,i=e.length-1;i>=0;i--)t=w.from(e[i].type.create(e[i].attrs,t));var o=n.start,a=n.end;return this.step(new ft(o,a,o,a,new h(t,0,0),e.length,!0))},ye.prototype.setBlockType=function(n,e,t,i){var o=this;if(void 0===e&&(e=n),!t.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var a=this.steps.length;return this.doc.nodesBetween(n,e,function(s,c){if(s.isTextblock&&!s.hasMarkup(t,i)&&function(n,e,t){var i=n.resolve(e),o=i.index();return i.parent.canReplaceWith(o,o+1,t)}(o.doc,o.mapping.slice(a).map(c),t)){o.clearIncompatible(o.mapping.slice(a).map(c,1),t);var d=o.mapping.slice(a),p=d.map(c,1),f=d.map(c+s.nodeSize,1);return o.step(new ft(p,f,p+1,f-1,new h(w.from(t.create(i,null,s.marks)),0,0),1,!0)),!1}}),this},ye.prototype.setNodeMarkup=function(n,e,t,i){var o=this.doc.nodeAt(n);if(!o)throw new RangeError("No node at given position");e||(e=o.type);var a=e.create(t,null,i||o.marks);if(o.isLeaf)return this.replaceWith(n,n+o.nodeSize,a);if(!e.validContent(o.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new ft(n,n+o.nodeSize,n+1,n+o.nodeSize-1,new h(w.from(a),0,0),1,!0))},ye.prototype.split=function(n,e,t){void 0===e&&(e=1);for(var i=this.doc.resolve(n),o=w.empty,a=w.empty,s=i.depth,c=i.depth-e,d=e-1;s>c;s--,d--){o=w.from(i.node(s).copy(o));var p=t&&t[d];a=w.from(p?p.type.create(p.attrs,a):i.node(s).copy(a))}return this.step(new dn(n,n,new h(o.append(a),e,e),!0))},ye.prototype.join=function(n,e){void 0===e&&(e=1);var t=new dn(n-e,n+e,h.empty,!0);return this.step(t)};var Ar=function(n){function e(t,i,o){n.call(this),this.from=t,this.to=i,this.mark=o}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.apply=function(i){var o=this,a=i.slice(this.from,this.to),s=i.resolve(this.from),c=s.node(s.sharedDepth(this.to)),d=new h(Mr(a.content,function(p,f){return p.isAtom&&f.type.allowsMarkType(o.mark.type)?p.mark(o.mark.addToSet(p.marks)):p},c),a.openStart,a.openEnd);return $e.fromReplace(i,this.from,this.to,d)},e.prototype.invert=function(){return new gi(this.from,this.to,this.mark)},e.prototype.map=function(i){var o=i.mapResult(this.from,1),a=i.mapResult(this.to,-1);return o.deleted&&a.deleted||o.pos>=a.pos?null:new e(o.pos,a.pos,this.mark)},e.prototype.merge=function(i){if(i instanceof e&&i.mark.eq(this.mark)&&this.from<=i.to&&this.to>=i.from)return new e(Math.min(this.from,i.from),Math.max(this.to,i.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(i,o){if("number"!=typeof o.from||"number"!=typeof o.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(o.from,o.to,i.markFromJSON(o.mark))},e}(Qe);Qe.jsonID("addMark",Ar);var gi=function(n){function e(t,i,o){n.call(this),this.from=t,this.to=i,this.mark=o}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.apply=function(i){var o=this,a=i.slice(this.from,this.to),s=new h(Mr(a.content,function(c){return c.mark(o.mark.removeFromSet(c.marks))}),a.openStart,a.openEnd);return $e.fromReplace(i,this.from,this.to,s)},e.prototype.invert=function(){return new Ar(this.from,this.to,this.mark)},e.prototype.map=function(i){var o=i.mapResult(this.from,1),a=i.mapResult(this.to,-1);return o.deleted&&a.deleted||o.pos>=a.pos?null:new e(o.pos,a.pos,this.mark)},e.prototype.merge=function(i){if(i instanceof e&&i.mark.eq(this.mark)&&this.from<=i.to&&this.to>=i.from)return new e(Math.min(this.from,i.from),Math.max(this.to,i.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(i,o){if("number"!=typeof o.from||"number"!=typeof o.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(o.from,o.to,i.markFromJSON(o.mark))},e}(Qe);function $o(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}Qe.jsonID("removeMark",gi),ye.prototype.addMark=function(n,e,t){var i=this,o=[],a=[],s=null,c=null;return this.doc.nodesBetween(n,e,function(d,p,f){if(d.isInline){var m=d.marks;if(!t.isInSet(m)&&f.type.allowsMarkType(t.type)){for(var g=Math.max(p,n),y=Math.min(p+d.nodeSize,e),T=t.addToSet(m),E=0;E<m.length;E++)m[E].isInSet(T)||(s&&s.to==g&&s.mark.eq(m[E])?s.to=y:o.push(s=new gi(g,y,m[E])));c&&c.to==g?c.to=y:a.push(c=new Ar(g,y,t))}}}),o.forEach(function(d){return i.step(d)}),a.forEach(function(d){return i.step(d)}),this},ye.prototype.removeMark=function(n,e,t){var i=this;void 0===t&&(t=null);var o=[],a=0;return this.doc.nodesBetween(n,e,function(s,c){if(s.isInline){a++;var d=null;if(t instanceof cn)for(var f,p=s.marks;f=t.isInSet(p);)(d||(d=[])).push(f),p=f.removeFromSet(p);else t?t.isInSet(s.marks)&&(d=[t]):d=s.marks;if(d&&d.length)for(var m=Math.min(c+s.nodeSize,e),g=0;g<d.length;g++){for(var y=d[g],T=void 0,E=0;E<o.length;E++){var F=o[E];F.step==a-1&&y.eq(o[E].style)&&(T=F)}T?(T.to=m,T.step=a):o.push({style:y,from:Math.max(c,n),to:m,step:a})}}}),o.forEach(function(s){return i.step(new gi(s.from,s.to,s.style))}),this},ye.prototype.clearIncompatible=function(n,e,t){void 0===t&&(t=e.contentMatch);for(var i=this.doc.nodeAt(n),o=[],a=n+1,s=0;s<i.childCount;s++){var c=i.child(s),d=a+c.nodeSize,p=t.matchType(c.type,c.attrs);if(p){t=p;for(var f=0;f<c.marks.length;f++)e.allowsMarkType(c.marks[f].type)||this.step(new gi(a,d,c.marks[f]))}else o.push(new dn(a,d,h.empty));a=d}if(!t.validEnd){var m=t.fillBefore(w.empty,!0);this.replace(a,a,new h(m,0,0))}for(var g=o.length-1;g>=0;g--)this.step(o[g]);return this},ye.prototype.replace=function(n,e,t){void 0===e&&(e=n),void 0===t&&(t=h.empty);var i=function(n,e,t,i){if(void 0===t&&(t=e),void 0===i&&(i=h.empty),e==t&&!i.size)return null;var o=n.resolve(e),a=n.resolve(t);return $o(o,a,i)?new dn(e,t,i):new Dt(o,a,i).fit()}(this.doc,n,e,t);return i&&this.step(i),this},ye.prototype.replaceWith=function(n,e,t){return this.replace(n,e,new h(w.from(t),0,0))},ye.prototype.delete=function(n,e){return this.replace(n,e,h.empty)},ye.prototype.insert=function(n,e){return this.replaceWith(n,n,e)};var Dt=function(e,t,i){this.$to=t,this.$from=e,this.unplaced=i,this.frontier=[];for(var o=0;o<=e.depth;o++){var a=e.node(o);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(o))})}this.placed=w.empty;for(var s=e.depth;s>0;s--)this.placed=w.from(e.node(s).copy(this.placed))},Xo={depth:{configurable:!0}};function _i(n,e,t){return 0==e?n.cutByIndex(t):n.replaceChild(0,n.firstChild.copy(_i(n.firstChild.content,e-1,t)))}function vi(n,e,t){return 0==e?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(vi(n.lastChild.content,e-1,t)))}function kr(n,e){for(var t=0;t<e;t++)n=n.firstChild.content;return n}function ea(n,e,t){if(e<=0)return n;var i=n.content;return e>1&&(i=i.replaceChild(0,ea(i.firstChild,e-1,1==i.childCount?t-1:0))),e>0&&(i=n.type.contentMatch.fillBefore(i).append(i),t<=0&&(i=i.append(n.type.contentMatch.matchFragment(i).fillBefore(w.empty,!0)))),n.copy(i)}function Sr(n,e,t,i,o){var a=n.node(e),s=o?n.indexAfter(e):n.index(e);if(s==a.childCount&&!t.compatibleContent(a.type))return null;var c=i.fillBefore(a.content,!0,s);return c&&!function(n,e,t){for(var i=t;i<e.childCount;i++)if(!n.allowsMarks(e.child(i).marks))return!0;return!1}(t,a.content,s)?c:null}function ta(n,e,t,i,o){if(e<t){var a=n.firstChild;n=n.replaceChild(0,a.copy(ta(a.content,e+1,t,i,a)))}if(e>i){var s=o.contentMatchAt(0),c=s.fillBefore(n).append(n);n=c.append(s.matchFragment(c).fillBefore(w.empty,!0))}return n}function na(n,e){for(var t=[],o=Math.min(n.depth,e.depth);o>=0;o--){var a=n.start(o);if(a<n.pos-(n.depth-o)||e.end(o)>e.pos+(e.depth-o)||n.node(o).type.spec.isolating||e.node(o).type.spec.isolating)break;(a==e.start(o)||o==n.depth&&o==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&o&&e.start(o-1)==a-1)&&t.push(o)}return t}Xo.depth.get=function(){return this.frontier.length-1},Dt.prototype.fit=function(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),i=this.placed.size-this.depth-this.$from.depth,o=this.$from,a=this.close(t<0?this.$to:o.doc.resolve(t));if(!a)return null;for(var s=this.placed,c=o.depth,d=a.depth;c&&d&&1==s.childCount;)s=s.firstChild.content,c--,d--;var p=new h(s,c,d);return t>-1?new ft(o.pos,t,this.$to.pos,this.$to.end(),p,i):p.size||o.pos!=this.$to.pos?new dn(o.pos,a.pos,p):void 0},Dt.prototype.findFittable=function(){for(var e=1;e<=2;e++)for(var t=this.unplaced.openStart;t>=0;t--)for(var o=void 0,a=(t?(o=kr(this.unplaced.content,t-1).firstChild).content:this.unplaced.content).firstChild,s=this.depth;s>=0;s--){var c=this.frontier[s],d=c.type,p=c.match,f=void 0,m=void 0;if(1==e&&(a?p.matchType(a.type)||(m=p.fillBefore(w.from(a),!1)):d.compatibleContent(o.type)))return{sliceDepth:t,frontierDepth:s,parent:o,inject:m};if(2==e&&a&&(f=p.findWrapping(a.type)))return{sliceDepth:t,frontierDepth:s,parent:o,wrap:f};if(o&&p.matchType(o.type))break}},Dt.prototype.openMore=function(){var e=this.unplaced,t=e.content,i=e.openStart,o=e.openEnd,a=kr(t,i);return!(!a.childCount||a.firstChild.isLeaf||(this.unplaced=new h(t,i+1,Math.max(o,a.size+i>=t.size-o?i+1:0)),0))},Dt.prototype.dropNode=function(){var e=this.unplaced,t=e.content,i=e.openStart,o=e.openEnd,a=kr(t,i);if(a.childCount<=1&&i>0){var s=t.size-i<=i+a.size;this.unplaced=new h(_i(t,i-1,1),i-1,s?i-1:o)}else this.unplaced=new h(_i(t,i,1),i,o)},Dt.prototype.placeNodes=function(e){for(var t=e.sliceDepth,i=e.frontierDepth,o=e.parent,a=e.inject,s=e.wrap;this.depth>i;)this.closeFrontierNode();if(s)for(var c=0;c<s.length;c++)this.openFrontierNode(s[c]);var d=this.unplaced,p=o?o.content:d.content,f=d.openStart-t,m=0,g=[],y=this.frontier[i],T=y.match,E=y.type;if(a){for(var F=0;F<a.childCount;F++)g.push(a.child(F));T=T.matchFragment(a)}for(var q=p.size+t-(d.content.size-d.openEnd);m<p.childCount;){var N=p.child(m),ee=T.matchType(N.type);if(!ee)break;(++m>1||0==f||N.content.size)&&(T=ee,g.push(ea(N.mark(E.allowedMarks(N.marks)),1==m?f:0,m==p.childCount?q:-1)))}var z=m==p.childCount;z||(q=-1),this.placed=vi(this.placed,i,w.from(g)),this.frontier[i].match=T,z&&q<0&&o&&o.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var G=0,se=p;G<q;G++){var Me=se.lastChild;this.frontier.push({type:Me.type,match:Me.contentMatchAt(Me.childCount)}),se=Me.content}this.unplaced=z?0==t?h.empty:new h(_i(d.content,t-1,1),t-1,q<0?d.openEnd:t-1):new h(_i(d.content,t,m),d.openStart,d.openEnd)},Dt.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var t,e=this.frontier[this.depth];if(!e.type.isTextblock||!Sr(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;for(var o=this.$to.depth,a=this.$to.after(o);o>1&&a==this.$to.end(--o);)++a;return a},Dt.prototype.findCloseLevel=function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var i=this.frontier[t],o=i.match,a=i.type,s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),c=Sr(e,t,a,o,s);if(c){for(var d=t-1;d>=0;d--){var p=this.frontier[d],g=Sr(e,d,p.type,p.match,!0);if(!g||g.childCount)continue e}return{depth:t,fit:c,move:s?e.doc.resolve(e.after(t+1)):e}}}},Dt.prototype.close=function(e){var t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=vi(this.placed,t.depth,t.fit)),e=t.move;for(var i=t.depth+1;i<=e.depth;i++){var o=e.node(i),a=o.type.contentMatch.fillBefore(o.content,!0,e.index(i));this.openFrontierNode(o.type,o.attrs,a)}return e},Dt.prototype.openFrontierNode=function(e,t,i){var o=this.frontier[this.depth];o.match=o.match.matchType(e),this.placed=vi(this.placed,this.depth,w.from(e.create(t,i))),this.frontier.push({type:e,match:e.contentMatch})},Dt.prototype.closeFrontierNode=function(){var t=this.frontier.pop().match.fillBefore(w.empty,!0);t.childCount&&(this.placed=vi(this.placed,this.frontier.length,t))},Object.defineProperties(Dt.prototype,Xo),ye.prototype.replaceRange=function(n,e,t){if(!t.size)return this.deleteRange(n,e);var i=this.doc.resolve(n),o=this.doc.resolve(e);if($o(i,o,t))return this.step(new dn(n,e,t));var a=na(i,this.doc.resolve(e));0==a[a.length-1]&&a.pop();var s=-(i.depth+1);a.unshift(s);for(var c=i.depth,d=i.pos-1;c>0;c--,d--){var p=i.node(c).type.spec;if(p.defining||p.isolating)break;a.indexOf(c)>-1?s=c:i.before(c)==d&&a.splice(1,0,-c)}for(var f=a.indexOf(s),m=[],g=t.openStart,y=t.content,T=0;;T++){var E=y.firstChild;if(m.push(E),T==t.openStart)break;y=E.content}g>0&&m[g-1].type.spec.defining&&i.node(f).type!=m[g-1].type?g-=1:g>=2&&m[g-1].isTextblock&&m[g-2].type.spec.defining&&i.node(f).type!=m[g-2].type&&(g-=2);for(var F=t.openStart;F>=0;F--){var q=(F+g+1)%(t.openStart+1),N=m[q];if(N)for(var ee=0;ee<a.length;ee++){var z=a[(ee+f)%a.length],G=!0;z<0&&(G=!1,z=-z);var se=i.node(z-1),Me=i.index(z-1);if(se.canReplaceWith(Me,Me,N.type,N.marks))return this.replace(i.before(z),G?o.after(z):e,new h(ta(t.content,0,t.openStart,q),q,t.openEnd))}}for(var xe=this.steps.length,ke=a.length-1;ke>=0&&(this.replace(n,e,t),!(this.steps.length>xe));ke--){var Ie=a[ke];Ie<0||(n=i.before(Ie),e=o.after(Ie))}return this},ye.prototype.replaceRangeWith=function(n,e,t){if(!t.isInline&&n==e&&this.doc.resolve(n).parent.content.size){var i=function(n,e,t){var i=n.resolve(e);if(i.parent.canReplaceWith(i.index(),i.index(),t))return e;if(0==i.parentOffset)for(var o=i.depth-1;o>=0;o--){var a=i.index(o);if(i.node(o).canReplaceWith(a,a,t))return i.before(o+1);if(a>0)return null}if(i.parentOffset==i.parent.content.size)for(var s=i.depth-1;s>=0;s--){var c=i.indexAfter(s);if(i.node(s).canReplaceWith(c,c,t))return i.after(s+1);if(c<i.node(s).childCount)return null}}(this.doc,n,t.type);null!=i&&(n=e=i)}return this.replaceRange(n,e,new h(w.from(t),0,0))},ye.prototype.deleteRange=function(n,e){for(var t=this.doc.resolve(n),i=this.doc.resolve(e),o=na(t,i),a=0;a<o.length;a++){var s=o[a],c=a==o.length-1;if(c&&0==s||t.node(s).type.contentMatch.validEnd)return this.delete(t.start(s),i.end(s));if(s>0&&(c||t.node(s-1).canReplace(t.index(s-1),i.indexAfter(s-1))))return this.delete(t.before(s),i.after(s))}for(var d=1;d<=t.depth&&d<=i.depth;d++)if(n-t.start(d)==t.depth-d&&e>t.end(d)&&i.end(d)-e!=i.depth-d)return this.delete(t.before(d),e);return this.delete(n,e)};var Er=Object.create(null),de=function(e,t,i){this.ranges=i||[new ql(e.min(t),e.max(t))],this.$anchor=e,this.$head=t},un={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};un.anchor.get=function(){return this.$anchor.pos},un.head.get=function(){return this.$head.pos},un.from.get=function(){return this.$from.pos},un.to.get=function(){return this.$to.pos},un.$from.get=function(){return this.ranges[0].$from},un.$to.get=function(){return this.ranges[0].$to},un.empty.get=function(){for(var n=this.ranges,e=0;e<n.length;e++)if(n[e].$from.pos!=n[e].$to.pos)return!1;return!0},de.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},de.prototype.replace=function(e,t){void 0===t&&(t=h.empty);for(var i=t.content.lastChild,o=null,a=0;a<t.openEnd;a++)o=i,i=i.lastChild;for(var s=e.steps.length,c=this.ranges,d=0;d<c.length;d++){var p=c[d],f=p.$from,m=p.$to,g=e.mapping.slice(s);e.replaceRange(g.map(f.pos),g.map(m.pos),d?h.empty:t),0==d&&ia(e,s,(i?i.isInline:o&&o.isTextblock)?-1:1)}},de.prototype.replaceWith=function(e,t){for(var i=e.steps.length,o=this.ranges,a=0;a<o.length;a++){var s=o[a],c=s.$from,d=s.$to,p=e.mapping.slice(i),f=p.map(c.pos),m=p.map(d.pos);a?e.deleteRange(f,m):(e.replaceRangeWith(f,m,t),ia(e,i,t.isInline?-1:1))}},de.findFrom=function(e,t,i){var o=e.parent.inlineContent?new be(e):Wn(e.node(0),e.parent,e.pos,e.index(),t,i);if(o)return o;for(var a=e.depth-1;a>=0;a--){var s=t<0?Wn(e.node(0),e.node(a),e.before(a+1),e.index(a),t,i):Wn(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,t,i);if(s)return s}},de.near=function(e,t){return void 0===t&&(t=1),this.findFrom(e,t)||this.findFrom(e,-t)||new Wt(e.node(0))},de.atStart=function(e){return Wn(e,e,0,0,1)||new Wt(e)},de.atEnd=function(e){return Wn(e,e,e.content.size,e.childCount,-1)||new Wt(e)},de.fromJSON=function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var i=Er[t.type];if(!i)throw new RangeError("No selection type "+t.type+" defined");return i.fromJSON(e,t)},de.jsonID=function(e,t){if(e in Er)throw new RangeError("Duplicate use of selection JSON ID "+e);return Er[e]=t,t.prototype.jsonID=e,t},de.prototype.getBookmark=function(){return be.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(de.prototype,un),de.prototype.visible=!0;var ql=function(e,t){this.$from=e,this.$to=t},be=function(n){function e(i,o){void 0===o&&(o=i),n.call(this,i,o)}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={$cursor:{configurable:!0}};return t.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(o,a){var s=o.resolve(a.map(this.head));if(!s.parent.inlineContent)return n.near(s);var c=o.resolve(a.map(this.anchor));return new e(c.parent.inlineContent?c:s,s)},e.prototype.replace=function(o,a){if(void 0===a&&(a=h.empty),n.prototype.replace.call(this,o,a),a==h.empty){var s=this.$from.marksAcross(this.$to);s&&o.ensureMarks(s)}},e.prototype.eq=function(o){return o instanceof e&&o.anchor==this.anchor&&o.head==this.head},e.prototype.getBookmark=function(){return new bi(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(o,a){if("number"!=typeof a.anchor||"number"!=typeof a.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(o.resolve(a.anchor),o.resolve(a.head))},e.create=function(o,a,s){void 0===s&&(s=a);var c=o.resolve(a);return new this(c,s==a?c:o.resolve(s))},e.between=function(o,a,s){var c=o.pos-a.pos;if((!s||c)&&(s=c>=0?1:-1),!a.parent.inlineContent){var d=n.findFrom(a,s,!0)||n.findFrom(a,-s,!0);if(!d)return n.near(a,s);a=d.$head}return o.parent.inlineContent||(0==c||(o=(n.findFrom(o,-s,!0)||n.findFrom(o,s,!0)).$anchor).pos<a.pos!=c<0)&&(o=a),new e(o,a)},Object.defineProperties(e.prototype,t),e}(de);de.jsonID("text",be);var bi=function(e,t){this.anchor=e,this.head=t};bi.prototype.map=function(e){return new bi(e.map(this.anchor),e.map(this.head))},bi.prototype.resolve=function(e){return be.between(e.resolve(this.anchor),e.resolve(this.head))};var te=function(n){function e(t){var i=t.nodeAfter,o=t.node(0).resolve(t.pos+i.nodeSize);n.call(this,t,o),this.node=i}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.map=function(i,o){var a=o.mapResult(this.anchor),s=a.deleted,d=i.resolve(a.pos);return s?n.near(d):new e(d)},e.prototype.content=function(){return new h(w.from(this.node),0,0)},e.prototype.eq=function(i){return i instanceof e&&i.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new Vi(this.anchor)},e.fromJSON=function(i,o){if("number"!=typeof o.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(i.resolve(o.anchor))},e.create=function(i,o){return new this(i.resolve(o))},e.isSelectable=function(i){return!i.isText&&!1!==i.type.spec.selectable},e}(de);te.prototype.visible=!1,de.jsonID("node",te);var Vi=function(e){this.anchor=e};Vi.prototype.map=function(e){var t=e.mapResult(this.anchor),o=t.pos;return t.deleted?new bi(o,o):new Vi(o)},Vi.prototype.resolve=function(e){var t=e.resolve(this.anchor),i=t.nodeAfter;return i&&te.isSelectable(i)?new te(t):de.near(t)};var Wt=function(n){function e(t){n.call(this,t.resolve(0),t.resolve(t.content.size))}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.replace=function(i,o){if(void 0===o&&(o=h.empty),o==h.empty){i.delete(0,i.doc.content.size);var a=n.atStart(i.doc);a.eq(i.selection)||i.setSelection(a)}else n.prototype.replace.call(this,i,o)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(i){return new e(i)},e.prototype.map=function(i){return new e(i)},e.prototype.eq=function(i){return i instanceof e},e.prototype.getBookmark=function(){return Ul},e}(de);de.jsonID("all",Wt);var Ul={map:function(){return this},resolve:function(e){return new Wt(e)}};function Wn(n,e,t,i,o,a){if(e.inlineContent)return be.create(n,t);for(var s=i-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var c=e.child(s);if(c.isAtom){if(!a&&te.isSelectable(c))return te.create(n,t-(o<0?c.nodeSize:0))}else{var d=Wn(n,c,t+o,o<0?c.childCount:0,o,a);if(d)return d}t+=c.nodeSize*o}}function ia(n,e,t){var i=n.steps.length-1;if(!(i<e)){var s,o=n.steps[i];(o instanceof dn||o instanceof ft)&&(n.mapping.maps[i].forEach(function(c,d,p,f){null==s&&(s=f)}),n.setSelection(de.near(n.doc.resolve(s),t)))}}var Yl=function(n){function e(i){n.call(this,i.doc),this.time=Date.now(),this.curSelection=i.selection,this.curSelectionFor=0,this.storedMarks=i.storedMarks,this.updated=0,this.meta=Object.create(null)}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return t.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(o){if(o.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=o,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},t.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(o){return this.storedMarks=o,this.updated|=2,this},e.prototype.ensureMarks=function(o){return C.sameSet(this.storedMarks||this.selection.$from.marks(),o)||this.setStoredMarks(o),this},e.prototype.addStoredMark=function(o){return this.ensureMarks(o.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(o){return this.ensureMarks(o.removeFromSet(this.storedMarks||this.selection.$head.marks()))},t.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(o,a){n.prototype.addStep.call(this,o,a),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(o){return this.time=o,this},e.prototype.replaceSelection=function(o){return this.selection.replace(this,o),this},e.prototype.replaceSelectionWith=function(o,a){var s=this.selection;return!1!==a&&(o=o.mark(this.storedMarks||(s.empty?s.$from.marks():s.$from.marksAcross(s.$to)||C.none))),s.replaceWith(this,o),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(o,a,s){void 0===s&&(s=a);var c=this.doc.type.schema;if(null==a)return o?this.replaceSelectionWith(c.text(o),!0):this.deleteSelection();if(!o)return this.deleteRange(a,s);var d=this.storedMarks;if(!d){var p=this.doc.resolve(a);d=s==a?p.marks():p.marksAcross(this.doc.resolve(s))}return this.replaceRangeWith(a,s,c.text(o,d)),this.selection.empty||this.setSelection(de.near(this.selection.$to)),this},e.prototype.setMeta=function(o,a){return this.meta["string"==typeof o?o:o.key]=a,this},e.prototype.getMeta=function(o){return this.meta["string"==typeof o?o:o.key]},t.isGeneric.get=function(){for(var i in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},t.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,t),e}(ye);function aa(n,e){return e&&n?n.bind(e):n}var yi=function(e,t,i){this.name=e,this.init=aa(t.init,i),this.apply=aa(t.apply,i)},Hl=[new yi("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new yi("selection",{init:function(e,t){return e.selection||de.atStart(t.doc)},apply:function(e){return e.selection}}),new yi("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,i,o){return o.selection.$cursor?e.storedMarks:null}}),new yi("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],wr=function(e,t){var i=this;this.schema=e,this.fields=Hl.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),t&&t.forEach(function(o){if(i.pluginsByKey[o.key])throw new RangeError("Adding different instances of a keyed plugin ("+o.key+")");i.plugins.push(o),i.pluginsByKey[o.key]=o,o.spec.state&&i.fields.push(new yi(o.key,o.spec.state,o))})},We=function(e){this.config=e},Ui={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Ui.schema.get=function(){return this.config.schema},Ui.plugins.get=function(){return this.config.plugins},We.prototype.apply=function(e){return this.applyTransaction(e).state},We.prototype.filterTransaction=function(e,t){void 0===t&&(t=-1);for(var i=0;i<this.config.plugins.length;i++)if(i!=t){var o=this.config.plugins[i];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,e,this))return!1}return!0},We.prototype.applyTransaction=function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var t=[e],i=this.applyInner(e),o=null;;){for(var a=!1,s=0;s<this.config.plugins.length;s++){var c=this.config.plugins[s];if(c.spec.appendTransaction){var d=o?o[s].n:0,p=o?o[s].state:this,f=d<t.length&&c.spec.appendTransaction.call(c,d?t.slice(d):t,p,i);if(f&&i.filterTransaction(f,s)){if(f.setMeta("appendedTransaction",e),!o){o=[];for(var m=0;m<this.config.plugins.length;m++)o.push(m<s?{state:i,n:t.length}:{state:this,n:0})}t.push(f),i=i.applyInner(f),a=!0}o&&(o[s]={state:i,n:t.length})}}if(!a)return{state:i,transactions:t}}},We.prototype.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var t=new We(this.config),i=this.config.fields,o=0;o<i.length;o++){var a=i[o];t[a.name]=a.apply(e,this[a.name],this,t)}for(var s=0;s<xi.length;s++)xi[s](this,e,t);return t},Ui.tr.get=function(){return new Yl(this)},We.create=function(e){for(var t=new wr(e.doc?e.doc.type.schema:e.schema,e.plugins),i=new We(t),o=0;o<t.fields.length;o++)i[t.fields[o].name]=t.fields[o].init(e,i);return i},We.prototype.reconfigure=function(e){for(var t=new wr(this.schema,e.plugins),i=t.fields,o=new We(t),a=0;a<i.length;a++){var s=i[a].name;o[s]=this.hasOwnProperty(s)?this[s]:i[a].init(e,o)}return o},We.prototype.toJSON=function(e){var t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(function(s){return s.toJSON()})),e&&"object"==typeof e)for(var i in e){if("doc"==i||"selection"==i)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var o=e[i],a=o.spec.state;a&&a.toJSON&&(t[i]=a.toJSON.call(o,this[o.key]))}return t},We.fromJSON=function(e,t,i){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var o=new wr(e.schema,e.plugins),a=new We(o);return o.fields.forEach(function(s){if("doc"==s.name)a.doc=ae.fromJSON(e.schema,t.doc);else if("selection"==s.name)a.selection=de.fromJSON(a.doc,t.selection);else if("storedMarks"==s.name)t.storedMarks&&(a.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(i)for(var c in i){var d=i[c],p=d.spec.state;if(d.key==s.name&&p&&p.fromJSON&&Object.prototype.hasOwnProperty.call(t,c))return void(a[s.name]=p.fromJSON.call(d,e,t[c],a))}a[s.name]=s.init(e,a)}}),a},We.addApplyListener=function(e){xi.push(e)},We.removeApplyListener=function(e){var t=xi.indexOf(e);t>-1&&xi.splice(t,1)},Object.defineProperties(We.prototype,Ui);var xi=[];function sa(n,e,t){for(var i in n){var o=n[i];o instanceof Function?o=o.bind(e):"handleDOMEvents"==i&&(o=sa(o,e,{})),t[i]=o}return t}var St=function(e){this.props={},e.props&&sa(e.props,this,this.props),this.spec=e,this.key=e.key?e.key.key:la("plugin")};St.prototype.getState=function(e){return e[this.key]};var Ir=Object.create(null);function la(n){return n in Ir?n+"$"+ ++Ir[n]:(Ir[n]=0,n+"$")}var Et=function(e){void 0===e&&(e="key"),this.key=la(e)};Et.prototype.get=function(e){return e.config.pluginsByKey[this.key]},Et.prototype.getState=function(e){return e[this.key]};var R={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Rr=/Edge\/(\d+)/.exec(navigator.userAgent),ca=/MSIE \d/.test(navigator.userAgent),Or=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Nr=R.ie=!!(ca||Or||Rr);R.ie_version=ca?document.documentMode||6:Or?+Or[1]:Rr?+Rr[1]:null,R.gecko=!Nr&&/gecko\/(\d+)/i.test(navigator.userAgent),R.gecko_version=R.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Zr=!Nr&&/Chrome\/(\d+)/.exec(navigator.userAgent);R.chrome=!!Zr,R.chrome_version=Zr&&+Zr[1],R.safari=!Nr&&/Apple Computer/.test(navigator.vendor),R.ios=R.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),R.mac=R.ios||/Mac/.test(navigator.platform),R.android=/Android \d/.test(navigator.userAgent),R.webkit="webkitFontSmoothing"in document.documentElement.style,R.webkit_version=R.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var mt=function(n){for(var e=0;;e++)if(!(n=n.previousSibling))return e},Pr=function(n){var e=n.assignedSlot||n.parentNode;return e&&11==e.nodeType?e.host:e},da=null,Gt=function(n,e,t){var i=da||(da=document.createRange());return i.setEnd(n,null==t?n.nodeValue.length:t),i.setStart(n,e||0),i},Ci=function(n,e,t,i){return t&&(ua(n,e,t,i,-1)||ua(n,e,t,i,1))},Jl=/^(img|br|input|textarea|hr)$/i;function ua(n,e,t,i,o){for(;;){if(n==t&&e==i)return!0;if(e==(o<0?0:Ft(n))){var a=n.parentNode;if(1!=a.nodeType||jl(n)||Jl.test(n.nodeName)||"false"==n.contentEditable)return!1;e=mt(n)+(o<0?0:1),n=a}else{if(1!=n.nodeType)return!1;if("false"==(n=n.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?Ft(n):0}}}function Ft(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function jl(n){for(var e,t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}var Fr=function(n){var e=n.isCollapsed;return e&&R.chrome&&n.rangeCount&&!n.getRangeAt(0).collapsed&&(e=!1),e};function Gn(n,e){var t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function Ql(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function pn(n,e){return"number"==typeof n?n:n[e]}function Wl(n){var e=n.getBoundingClientRect();return{left:e.left,right:e.left+n.clientWidth*(e.width/n.offsetWidth||1),top:e.top,bottom:e.top+n.clientHeight*(e.height/n.offsetHeight||1)}}function ha(n){for(var e=[],t=n.ownerDocument;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),n!=t);n=Pr(n));return e}function fa(n,e){for(var t=0;t<n.length;t++){var i=n[t],o=i.dom,a=i.top,s=i.left;o.scrollTop!=a+e&&(o.scrollTop=a+e),o.scrollLeft!=s&&(o.scrollLeft=s)}}var Kn=null;function ma(n,e){for(var t,o,i=2e8,a=0,s=e.top,c=e.top,d=n.firstChild,p=0;d;d=d.nextSibling,p++){var f=void 0;if(1==d.nodeType)f=d.getClientRects();else{if(3!=d.nodeType)continue;f=Gt(d).getClientRects()}for(var m=0;m<f.length;m++){var g=f[m];if(g.top<=s&&g.bottom>=c){s=Math.max(g.bottom,s),c=Math.min(g.top,c);var y=g.left>e.left?g.left-e.left:g.right<e.left?e.left-g.right:0;if(y<i){t=d,i=y,o=y&&3==t.nodeType?{left:g.right<e.left?g.right:g.left,top:e.top}:e,1==d.nodeType&&y&&(a=p+(e.left>=(g.left+g.right)/2?1:0));continue}}!t&&(e.left>=g.right&&e.top>=g.top||e.left>=g.left&&e.top>=g.bottom)&&(a=p+1)}}return t&&3==t.nodeType?function(n,e){for(var t=n.nodeValue.length,i=document.createRange(),o=0;o<t;o++){i.setEnd(n,o+1),i.setStart(n,o);var a=hn(i,1);if(a.top!=a.bottom&&Lr(e,a))return{node:n,offset:o+(e.left>=(a.left+a.right)/2?1:0)}}return{node:n,offset:0}}(t,o):!t||i&&1==t.nodeType?{node:n,offset:a}:ma(t,o)}function Lr(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function ga(n,e,t){var i=n.childNodes.length;if(i&&t.top<t.bottom)for(var o=Math.max(0,Math.min(i-1,Math.floor(i*(e.top-t.top)/(t.bottom-t.top))-2)),a=o;;){var s=n.childNodes[a];if(1==s.nodeType)for(var c=s.getClientRects(),d=0;d<c.length;d++){var p=c[d];if(Lr(e,p))return ga(s,e,p)}if((a=(a+1)%i)==o)break}return n}function ic(n,e){var t,i,a,s,o=n.dom.ownerDocument;if(o.caretPositionFromPoint)try{var c=o.caretPositionFromPoint(e.left,e.top);c&&(a=(t=c).offsetNode,s=t.offset)}catch(F){}if(!a&&o.caretRangeFromPoint){var d=o.caretRangeFromPoint(e.left,e.top);d&&(a=(i=d).startContainer,s=i.startOffset)}var f,p=(n.root.elementFromPoint?n.root:o).elementFromPoint(e.left,e.top+1);if(!p||!n.dom.contains(1!=p.nodeType?p.parentNode:p)){var m=n.dom.getBoundingClientRect();if(!Lr(e,m)||!(p=ga(n.dom,e,m)))return null}if(R.safari)for(var g=p;a&&g;g=Pr(g))g.draggable&&(a=s=null);if(p=function(n,e){var t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}(p,e),a){if(R.gecko&&1==a.nodeType&&(s=Math.min(s,a.childNodes.length))<a.childNodes.length){var T,y=a.childNodes[s];"IMG"==y.nodeName&&(T=y.getBoundingClientRect()).right<=e.left&&T.bottom>e.top&&s++}a==n.dom&&s==a.childNodes.length-1&&1==a.lastChild.nodeType&&e.top>a.lastChild.getBoundingClientRect().bottom?f=n.state.doc.content.size:(0==s||1!=a.nodeType||"BR"!=a.childNodes[s-1].nodeName)&&(f=function(n,e,t,i){for(var o=-1,a=e;a!=n.dom;){var s=n.docView.nearestDesc(a,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var c=s.dom.getBoundingClientRect();if(c.left>i.left||c.top>i.top)o=s.posBefore;else{if(!(c.right<i.left||c.bottom<i.top))break;o=s.posAfter}}a=s.dom.parentNode}return o>-1?o:n.docView.posFromDOM(e,t)}(n,a,s,e))}null==f&&(f=function(n,e,t){var i=ma(e,t),o=i.node,a=i.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var c=o.getBoundingClientRect();s=c.left!=c.right&&t.left>(c.left+c.right)/2?1:-1}return n.docView.posFromDOM(o,a,s)}(n,p,e));var E=n.docView.nearestDesc(p,!0);return{pos:f,inside:E?E.posAtStart-E.border:-1}}function hn(n,e){var t=n.getClientRects();return t.length?t[e<0?0:t.length-1]:n.getBoundingClientRect()}var rc=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function _a(n,e,t){var i=n.docView.domFromPos(e,t<0?-1:1),o=i.node,a=i.offset,s=R.webkit||R.gecko;if(3==o.nodeType){if(!s||!rc.test(o.nodeValue)&&(t<0?a:a!=o.nodeValue.length)){var f=a,m=a,g=t<0?1:-1;return t<0&&!a?(m++,g=-1):t>=0&&a==o.nodeValue.length?(f--,g=1):t<0?f--:m++,Di(hn(Gt(o,f,m),g),g<0)}var c=hn(Gt(o,a,a),t);if(R.gecko&&a&&/\s/.test(o.nodeValue[a-1])&&a<o.nodeValue.length){var d=hn(Gt(o,a-1,a-1),-1);if(d.top==c.top){var p=hn(Gt(o,a,a+1),-1);if(p.top!=c.top)return Di(p,p.left<d.left)}}return c}if(!n.state.doc.resolve(e).parent.inlineContent){if(a&&(t<0||a==Ft(o))){var y=o.childNodes[a-1];if(1==y.nodeType)return Br(y.getBoundingClientRect(),!1)}if(a<Ft(o)){var T=o.childNodes[a];if(1==T.nodeType)return Br(T.getBoundingClientRect(),!0)}return Br(o.getBoundingClientRect(),t>=0)}if(a&&(t<0||a==Ft(o))){var E=o.childNodes[a-1],F=3==E.nodeType?Gt(E,Ft(E)-(s?0:1)):1!=E.nodeType||"BR"==E.nodeName&&E.nextSibling?null:E;if(F)return Di(hn(F,1),!1)}if(a<Ft(o)){for(var q=o.childNodes[a];q.pmViewDesc&&q.pmViewDesc.ignoreForCoords;)q=q.nextSibling;var N=q?3==q.nodeType?Gt(q,0,s?0:1):1==q.nodeType?q:null:null;if(N)return Di(hn(N,-1),!0)}return Di(hn(3==o.nodeType?Gt(o):o,-t),t>=0)}function Di(n,e){if(0==n.width)return n;var t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Br(n,e){if(0==n.height)return n;var t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function va(n,e,t){var i=n.state,o=n.root.activeElement;i!=e&&n.updateState(e),o!=n.dom&&n.focus();try{return t()}finally{i!=e&&n.updateState(i),o!=n.dom&&o&&o.focus()}}var ac=/[\u0590-\u08ac]/,ba=null,ya=null,xa=!1;var fe=function(e,t,i,o){this.parent=e,this.children=t,this.dom=i,i.pmViewDesc=this,this.contentDOM=o,this.dirty=0},Lt={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};fe.prototype.matchesWidget=function(){return!1},fe.prototype.matchesMark=function(){return!1},fe.prototype.matchesNode=function(){return!1},fe.prototype.matchesHack=function(e){return!1},fe.prototype.parseRule=function(){return null},fe.prototype.stopEvent=function(){return!1},Lt.size.get=function(){for(var n=0,e=0;e<this.children.length;e++)n+=this.children[e].size;return n},Lt.border.get=function(){return 0},fe.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var e=0;e<this.children.length;e++)this.children[e].destroy()},fe.prototype.posBeforeChild=function(e){for(var t=0,i=this.posAtStart;t<this.children.length;t++){var o=this.children[t];if(o==e)return i;i+=o.size}},Lt.posBefore.get=function(){return this.parent.posBeforeChild(this)},Lt.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Lt.posAfter.get=function(){return this.posBefore+this.size},Lt.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},fe.prototype.localPosFromDOM=function(e,t,i){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(i<0){var o,a;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&(!(a=o.pmViewDesc)||a.parent!=this);)o=o.previousSibling;return o?this.posBeforeChild(a)+a.size:this.posAtStart}var s,c;if(e==this.contentDOM)s=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&(!(c=s.pmViewDesc)||c.parent!=this);)s=s.nextSibling;return s?this.posBeforeChild(c):this.posAtEnd}var d;if(e==this.dom&&this.contentDOM)d=t>mt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))d=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(var p=e;;p=p.parentNode){if(p==this.dom){d=!1;break}if(p.parentNode.firstChild!=p)break}if(null==d&&t==e.childNodes.length)for(var f=e;;f=f.parentNode){if(f==this.dom){d=!0;break}if(f.parentNode.lastChild!=f)break}}return(null==d?i>0:d)?this.posAtEnd:this.posAtStart},fe.prototype.nearestDesc=function(e,t){for(var i=!0,o=e;o;o=o.parentNode){var a=this.getDesc(o);if(a&&(!t||a.node)){if(!i||!a.nodeDOM||(1==a.nodeDOM.nodeType?a.nodeDOM.contains(1==e.nodeType?e:e.parentNode):a.nodeDOM==e))return a;i=!1}}},fe.prototype.getDesc=function(e){for(var t=e.pmViewDesc,i=t;i;i=i.parent)if(i==this)return t},fe.prototype.posFromDOM=function(e,t,i){for(var o=e;o;o=o.parentNode){var a=this.getDesc(o);if(a)return a.localPosFromDOM(e,t,i)}return-1},fe.prototype.descAt=function(e){for(var t=0,i=0;t<this.children.length;t++){var o=this.children[t],a=i+o.size;if(i==e&&a!=i){for(;!o.border&&o.children.length;)o=o.children[0];return o}if(e<a)return o.descAt(e-i-o.border);i=a}},fe.prototype.domFromPos=function(e,t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var i=0,o=0,a=0;i<this.children.length;i++){var s=this.children[i],c=a+s.size;if(c>e||s instanceof Aa){o=e-a;break}a=c}if(o)return this.children[i].domFromPos(o-this.children[i].border,t);for(var d=void 0;i&&!(d=this.children[i-1]).size&&d instanceof Da&&d.widget.type.side>=0;i--);if(t<=0){for(var p,f=!0;(p=i?this.children[i-1]:null)&&p.dom.parentNode!=this.contentDOM;i--,f=!1);return p&&t&&f&&!p.border&&!p.domAtom?p.domFromPos(p.size,t):{node:this.contentDOM,offset:p?mt(p.dom)+1:0}}for(var m,g=!0;(m=i<this.children.length?this.children[i]:null)&&m.dom.parentNode!=this.contentDOM;i++,g=!1);return m&&g&&!m.border&&!m.domAtom?m.domFromPos(0,t):{node:this.contentDOM,offset:m?mt(m.dom):this.contentDOM.childNodes.length}},fe.prototype.parseRange=function(e,t,i){if(void 0===i&&(i=0),0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var o=-1,a=-1,s=i,c=0;;c++){var d=this.children[c],p=s+d.size;if(-1==o&&e<=p){var f=s+d.border;if(e>=f&&t<=p-d.border&&d.node&&d.contentDOM&&this.contentDOM.contains(d.contentDOM))return d.parseRange(e,t,f);e=s;for(var m=c;m>0;m--){var g=this.children[m-1];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(1)){o=mt(g.dom)+1;break}e-=g.size}-1==o&&(o=0)}if(o>-1&&(p>t||c==this.children.length-1)){t=p;for(var y=c+1;y<this.children.length;y++){var T=this.children[y];if(T.size&&T.dom.parentNode==this.contentDOM&&!T.emptyChildAt(-1)){a=mt(T.dom);break}t+=T.size}-1==a&&(a=this.contentDOM.childNodes.length);break}s=p}return{node:this.contentDOM,from:e,to:t,fromOffset:o,toOffset:a}},fe.prototype.emptyChildAt=function(e){if(this.border||!this.contentDOM||!this.children.length)return!1;var t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)},fe.prototype.domAfterPos=function(e){var t=this.domFromPos(e,0),i=t.node,o=t.offset;if(1!=i.nodeType||o==i.childNodes.length)throw new RangeError("No node after pos "+e);return i.childNodes[o]},fe.prototype.setSelection=function(e,t,i,o){for(var a=Math.min(e,t),s=Math.max(e,t),c=0,d=0;c<this.children.length;c++){var p=this.children[c],f=d+p.size;if(a>d&&s<f)return p.setSelection(e-d-p.border,t-d-p.border,i,o);d=f}var m=this.domFromPos(e,e?-1:1),g=t==e?m:this.domFromPos(t,t?-1:1),y=i.getSelection(),T=!1;if((R.gecko||R.safari)&&e==t){var E=m.node,F=m.offset;if(3==E.nodeType){if((T=F&&"\n"==E.nodeValue[F-1])&&F==E.nodeValue.length)for(var q=E,N=void 0;q;q=q.parentNode){if(N=q.nextSibling){"BR"==N.nodeName&&(m=g={node:N.parentNode,offset:mt(N)+1});break}var ee=q.pmViewDesc;if(ee&&ee.node&&ee.node.isBlock)break}}else{var z=E.childNodes[F-1];T=z&&("BR"==z.nodeName||"false"==z.contentEditable)}}if(R.gecko&&y.focusNode&&y.focusNode!=g.node&&1==y.focusNode.nodeType){var G=y.focusNode.childNodes[y.focusOffset];G&&"false"==G.contentEditable&&(o=!0)}if(o||T&&R.safari||!Ci(m.node,m.offset,y.anchorNode,y.anchorOffset)||!Ci(g.node,g.offset,y.focusNode,y.focusOffset)){var se=!1;if((y.extend||e==t)&&!T){y.collapse(m.node,m.offset);try{e!=t&&y.extend(g.node,g.offset),se=!0}catch(ke){if(!(ke instanceof DOMException))throw ke}}if(!se){if(e>t){var Me=m;m=g,g=Me}var xe=document.createRange();xe.setEnd(g.node,g.offset),xe.setStart(m.node,m.offset),y.removeAllRanges(),y.addRange(xe)}}},fe.prototype.ignoreMutation=function(e){return!this.contentDOM&&"selection"!=e.type},Lt.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},fe.prototype.markDirty=function(e,t){for(var i=0,o=0;o<this.children.length;o++){var a=this.children[o],s=i+a.size;if(i==s?e<=s&&t>=i:e<s&&t>i){var c=i+a.border,d=s-a.border;if(e>=c&&t<=d)return this.dirty=e==i||t==s?2:1,void(e!=c||t!=d||!a.contentLost&&a.dom.parentNode==this.contentDOM?a.markDirty(e-c,t-c):a.dirty=3);a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM?2:3}i=s}this.dirty=2},fe.prototype.markParentsDirty=function(){for(var e=1,t=this.parent;t;t=t.parent,e++){var i=1==e?2:1;t.dirty<i&&(t.dirty=i)}},Lt.domAtom.get=function(){return!1},Lt.ignoreForCoords.get=function(){return!1},Object.defineProperties(fe.prototype,Lt);var mn=[],Da=function(n){function e(i,o,a,s){var c,d=o.type.toDOM;if("function"==typeof d&&(d=d(a,function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s})),!o.type.spec.raw){if(1!=d.nodeType){var p=document.createElement("span");p.appendChild(d),d=p}d.contentEditable=!1,d.classList.add("ProseMirror-widget")}n.call(this,i,mn,d,null),this.widget=o,c=this}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={domAtom:{configurable:!0}};return e.prototype.matchesWidget=function(o){return 0==this.dirty&&o.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(o){var a=this.widget.spec.stopEvent;return!!a&&a(o)},e.prototype.ignoreMutation=function(o){return"selection"!=o.type||this.widget.spec.ignoreSelection},e.prototype.destroy=function(){this.widget.type.destroy(this.dom),n.prototype.destroy.call(this)},t.domAtom.get=function(){return!0},Object.defineProperties(e.prototype,t),e}(fe),cc=function(n){function e(i,o,a,s){n.call(this,i,mn,o,null),this.textDOM=a,this.text=s}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={size:{configurable:!0}};return t.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(o,a){return o!=this.textDOM?this.posAtStart+(a?this.size:0):this.posAtStart+a},e.prototype.domFromPos=function(o){return{node:this.textDOM,offset:o}},e.prototype.ignoreMutation=function(o){return"characterData"===o.type&&o.target.nodeValue==o.oldValue},Object.defineProperties(e.prototype,t),e}(fe),Yi=function(n){function e(t,i,o,a){n.call(this,t,[],o,a),this.mark=i}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.create=function(i,o,a,s){var c=s.nodeViews[o.type.name],d=c&&c(o,s,a);return(!d||!d.dom)&&(d=Le.renderSpec(document,o.type.spec.toDOM(o,a))),new e(i,o,d.dom,d.contentDOM||d.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(i){return 3!=this.dirty&&this.mark.eq(i)},e.prototype.markDirty=function(i,o){if(n.prototype.markDirty.call(this,i,o),0!=this.dirty){for(var a=this.parent;!a.node;)a=a.parent;a.dirty<this.dirty&&(a.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(i,o,a){var s=e.create(this.parent,this.mark,!0,a),c=this.children,d=this.size;o<d&&(c=Ur(c,o,d,a)),i>0&&(c=Ur(c,0,i,a));for(var p=0;p<c.length;p++)c[p].parent=s;return s.children=c,s},e}(fe),Mi=function(n){function e(i,o,a,s,c,d,p,f,m){n.call(this,i,o.isLeaf?mn:[],c,d),this.nodeDOM=p,this.node=o,this.outerDeco=a,this.innerDeco=s,d&&this.updateChildren(f,m)}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return e.create=function(o,a,s,c,d,p){var f,g,m=d.nodeViews[a.type.name],y=m&&m(a,d,function(){return g?g.parent?g.parent.posBeforeChild(g):void 0:p},s,c),T=y&&y.dom,E=y&&y.contentDOM;if(a.isText)if(T){if(3!=T.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else T=document.createTextNode(a.text);else T||(T=(f=Le.renderSpec(document,a.type.spec.toDOM(a))).dom,E=f.contentDOM);!E&&!a.isText&&"BR"!=T.nodeName&&(T.hasAttribute("contenteditable")||(T.contentEditable=!1),a.type.spec.draggable&&(T.draggable=!0));var F=T;return T=Ea(T,s,a),y?g=new dc(o,a,s,c,T,E,F,y,d,p+1):a.isText?new Ma(o,a,s,c,T,F,d):new e(o,a,s,c,T,E,F,d,p+1)},e.prototype.parseRule=function(){var o=this;if(this.node.type.spec.reparseInView)return null;var a={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(a.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?a.contentElement=this.contentDOM:a.getContent=function(){return o.contentDOM?w.empty:o.node.content},a},e.prototype.matchesNode=function(o,a,s){return 0==this.dirty&&o.eq(this.node)&&qr(a,this.outerDeco)&&s.eq(this.innerDeco)},t.size.get=function(){return this.node.nodeSize},t.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(o,a){var s=this,c=this.node.inlineContent,d=a,p=o.composing&&this.localCompositionInfo(o,a),f=p&&p.pos>-1?p:null,m=p&&p.pos<0,g=new Tt(this,f&&f.node);(function(n,e,t,i){var o=e.locals(n),a=0;if(0!=o.length)for(var d=0,p=[],f=null,m=0;;){if(d<o.length&&o[d].to==a){for(var g=o[d++],y=void 0;d<o.length&&o[d].to==a;)(y||(y=[g])).push(o[d++]);if(y){y.sort(hc);for(var T=0;T<y.length;T++)t(y[T],m,!!f)}else t(g,m,!!f)}var E=void 0,F=void 0;if(f)F=-1,E=f,f=null;else{if(!(m<n.childCount))break;F=m,E=n.child(m++)}for(var q=0;q<p.length;q++)p[q].to<=a&&p.splice(q--,1);for(;d<o.length&&o[d].from<=a&&o[d].to>a;)p.push(o[d++]);var N=a+E.nodeSize;if(E.isText){var ee=N;d<o.length&&o[d].from<ee&&(ee=o[d].from);for(var z=0;z<p.length;z++)p[z].to<ee&&(ee=p[z].to);ee<N&&(f=E.cut(ee-a),E=E.cut(0,ee-a),N=ee,F=-1)}i(E,p.length?E.isInline&&!E.isLeaf?p.filter(function(se){return!se.inline}):p.slice():mn,e.forChild(a,E),F),a=N}else for(var s=0;s<n.childCount;s++){var c=n.child(s);i(c,o,e.forChild(a,c),s),a+=c.nodeSize}})(this.node,this.innerDeco,function(y,T,E){y.spec.marks?g.syncToMarks(y.spec.marks,c,o):y.type.side>=0&&!E&&g.syncToMarks(T==s.node.childCount?C.none:s.node.child(T).marks,c,o),g.placeWidget(y,o,d)},function(y,T,E,F){var q;g.syncToMarks(y.marks,c,o),g.findNodeMatch(y,T,E,F)||m&&o.state.selection.from>d&&o.state.selection.to<d+y.nodeSize&&(q=g.findIndexWithChild(p.node))>-1&&g.updateNodeAt(y,T,E,q,o)||g.updateNextNode(y,T,E,o,F)||g.addNode(y,T,E,o,d),d+=y.nodeSize}),g.syncToMarks(mn,c,o),this.node.isTextblock&&g.addTextblockHacks(),g.destroyRest(),(g.changed||2==this.dirty)&&(f&&this.protectLocalComposition(o,f),ka(this.contentDOM,this.children,o),R.ios&&function(n){if("UL"==n.nodeName||"OL"==n.nodeName){var e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n),n.style.cssText=e}}(this.dom))},e.prototype.localCompositionInfo=function(o,a){var s=o.state.selection,c=s.from,d=s.to;if(!(!(o.state.selection instanceof be)||c<a||d>a+this.node.content.size)){var p=o.root.getSelection(),f=function(n,e){for(;;){if(3==n.nodeType)return n;if(1==n.nodeType&&e>0){if(n.childNodes.length>e&&3==n.childNodes[e].nodeType)return n.childNodes[e];e=Ft(n=n.childNodes[e-1])}else{if(!(1==n.nodeType&&e<n.childNodes.length))return null;n=n.childNodes[e],e=0}}}(p.focusNode,p.focusOffset);if(f&&this.dom.contains(f.parentNode)){if(this.node.inlineContent){var m=f.nodeValue,g=function(n,e,t,i){for(var o=0,a=0;o<n.childCount&&a<=i;){var s=n.child(o++),c=a;if(a+=s.nodeSize,s.isText){for(var d=s.text;o<n.childCount;){var p=n.child(o++);if(a+=p.nodeSize,!p.isText)break;d+=p.text}if(a>=t&&c<i){var f=d.lastIndexOf(e,i-c-1);if(f>=0&&f+e.length+c>=t)return c+f}}}return-1}(this.node.content,m,c-a,d-a);return g<0?null:{node:f,pos:g,text:m}}return{node:f,pos:-1}}}},e.prototype.protectLocalComposition=function(o,a){var s=a.node,c=a.pos,d=a.text;if(!this.getDesc(s)){for(var p=s;p.parentNode!=this.contentDOM;p=p.parentNode){for(;p.previousSibling;)p.parentNode.removeChild(p.previousSibling);for(;p.nextSibling;)p.parentNode.removeChild(p.nextSibling);p.pmViewDesc&&(p.pmViewDesc=null)}var f=new cc(this,p,s,d);o.compositionNodes.push(f),this.children=Ur(this.children,c,c+d.length,o,f)}},e.prototype.update=function(o,a,s,c){return!(3==this.dirty||!o.sameMarkup(this.node)||(this.updateInner(o,a,s,c),0))},e.prototype.updateInner=function(o,a,s,c){this.updateOuterDeco(a),this.node=o,this.innerDeco=s,this.contentDOM&&this.updateChildren(c,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(o){if(!qr(o,this.outerDeco)){var a=1!=this.nodeDOM.nodeType,s=this.dom;this.dom=Sa(this.dom,this.nodeDOM,Vr(this.outerDeco,this.node,a),Vr(o,this.node,a)),this.dom!=s&&(s.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=o}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")},t.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(e.prototype,t),e}(fe);function Ta(n,e,t,i,o){return Ea(i,e,n),new Mi(null,n,e,t,i,i,i,o,0)}var Ma=function(n){function e(i,o,a,s,c,d,p){n.call(this,i,o,a,s,c,null,d,p)}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={domAtom:{configurable:!0}};return e.prototype.parseRule=function(){for(var o=this.nodeDOM.parentNode;o&&o!=this.dom&&!o.pmIsDeco;)o=o.parentNode;return{skip:o||!0}},e.prototype.update=function(o,a,s,c){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!o.sameMarkup(this.node)||(this.updateOuterDeco(a),(0!=this.dirty||o.text!=this.node.text)&&o.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=o.text,c.trackWrites==this.nodeDOM&&(c.trackWrites=null)),this.node=o,this.dirty=0,0))},e.prototype.inParent=function(){for(var o=this.parent.contentDOM,a=this.nodeDOM;a;a=a.parentNode)if(a==o)return!0;return!1},e.prototype.domFromPos=function(o){return{node:this.nodeDOM,offset:o}},e.prototype.localPosFromDOM=function(o,a,s){return o==this.nodeDOM?this.posAtStart+Math.min(a,this.node.text.length):n.prototype.localPosFromDOM.call(this,o,a,s)},e.prototype.ignoreMutation=function(o){return"characterData"!=o.type&&"selection"!=o.type},e.prototype.slice=function(o,a,s){var c=this.node.cut(o,a),d=document.createTextNode(c.text);return new e(this.parent,c,this.outerDeco,this.innerDeco,d,d,s)},e.prototype.markDirty=function(o,a){n.prototype.markDirty.call(this,o,a),this.dom!=this.nodeDOM&&(0==o||a==this.nodeDOM.nodeValue.length)&&(this.dirty=3)},t.domAtom.get=function(){return!1},Object.defineProperties(e.prototype,t),e}(Mi),Aa=function(n){function e(){n.apply(this,arguments)}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(o){return 0==this.dirty&&this.dom.nodeName==o},t.domAtom.get=function(){return!0},t.ignoreForCoords.get=function(){return"IMG"==this.dom.nodeName},Object.defineProperties(e.prototype,t),e}(fe),dc=function(n){function e(t,i,o,a,s,c,d,p,f,m){n.call(this,t,i,o,a,s,c,d,f,m),this.spec=p}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.update=function(i,o,a,s){if(3==this.dirty)return!1;if(this.spec.update){var c=this.spec.update(i,o,a);return c&&this.updateInner(i,o,a,s),c}return!(!this.contentDOM&&!i.isLeaf)&&n.prototype.update.call(this,i,o,a,s)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():n.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():n.prototype.deselectNode.call(this)},e.prototype.setSelection=function(i,o,a,s){this.spec.setSelection?this.spec.setSelection(i,o,a):n.prototype.setSelection.call(this,i,o,a,s)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),n.prototype.destroy.call(this)},e.prototype.stopEvent=function(i){return!!this.spec.stopEvent&&this.spec.stopEvent(i)},e.prototype.ignoreMutation=function(i){return this.spec.ignoreMutation?this.spec.ignoreMutation(i):n.prototype.ignoreMutation.call(this,i)},e}(Mi);function ka(n,e,t){for(var i=n.firstChild,o=!1,a=0;a<e.length;a++){var s=e[a],c=s.dom;if(c.parentNode==n){for(;c!=i;)i=wa(i),o=!0;i=i.nextSibling}else o=!0,n.insertBefore(c,i);if(s instanceof Yi){var d=i?i.previousSibling:n.lastChild;ka(s.contentDOM,s.children,t),i=d?d.nextSibling:n.firstChild}}for(;i;)i=wa(i),o=!0;o&&t.trackWrites==n&&(t.trackWrites=null)}function Ai(n){n&&(this.nodeName=n)}Ai.prototype=Object.create(null);var En=[new Ai];function Vr(n,e,t){if(0==n.length)return En;for(var i=t?En[0]:new Ai,o=[i],a=0;a<n.length;a++){var s=n[a].type.attrs;if(s)for(var c in s.nodeName&&o.push(i=new Ai(s.nodeName)),s){var d=s[c];null!=d&&(t&&1==o.length&&o.push(i=new Ai(e.isInline?"span":"div")),"class"==c?i.class=(i.class?i.class+" ":"")+d:"style"==c?i.style=(i.style?i.style+";":"")+d:"nodeName"!=c&&(i[c]=d))}}return o}function Sa(n,e,t,i){if(t==En&&i==En)return e;for(var o=e,a=0;a<i.length;a++){var s=i[a],c=t[a];if(a){var d=void 0;c&&c.nodeName==s.nodeName&&o!=n&&(d=o.parentNode)&&d.tagName.toLowerCase()==s.nodeName||((d=document.createElement(s.nodeName)).pmIsDeco=!0,d.appendChild(o),c=En[0]),o=d}uc(o,c||En[0],s)}return o}function uc(n,e,t){for(var i in e)"class"!=i&&"style"!=i&&"nodeName"!=i&&!(i in t)&&n.removeAttribute(i);for(var o in t)"class"!=o&&"style"!=o&&"nodeName"!=o&&t[o]!=e[o]&&n.setAttribute(o,t[o]);if(e.class!=t.class){for(var a=e.class?e.class.split(" ").filter(Boolean):mn,s=t.class?t.class.split(" ").filter(Boolean):mn,c=0;c<a.length;c++)-1==s.indexOf(a[c])&&n.classList.remove(a[c]);for(var d=0;d<s.length;d++)-1==a.indexOf(s[d])&&n.classList.add(s[d]);0==n.classList.length&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style)for(var f,p=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;f=p.exec(e.style);)n.style.removeProperty(f[1]);t.style&&(n.style.cssText+=t.style)}}function Ea(n,e,t){return Sa(n,n,En,Vr(e,t,1!=n.nodeType))}function qr(n,e){if(n.length!=e.length)return!1;for(var t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function wa(n){var e=n.nextSibling;return n.parentNode.removeChild(n),e}var Tt=function(e,t){this.top=e,this.lock=t,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function(n,e){var t=e,i=t.children.length,o=n.childCount,a=new Map,s=[];e:for(;o>0;){for(var c=void 0;;)if(i){var d=t.children[i-1];if(!(d instanceof Yi)){c=d,i--;break}t=d,i=d.children.length}else{if(t==e)break e;i=t.parent.children.indexOf(t),t=t.parent}var p=c.node;if(p){if(p!=n.child(o-1))break;--o,a.set(c,o),s.push(c)}}return{index:o,matched:a,matches:s.reverse()}}(e.node.content,e)};function hc(n,e){return n.type.side-e.type.side}function Ur(n,e,t,i,o){for(var a=[],s=0,c=0;s<n.length;s++){var d=n[s],p=c,f=c+=d.size;p>=t||f<=e?a.push(d):(p<e&&a.push(d.slice(0,e-p,i)),o&&(a.push(o),o=null),f>t&&a.push(d.slice(t-p,d.size,i)))}return a}function Ia(n,e){var t=n.root.getSelection(),i=n.state.doc;if(!t.focusNode)return null;var o=n.docView.nearestDesc(t.focusNode),a=o&&0==o.size,s=n.docView.posFromDOM(t.focusNode,t.focusOffset);if(s<0)return null;var d,p,c=i.resolve(s);if(Fr(t)){for(d=c;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&te.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(n,e,t){for(var i=0==e,o=e==Ft(n);i||o;){if(n==t)return!0;var a=mt(n);if(!(n=n.parentNode))return!1;i=i&&0==a,o=o&&a==Ft(n)}}(t.focusNode,t.focusOffset,o.dom))){var f=o.posBefore;p=new te(s==f?c:i.resolve(f))}}else{var m=n.docView.posFromDOM(t.anchorNode,t.anchorOffset);if(m<0)return null;d=i.resolve(m)}return p||(p=Hr(n,d,c,"pointer"==e||n.state.selection.head<c.pos&&!a?1:-1)),p}function Ra(n){return n.editable?n.hasFocus():Jr(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function gn(n,e){var t=n.state.selection;if(Pa(n,t),Ra(n)){if(!e&&n.mouseDown&&n.mouseDown.allowDefault){var i=n.root.getSelection(),o=n.domObserver.currentSelection;if(i.anchorNode&&Ci(i.anchorNode,i.anchorOffset,o.anchorNode,o.anchorOffset))return n.mouseDown.delayedSelectionSync=!0,void n.domObserver.setCurSelection()}if(n.domObserver.disconnectSelection(),n.cursorWrapper)!function(n){var e=n.root.getSelection(),t=document.createRange(),i=n.cursorWrapper.dom,o="IMG"==i.nodeName;o?t.setEnd(i.parentNode,mt(i)+1):t.setEnd(i,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!o&&!n.state.selection.visible&&R.ie&&R.ie_version<=11&&(i.disabled=!0,i.disabled=!1)}(n);else{var c,d,a=t.anchor,s=t.head;Oa&&!(t instanceof be)&&(t.$from.parent.inlineContent||(c=Na(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(d=Na(n,t.to))),n.docView.setSelection(a,s,n.root,e),Oa&&(c&&Za(c),d&&Za(d)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(n){var e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.hideSelectionGuard);var t=n.root.getSelection(),i=t.anchorNode,o=t.anchorOffset;e.addEventListener("selectionchange",n.hideSelectionGuard=function(){(t.anchorNode!=i||t.anchorOffset!=o)&&(e.removeEventListener("selectionchange",n.hideSelectionGuard),setTimeout(function(){(!Ra(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}Tt.prototype.destroyBetween=function(e,t){if(e!=t){for(var i=e;i<t;i++)this.top.children[i].destroy();this.top.children.splice(e,t-e),this.changed=!0}},Tt.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},Tt.prototype.syncToMarks=function(e,t,i){for(var o=0,a=this.stack.length>>1,s=Math.min(a,e.length);o<s&&(o==a-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&!1!==e[o].type.spec.spanning;)o++;for(;o<a;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<e.length;){this.stack.push(this.top,this.index+1);for(var c=-1,d=this.index;d<Math.min(this.index+3,this.top.children.length);d++)if(this.top.children[d].matchesMark(e[a])){c=d;break}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{var p=Yi.create(this.top,e[a],t,i);this.top.children.splice(this.index,0,p),this.top=p,this.changed=!0}this.index=0,a++}},Tt.prototype.findNodeMatch=function(e,t,i,o){var s,a=-1;if(o>=this.preMatch.index&&(s=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,i))a=this.top.children.indexOf(s,this.index);else for(var c=this.index,d=Math.min(this.top.children.length,c+5);c<d;c++){var p=this.top.children[c];if(p.matchesNode(e,t,i)&&!this.preMatch.matched.has(p)){a=c;break}}return!(a<0||(this.destroyBetween(this.index,a),this.index++,0))},Tt.prototype.updateNodeAt=function(e,t,i,o,a){return!!this.top.children[o].update(e,t,i,a)&&(this.destroyBetween(this.index,o),this.index=o+1,!0)},Tt.prototype.findIndexWithChild=function(e){for(;;){var t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){var i=e.pmViewDesc;if(i)for(var o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==i)return o;return-1}e=t}},Tt.prototype.updateNextNode=function(e,t,i,o,a){for(var s=this.index;s<this.top.children.length;s++){var c=this.top.children[s];if(c instanceof Mi){var d=this.preMatch.matched.get(c);if(null!=d&&d!=a)return!1;var p=c.dom;if((!this.lock||!(p==this.lock||1==p.nodeType&&p.contains(this.lock.parentNode))||e.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==e.text&&3!=c.dirty&&qr(t,c.outerDeco))&&c.update(e,t,i,o))return this.destroyBetween(this.index,s),c.dom!=p&&(this.changed=!0),this.index++,!0;break}}return!1},Tt.prototype.addNode=function(e,t,i,o,a){this.top.children.splice(this.index++,0,Mi.create(this.top,e,t,i,o,a)),this.changed=!0},Tt.prototype.placeWidget=function(e,t,i){var o=this.index<this.top.children.length?this.top.children[this.index]:null;if(!o||!o.matchesWidget(e)||e!=o.widget&&o.widget.type.toDOM.parentNode){var a=new Da(this.top,e,t,i);this.top.children.splice(this.index++,0,a),this.changed=!0}else this.index++},Tt.prototype.addTextblockHacks=function(){for(var e=this.top.children[this.index-1];e instanceof Yi;)e=e.children[e.children.length-1];(!e||!(e instanceof Ma)||/\n$/.test(e.node.text))&&((R.safari||R.chrome)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},Tt.prototype.addHackNode=function(e){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(e))this.index++;else{var t=document.createElement(e);"IMG"==e&&(t.className="ProseMirror-separator"),"BR"==e&&(t.className="ProseMirror-trailingBreak"),this.top.children.splice(this.index++,0,new Aa(this.top,mn,t,null)),this.changed=!0}};var Oa=R.safari||R.chrome&&R.chrome_version<63;function Na(n,e){var t=n.docView.domFromPos(e,0),i=t.node,o=t.offset,a=o<i.childNodes.length?i.childNodes[o]:null,s=o?i.childNodes[o-1]:null;if(R.safari&&a&&"false"==a.contentEditable)return Yr(a);if(!(a&&"false"!=a.contentEditable||s&&"false"!=s.contentEditable)){if(a)return Yr(a);if(s)return Yr(s)}}function Yr(n){return n.contentEditable="true",R.safari&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Za(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function Pa(n,e){if(e instanceof te){var t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Fa(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Fa(n)}function Fa(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=null)}function Hr(n,e,t,i){return n.someProp("createSelectionBetween",function(o){return o(n,e,t)})||be.between(e,t,i)}function Jr(n){var e=n.root.getSelection();if(!e.anchorNode)return!1;try{return n.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function zr(n,e){var t=n.selection,i=t.$anchor,o=t.$head,a=e>0?i.max(o):i.min(o),s=a.parent.inlineContent?a.depth?n.doc.resolve(e>0?a.after():a.before()):null:a;return s&&de.findFrom(s,e)}function wn(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function La(n,e,t){var i=n.state.selection;if(!(i instanceof be)){if(i instanceof te&&i.node.isInline)return wn(n,new be(e>0?i.$to:i.$from));var p=zr(n.state,e);return!!p&&wn(n,p)}if(!i.empty||t.indexOf("s")>-1)return!1;if(n.endOfTextblock(e>0?"right":"left")){var o=zr(n.state,e);return!!(o&&o instanceof te)&&wn(n,o)}if(!(R.mac&&t.indexOf("m")>-1)){var c,a=i.$head,s=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter;if(!s||s.isText)return!1;var d=e<0?a.pos-s.nodeSize:a.pos;return!!(s.isAtom||(c=n.docView.descAt(d))&&!c.contentDOM)&&(te.isSelectable(s)?wn(n,new te(e<0?n.state.doc.resolve(a.pos-s.nodeSize):a)):!!R.webkit&&wn(n,new be(n.state.doc.resolve(e<0?d:d+s.nodeSize))))}}function Hi(n){return 3==n.nodeType?n.nodeValue.length:n.childNodes.length}function ki(n){var e=n.pmViewDesc;return e&&0==e.size&&(n.nextSibling||"BR"!=n.nodeName)}function jr(n){var e=n.root.getSelection(),t=e.focusNode,i=e.focusOffset;if(t){var o,a,s=!1;for(R.gecko&&1==t.nodeType&&i<Hi(t)&&ki(t.childNodes[i])&&(s=!0);;)if(i>0){if(1!=t.nodeType)break;var c=t.childNodes[i-1];if(ki(c))o=t,a=--i;else{if(3!=c.nodeType)break;i=(t=c).nodeValue.length}}else{if(Ba(t))break;for(var d=t.previousSibling;d&&ki(d);)o=t.parentNode,a=mt(d),d=d.previousSibling;if(d)i=Hi(t=d);else{if((t=t.parentNode)==n.dom)break;i=0}}s?Wr(n,e,t,i):o&&Wr(n,e,o,a)}}function Qr(n){var e=n.root.getSelection(),t=e.focusNode,i=e.focusOffset;if(t){for(var a,s,o=Hi(t);;)if(i<o){if(1!=t.nodeType)break;if(!ki(t.childNodes[i]))break;a=t,s=++i}else{if(Ba(t))break;for(var d=t.nextSibling;d&&ki(d);)a=d.parentNode,s=mt(d)+1,d=d.nextSibling;if(d)i=0,o=Hi(t=d);else{if((t=t.parentNode)==n.dom)break;i=o=0}}a&&Wr(n,e,a,s)}}function Ba(n){var e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Wr(n,e,t,i){if(Fr(e)){var o=document.createRange();o.setEnd(t,i),o.setStart(t,i),e.removeAllRanges(),e.addRange(o)}else e.extend&&e.extend(t,i);n.domObserver.setCurSelection();var a=n.state;setTimeout(function(){n.state==a&&gn(n)},50)}function Va(n,e,t){var i=n.state.selection;if(i instanceof be&&!i.empty||t.indexOf("s")>-1||R.mac&&t.indexOf("m")>-1)return!1;var o=i.$from,a=i.$to;if(!o.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){var s=zr(n.state,e);if(s&&s instanceof te)return wn(n,s)}if(!o.parent.inlineContent){var c=e<0?o:a,d=i instanceof Wt?de.near(c,e):de.findFrom(c,e);return!!d&&wn(n,d)}return!1}function qa(n,e){if(!(n.state.selection instanceof be))return!0;var t=n.state.selection,i=t.$head,a=t.empty;if(!i.sameParent(t.$anchor))return!0;if(!a)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;var s=!i.textOffset&&(e<0?i.nodeBefore:i.nodeAfter);if(s&&!s.isText){var c=n.state.tr;return e<0?c.delete(i.pos-s.nodeSize,i.pos):c.delete(i.pos,i.pos+s.nodeSize),n.dispatch(c),!0}return!1}function Ua(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Ac(n){var e=n.pmViewDesc;if(e)return e.parseRule();if("BR"==n.nodeName&&n.parentNode){if(R.safari&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){var t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}if(n.parentNode.lastChild==n||R.safari&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if("IMG"==n.nodeName&&n.getAttribute("mark-placeholder"))return{ignore:!0}}function Ya(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Hr(n,e.resolve(t.anchor),e.resolve(t.head))}function Gr(n,e,t){for(var i=n.depth,o=e?n.end():n.pos;i>0&&(e||n.indexAfter(i)==n.node(i).childCount);)i--,o++,e=!1;if(t)for(var a=n.node(i).maybeChild(n.indexAfter(i));a&&!a.isLeaf;)a=a.firstChild,o++;return o}function Ha(n,e){for(var t=[],i=e.content,o=e.openStart,a=e.openEnd;o>1&&a>1&&1==i.childCount&&1==i.firstChild.childCount;){o--,a--;var s=i.firstChild;t.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),i=s.content}var c=n.someProp("clipboardSerializer")||Le.fromSchema(n.state.schema),d=$a(),p=d.createElement("div");p.appendChild(c.serializeFragment(i,{document:d}));for(var m,f=p.firstChild;f&&1==f.nodeType&&(m=Ga[f.nodeName.toLowerCase()]);){for(var g=m.length-1;g>=0;g--){for(var y=d.createElement(m[g]);p.firstChild;)y.appendChild(p.firstChild);p.appendChild(y),"tbody"!=m[g]&&(o++,a++)}f=p.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",o+" "+a+" "+JSON.stringify(t)),{dom:p,text:n.someProp("clipboardTextSerializer",function(E){return E(e)})||e.content.textBetween(0,e.content.size,"\n\n")}}function Ja(n,e,t,i,o){var a,c,s=o.parent.type.spec.code;if(!t&&!e)return null;var d=e&&(i||s||!t);if(d){if(n.someProp("transformPastedText",function(G){e=G(e,s||i)}),s)return e?new h(w.from(n.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):h.empty;var p=n.someProp("clipboardTextParser",function(G){return G(e,o,i)});if(p)c=p;else{var f=o.marks(),g=n.state.schema,y=Le.fromSchema(g);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(function(G){var se=a.appendChild(document.createElement("p"));G&&se.appendChild(y.serializeNode(g.text(G,f)))})}}else n.someProp("transformPastedHTML",function(G){t=G(t)}),a=function(n){var e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));var o,t=$a().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(n);if((o=i&&Ga[i[1].toLowerCase()])&&(n=o.map(function(s){return"<"+s+">"}).join("")+n+o.map(function(s){return"</"+s+">"}).reverse().join("")),t.innerHTML=n,o)for(var a=0;a<o.length;a++)t=t.querySelector(o[a])||t;return t}(t),R.webkit&&function(n){for(var e=n.querySelectorAll(R.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),t=0;t<e.length;t++){var i=e[t];1==i.childNodes.length&&"\xa0"==i.textContent&&i.parentNode&&i.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),i)}}(a);var T=a&&a.querySelector("[data-pm-slice]"),E=T&&/^(\d+) (\d+) (.*)/.exec(T.getAttribute("data-pm-slice"));if(!c){var F=n.someProp("clipboardParser")||n.someProp("domParser")||Ct.fromSchema(n.state.schema);c=F.parseSlice(a,{preserveWhitespace:!(!d&&!E),context:o,ruleFromNode:function(se){if("BR"==se.nodeName&&!se.nextSibling&&se.parentNode&&!Ic.test(se.parentNode.nodeName))return{ignore:!0}}})}if(E)c=function(n,e){if(!n.size)return n;var i,t=n.content.firstChild.type.schema;try{i=JSON.parse(e)}catch(p){return n}for(var o=n.content,a=n.openStart,s=n.openEnd,c=i.length-2;c>=0;c-=2){var d=t.nodes[i[c]];if(!d||d.hasRequiredAttrs())break;o=w.from(d.create(i[c+1],o)),a++,s++}return new h(o,a,s)}(Wa(c,+E[1],+E[2]),E[3]);else if(c=h.maxOpen(function(n,e){if(n.childCount<2)return n;for(var t=function(a){var c=e.node(a).contentMatchAt(e.index(a)),d=void 0,p=[];if(n.forEach(function(f){if(p){var g,m=c.findWrapping(f.type);if(!m)return p=null;if(g=p.length&&d.length&&ja(m,d,f,p[p.length-1],0))p[p.length-1]=g;else{p.length&&(p[p.length-1]=Qa(p[p.length-1],d.length));var y=za(f,m);p.push(y),c=c.matchType(y.type,y.attrs),d=m}}}),p)return{v:w.from(p)}},i=e.depth;i>=0;i--){var o=t(i);if(o)return o.v}return n}(c.content,o),!0),c.openStart||c.openEnd){for(var q=0,N=0,ee=c.content.firstChild;q<c.openStart&&!ee.type.spec.isolating;q++,ee=ee.firstChild);for(var z=c.content.lastChild;N<c.openEnd&&!z.type.spec.isolating;N++,z=z.lastChild);c=Wa(c,q,N)}return n.someProp("transformPasted",function(G){c=G(c)}),c}var Ic=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function za(n,e,t){void 0===t&&(t=0);for(var i=e.length-1;i>=t;i--)n=e[i].create(null,w.from(n));return n}function ja(n,e,t,i,o){if(o<n.length&&o<e.length&&n[o]==e[o]){var a=ja(n,e,t,i.lastChild,o+1);if(a)return i.copy(i.content.replaceChild(i.childCount-1,a));if(i.contentMatchAt(i.childCount).matchType(o==n.length-1?t.type:n[o+1]))return i.copy(i.content.append(w.from(za(t,n,o+1))))}}function Qa(n,e){if(0==e)return n;var t=n.content.replaceChild(n.childCount-1,Qa(n.lastChild,e-1)),i=n.contentMatchAt(n.childCount).fillBefore(w.empty,!0);return n.copy(t.append(i))}function Kr(n,e,t,i,o,a){var s=e<0?n.firstChild:n.lastChild,c=s.content;return o<i-1&&(c=Kr(c,e,t,i,o+1,a)),o>=t&&(c=e<0?s.contentMatchAt(0).fillBefore(c,n.childCount>1||a<=o).append(c):c.append(s.contentMatchAt(s.childCount).fillBefore(w.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(c))}function Wa(n,e,t){return e<n.openStart&&(n=new h(Kr(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new h(Kr(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}var Ga={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Ka=null;function $a(){return Ka||(Ka=document.implementation.createHTMLDocument("title"))}var Pc={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},$r=R.ie&&R.ie_version<=11,Xr=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Xr.prototype.set=function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset},Xr.prototype.eq=function(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset};var gt=function(e,t){var i=this;this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver(function(o){for(var a=0;a<o.length;a++)i.queue.push(o[a]);R.ie&&R.ie_version<=11&&o.some(function(s){return"childList"==s.type&&s.removedNodes.length||"characterData"==s.type&&s.oldValue.length>s.target.nodeValue.length})?i.flushSoon():i.flush()}),this.currentSelection=new Xr,$r&&(this.onCharData=function(o){i.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),i.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};gt.prototype.flushSoon=function(){var e=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(function(){e.flushingSoon=-1,e.flush()},20))},gt.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},gt.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,Pc),$r&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},gt.prototype.stop=function(){var e=this;if(this.observer){var t=this.observer.takeRecords();if(t.length){for(var i=0;i<t.length;i++)this.queue.push(t[i]);window.setTimeout(function(){return e.flush()},20)}this.observer.disconnect()}$r&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},gt.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},gt.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},gt.prototype.suppressSelectionUpdates=function(){var e=this;this.suppressingSelectionUpdates=!0,setTimeout(function(){return e.suppressingSelectionUpdates=!1},50)},gt.prototype.onSelectionChange=function(){if((!(n=this.view).editable||n.root.activeElement==n.dom)&&Jr(n)){if(this.suppressingSelectionUpdates)return gn(this.view);if(R.ie&&R.ie_version<=11&&!this.view.state.selection.empty){var e=this.view.root.getSelection();if(e.focusNode&&Ci(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}var n},gt.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},gt.prototype.ignoreSelectionChange=function(e){if(0==e.rangeCount)return!0;var t=e.getRangeAt(0).commonAncestorContainer,i=this.view.docView.nearestDesc(t);return i&&i.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0},gt.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);var t=this.view.root.getSelection(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&Jr(this.view)&&!this.ignoreSelectionChange(t),o=-1,a=-1,s=!1,c=[];if(this.view.editable)for(var d=0;d<e.length;d++){var p=this.registerMutation(e[d],c);p&&(o=o<0?p.from:Math.min(p.from,o),a=a<0?p.to:Math.max(p.to,a),p.typeOver&&(s=!0))}if(R.gecko&&c.length>1){var f=c.filter(function(y){return"BR"==y.nodeName});if(2==f.length){var m=f[0],g=f[1];m.parentNode&&m.parentNode.parentNode==g.parentNode?g.remove():m.remove()}}(o>-1||i)&&(o>-1&&(this.view.docView.markDirty(o,a),Xa||(Xa=!0,"normal"==getComputedStyle(this.view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))),this.handleDOMChange(o,a,s,c),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(t)||gn(this.view),this.currentSelection.set(t))}},gt.prototype.registerMutation=function(e,t){if(t.indexOf(e.target)>-1)return null;var i=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(i==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!i||i.ignoreMutation(e))return null;if("childList"==e.type){for(var o=0;o<e.addedNodes.length;o++)t.push(e.addedNodes[o]);if(i.contentDOM&&i.contentDOM!=i.dom&&!i.contentDOM.contains(e.target))return{from:i.posBefore,to:i.posAfter};var a=e.previousSibling,s=e.nextSibling;if(R.ie&&R.ie_version<=11&&e.addedNodes.length)for(var c=0;c<e.addedNodes.length;c++){var d=e.addedNodes[c],p=d.previousSibling,f=d.nextSibling;(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(a=p),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f)}var m=a&&a.parentNode==e.target?mt(a)+1:0,g=i.localPosFromDOM(e.target,m,-1),y=s&&s.parentNode==e.target?mt(s):e.target.childNodes.length;return{from:g,to:i.localPosFromDOM(e.target,y,1)}}return"attributes"==e.type?{from:i.posAtStart-i.border,to:i.posAtEnd+i.border}:{from:i.posAtStart,to:i.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}};var Xa=!1,rt={},Xe={};function In(n,e){n.lastSelectionOrigin=e,n.lastSelectionTime=Date.now()}function eo(n){n.someProp("handleDOMEvents",function(e){for(var t in e)n.eventHandlers[t]||n.dom.addEventListener(t,n.eventHandlers[t]=function(i){return to(n,i)})})}function to(n,e){return n.someProp("handleDOMEvents",function(t){var i=t[e.type];return!!i&&(i(n,e)||e.defaultPrevented)})}function Ji(n){return{left:n.clientX,top:n.clientY}}function no(n,e,t,i,o){if(-1==i)return!1;for(var a=n.state.doc.resolve(i),s=function(p){if(n.someProp(e,function(f){return p>a.depth?f(n,t,a.nodeAfter,a.before(p),o,!0):f(n,t,a.node(p),a.before(p),o,!1)}))return{v:!0}},c=a.depth+1;c>0;c--){var d=s(c);if(d)return d.v}return!1}function $n(n,e,t){n.focused||n.focus();var i=n.state.tr.setSelection(e);"pointer"==t&&i.setMeta("pointer",!0),n.dispatch(i)}function zc(n,e,t,i){return no(n,"handleDoubleClickOn",e,t,i)||n.someProp("handleDoubleClick",function(o){return o(n,e,i)})}function jc(n,e,t,i){return no(n,"handleTripleClickOn",e,t,i)||n.someProp("handleTripleClick",function(o){return o(n,e,i)})||function(n,e,t){if(0!=t.button)return!1;var i=n.state.doc;if(-1==e)return!!i.inlineContent&&($n(n,be.create(i,0,i.content.size),"pointer"),!0);for(var o=i.resolve(e),a=o.depth+1;a>0;a--){var s=a>o.depth?o.nodeAfter:o.node(a),c=o.before(a);if(s.inlineContent)$n(n,be.create(i,c+1,c+1+s.content.size),"pointer");else{if(!te.isSelectable(s))continue;$n(n,te.create(i,c),"pointer")}return!0}}(n,t,i)}function io(n){return ji(n)}Xe.keydown=function(n,e){if(n.shiftKey=16==e.keyCode||e.shiftKey,!ts(n,e)&&(n.lastKeyCode=e.keyCode,n.lastKeyCodeTime=Date.now(),!R.android||!R.chrome||13!=e.keyCode))if(229!=e.keyCode&&n.domObserver.forceFlush(),!R.ios||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)n.someProp("handleKeyDown",function(i){return i(n,e)})||function(n,e){var t=e.keyCode,i=function(n){var e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}(e);return 8==t||R.mac&&72==t&&"c"==i?qa(n,-1)||jr(n):46==t||R.mac&&68==t&&"c"==i?qa(n,1)||Qr(n):13==t||27==t||(37==t?La(n,-1,i)||jr(n):39==t?La(n,1,i)||Qr(n):38==t?Va(n,-1,i)||jr(n):40==t?function(n){if(R.safari&&!(n.state.selection.$head.parentOffset>0)){var e=n.root.getSelection(),t=e.focusNode;if(t&&1==t.nodeType&&0==e.focusOffset&&t.firstChild&&"false"==t.firstChild.contentEditable){var o=t.firstChild;Ua(n,o,!0),setTimeout(function(){return Ua(n,o,!1)},20)}}}(n)||Va(n,1,i)||Qr(n):i==(R.mac?"m":"c")&&(66==t||73==t||89==t||90==t))}(n,e)?e.preventDefault():In(n,"key");else{var t=Date.now();n.lastIOSEnter=t,n.lastIOSEnterFallbackTimeout=setTimeout(function(){n.lastIOSEnter==t&&(n.someProp("handleKeyDown",function(i){return i(n,Gn(13,"Enter"))}),n.lastIOSEnter=0)},200)}},Xe.keyup=function(n,e){16==e.keyCode&&(n.shiftKey=!1)},Xe.keypress=function(n,e){if(!(ts(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||R.mac&&e.metaKey)){if(n.someProp("handleKeyPress",function(o){return o(n,e)}))return void e.preventDefault();var t=n.state.selection;if(!(t instanceof be&&t.$from.sameParent(t.$to))){var i=String.fromCharCode(e.charCode);n.someProp("handleTextInput",function(o){return o(n,t.$from.pos,t.$to.pos,i)})||n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}}};var es=R.mac?"metaKey":"ctrlKey";rt.mousedown=function(n,e){n.shiftKey=e.shiftKey;var t=io(n),i=Date.now(),o="singleClick";i-n.lastClick.time<500&&function(n,e){var t=e.x-n.clientX,i=e.y-n.clientY;return t*t+i*i<100}(e,n.lastClick)&&!e[es]&&("singleClick"==n.lastClick.type?o="doubleClick":"doubleClick"==n.lastClick.type&&(o="tripleClick")),n.lastClick={time:i,x:e.clientX,y:e.clientY,type:o};var a=n.posAtCoords(Ji(e));!a||("singleClick"==o?(n.mouseDown&&n.mouseDown.done(),n.mouseDown=new zi(n,a,e,t)):("doubleClick"==o?zc:jc)(n,a.pos,a.inside,e)?e.preventDefault():In(n,"pointer"))};var zi=function(e,t,i,o){var s,c,a=this;if(this.view=e,this.startDoc=e.state.doc,this.pos=t,this.event=i,this.flushed=o,this.selectNode=i[es],this.allowDefault=i.shiftKey,this.delayedSelectionSync=!1,t.inside>-1)s=e.state.doc.nodeAt(t.inside),c=t.inside;else{var d=e.state.doc.resolve(t.pos);s=d.parent,c=d.depth?d.before():0}this.mightDrag=null;var p=o?null:i.target,f=p?e.docView.nearestDesc(p,!0):null;this.target=f?f.dom:null;var g=e.state.selection;(0==i.button&&s.type.spec.draggable&&!1!==s.type.spec.selectable||g instanceof te&&g.from<=c&&g.to>c)&&(this.mightDrag={node:s,pos:c,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&R.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){a.view.mouseDown==a&&a.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),In(e,"pointer")};function ts(n,e){return!!n.composing||!!(R.safari&&Math.abs(e.timeStamp-n.compositionEndedAt)<500)&&(n.compositionEndedAt=-2e8,!0)}zi.prototype.done=function(){var e=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(function(){return gn(e.view)}),this.view.mouseDown=null},zi.prototype.up=function(e){if(this.done(),this.view.dom.contains(3==e.target.nodeType?e.target.parentNode:e.target)){var t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Ji(e))),this.allowDefault||!t?In(this.view,"pointer"):function(n,e,t,i,o){return no(n,"handleClickOn",e,t,i)||n.someProp("handleClick",function(a){return a(n,e,i)})||(o?function(n,e){if(-1==e)return!1;var i,o,t=n.state.selection;t instanceof te&&(i=t.node);for(var a=n.state.doc.resolve(e),s=a.depth+1;s>0;s--){var c=s>a.depth?a.nodeAfter:a.node(s);if(te.isSelectable(c)){o=i&&t.$from.depth>0&&s>=t.$from.depth&&a.before(t.$from.depth+1)==t.$from.pos?a.before(t.$from.depth):a.before(s);break}}return null!=o&&($n(n,te.create(n.state.doc,o),"pointer"),!0)}(n,t):function(n,e){if(-1==e)return!1;var t=n.state.doc.resolve(e),i=t.nodeAfter;return!!(i&&i.isAtom&&te.isSelectable(i))&&($n(n,new te(t),"pointer"),!0)}(n,t))}(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||R.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||R.chrome&&!(this.view.state.selection instanceof be)&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?($n(this.view,de.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):In(this.view,"pointer")}},zi.prototype.move=function(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),In(this.view,"pointer"),0==e.buttons&&this.done()},rt.touchdown=function(n){io(n),In(n,"pointer")},rt.contextmenu=function(n){return io(n)};var Wc=R.android?5e3:-1;function ns(n,e){clearTimeout(n.composingTimeout),e>-1&&(n.composingTimeout=setTimeout(function(){return ji(n)},e))}function is(n){for(n.composing&&(n.composing=!1,n.compositionEndedAt=function(){var n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}());n.compositionNodes.length>0;)n.compositionNodes.pop().markParentsDirty()}function ji(n,e){if(!(R.android&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),is(n),e||n.docView.dirty){var t=Ia(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}Xe.compositionstart=Xe.compositionupdate=function(n){if(!n.composing){n.domObserver.flush();var e=n.state,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(function(c){return!1===c.type.spec.inclusive})))n.markCursor=n.state.storedMarks||t.marks(),ji(n,!0),n.markCursor=null;else if(ji(n),R.gecko&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length)for(var i=n.root.getSelection(),o=i.focusNode,a=i.focusOffset;o&&1==o.nodeType&&0!=a;){var s=a<0?o.lastChild:o.childNodes[a-1];if(!s)break;if(3==s.nodeType){i.collapse(s,s.nodeValue.length);break}o=s,a=-1}n.composing=!0}ns(n,Wc)},Xe.compositionend=function(n,e){n.composing&&(n.composing=!1,n.compositionEndedAt=e.timeStamp,ns(n,20))};var Xn=R.ie&&R.ie_version<15||R.ios&&R.webkit_version<604;function ro(n,e,t,i){var o=Ja(n,e,t,n.shiftKey,n.state.selection.$from);if(n.someProp("handlePaste",function(c){return c(n,i,o||h.empty)}))return!0;if(!o)return!1;var a=function(n){return 0==n.openStart&&0==n.openEnd&&1==n.content.childCount?n.content.firstChild:null}(o),s=a?n.state.tr.replaceSelectionWith(a,n.shiftKey):n.state.tr.replaceSelection(o);return n.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}rt.copy=Xe.cut=function(n,e){var t=n.state.selection,i="cut"==e.type;if(!t.empty){var o=Xn?null:e.clipboardData,s=Ha(n,t.content()),c=s.dom,d=s.text;o?(e.preventDefault(),o.clearData(),o.setData("text/html",c.innerHTML),o.setData("text/plain",d)):function(n,e){if(n.dom.parentNode){var t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";var i=getSelection(),o=document.createRange();o.selectNodeContents(e),n.dom.blur(),i.removeAllRanges(),i.addRange(o),setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}}(n,c),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},Xe.paste=function(n,e){if(!n.composing||R.android){var t=Xn?null:e.clipboardData;t&&ro(n,t.getData("text/plain"),t.getData("text/html"),e)?e.preventDefault():function(n,e){if(n.dom.parentNode){var t=n.shiftKey||n.state.selection.$from.parent.type.spec.code,i=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(function(){n.focus(),i.parentNode&&i.parentNode.removeChild(i),t?ro(n,i.value,null,e):ro(n,i.textContent,i.innerHTML,e)},50)}}(n,e)}};var ed=function(e,t){this.slice=e,this.move=t},rs=R.mac?"altKey":"ctrlKey";for(var as in rt.dragstart=function(n,e){var t=n.mouseDown;if(t&&t.done(),e.dataTransfer){var i=n.state.selection,o=i.empty?null:n.posAtCoords(Ji(e));if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof te?i.to-1:i.to)))if(t&&t.mightDrag)n.dispatch(n.state.tr.setSelection(te.create(n.state.doc,t.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var a=n.docView.nearestDesc(e.target,!0);a&&a.node.type.spec.draggable&&a!=n.docView&&n.dispatch(n.state.tr.setSelection(te.create(n.state.doc,a.posBefore)))}var s=n.state.selection.content(),c=Ha(n,s),d=c.dom,p=c.text;e.dataTransfer.clearData(),e.dataTransfer.setData(Xn?"Text":"text/html",d.innerHTML),e.dataTransfer.effectAllowed="copyMove",Xn||e.dataTransfer.setData("text/plain",p),n.dragging=new ed(s,!e[rs])}},rt.dragend=function(n){var e=n.dragging;window.setTimeout(function(){n.dragging==e&&(n.dragging=null)},50)},Xe.dragover=Xe.dragenter=function(n,e){return e.preventDefault()},Xe.drop=function(n,e){var t=n.dragging;if(n.dragging=null,e.dataTransfer){var i=n.posAtCoords(Ji(e));if(i){var o=n.state.doc.resolve(i.pos);if(o){var a=t&&t.slice;a?n.someProp("transformPasted",function(T){a=T(a)}):a=Ja(n,e.dataTransfer.getData(Xn?"Text":"text/plain"),Xn?null:e.dataTransfer.getData("text/html"),!1,o);var s=t&&!e[rs];if(n.someProp("handleDrop",function(T){return T(n,e,a||h.empty,s)}))return void e.preventDefault();if(a){e.preventDefault();var c=a?function(n,e,t){var i=n.resolve(e);if(!t.content.size)return e;for(var o=t.content,a=0;a<t.openStart;a++)o=o.firstChild.content;for(var s=1;s<=(0==t.openStart&&t.size?2:1);s++)for(var c=i.depth;c>=0;c--){var d=c==i.depth?0:i.pos<=(i.start(c+1)+i.end(c+1))/2?-1:1,p=i.index(c)+(d>0?1:0),f=i.node(c),m=!1;if(1==s)m=f.canReplace(p,p,o);else{var g=f.contentMatchAt(p).findWrapping(o.firstChild.type);m=g&&f.canReplaceWith(p,p,g[0])}if(m)return 0==d?i.pos:d<0?i.before(c+1):i.after(c+1)}return null}(n.state.doc,o.pos,a):o.pos;null==c&&(c=o.pos);var d=n.state.tr;s&&d.deleteSelection();var p=d.mapping.map(c),f=0==a.openStart&&0==a.openEnd&&1==a.content.childCount,m=d.doc;if(f?d.replaceRangeWith(p,p,a.content.firstChild):d.replaceRange(p,p,a),!d.doc.eq(m)){var g=d.doc.resolve(p);if(f&&te.isSelectable(a.content.firstChild)&&g.nodeAfter&&g.nodeAfter.sameMarkup(a.content.firstChild))d.setSelection(new te(g));else{var y=d.mapping.map(c);d.mapping.maps[d.mapping.maps.length-1].forEach(function(T,E,F,q){return y=q}),d.setSelection(Hr(n,g,d.doc.resolve(y)))}n.focus(),n.dispatch(d.setMeta("uiEvent","drop"))}}}}}},rt.focus=function(n){n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(function(){n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.root.getSelection())&&gn(n)},20))},rt.blur=function(n,e){n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.set({}),n.focused=!1)},rt.beforeinput=function(n,e){if(R.chrome&&R.android&&"deleteContentBackward"==e.inputType){n.domObserver.flushSoon();var t=n.domChangeCount;setTimeout(function(){if(n.domChangeCount==t&&(n.dom.blur(),n.focus(),!n.someProp("handleKeyDown",function(a){return a(n,Gn(8,"Backspace"))}))){var o=n.state.selection.$cursor;o&&o.pos>0&&n.dispatch(n.state.tr.delete(o.pos-1,o.pos).scrollIntoView())}},50)}},Xe)rt[as]=Xe[as];function Si(n,e){if(n==e)return!0;for(var t in n)if(n[t]!==e[t])return!1;for(var i in e)if(!(i in n))return!1;return!0}var ei=function(e,t){this.spec=t||Rn,this.side=this.spec.side||0,this.toDOM=e};ei.prototype.map=function(e,t,i,o){var a=e.mapResult(t.from+o,this.side<0?-1:1),s=a.pos;return a.deleted?null:new we(s-i,s-i,this)},ei.prototype.valid=function(){return!0},ei.prototype.eq=function(e){return this==e||e instanceof ei&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Si(this.spec,e.spec))},ei.prototype.destroy=function(e){this.spec.destroy&&this.spec.destroy(e)};var It=function(e,t){this.spec=t||Rn,this.attrs=e};It.prototype.map=function(e,t,i,o){var a=e.map(t.from+o,this.spec.inclusiveStart?-1:1)-i,s=e.map(t.to+o,this.spec.inclusiveEnd?1:-1)-i;return a>=s?null:new we(a,s,this)},It.prototype.valid=function(e,t){return t.from<t.to},It.prototype.eq=function(e){return this==e||e instanceof It&&Si(this.attrs,e.attrs)&&Si(this.spec,e.spec)},It.is=function(e){return e.type instanceof It};var Ei=function(e,t){this.spec=t||Rn,this.attrs=e};Ei.prototype.map=function(e,t,i,o){var a=e.mapResult(t.from+o,1);if(a.deleted)return null;var s=e.mapResult(t.to+o,-1);return s.deleted||s.pos<=a.pos?null:new we(a.pos-i,s.pos-i,this)},Ei.prototype.valid=function(e,t){var s,i=e.content.findIndex(t.from),a=i.offset;return a==t.from&&!(s=e.child(i.index)).isText&&a+s.nodeSize==t.to},Ei.prototype.eq=function(e){return this==e||e instanceof Ei&&Si(this.attrs,e.attrs)&&Si(this.spec,e.spec)};var we=function(e,t,i){this.from=e,this.to=t,this.type=i},oo={spec:{configurable:!0},inline:{configurable:!0}};we.prototype.copy=function(e,t){return new we(e,t,this.type)},we.prototype.eq=function(e,t){return void 0===t&&(t=0),this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to},we.prototype.map=function(e,t,i){return this.type.map(e,this,t,i)},we.widget=function(e,t,i){return new we(e,e,new ei(t,i))},we.inline=function(e,t,i,o){return new we(e,t,new It(i,o))},we.node=function(e,t,i,o){return new we(e,t,new Ei(i,o))},oo.spec.get=function(){return this.type.spec},oo.inline.get=function(){return this.type instanceof It},Object.defineProperties(we.prototype,oo);var Qi=[],Rn={},pe=function(e,t){this.local=e&&e.length?e:Qi,this.children=t&&t.length?t:Qi};pe.create=function(e,t){return t.length?Wi(t,e,0,Rn):Ve},pe.prototype.find=function(e,t,i){var o=[];return this.findInner(null==e?0:e,null==t?1e9:t,o,0,i),o},pe.prototype.findInner=function(e,t,i,o,a){for(var s=0;s<this.local.length;s++){var c=this.local[s];c.from<=t&&c.to>=e&&(!a||a(c.spec))&&i.push(c.copy(c.from+o,c.to+o))}for(var d=0;d<this.children.length;d+=3)if(this.children[d]<t&&this.children[d+1]>e){var p=this.children[d]+1;this.children[d+2].findInner(e-p,t-p,i,o+p,a)}},pe.prototype.map=function(e,t,i){return this==Ve||0==e.maps.length?this:this.mapInner(e,t,0,0,i||Rn)},pe.prototype.mapInner=function(e,t,i,o,a){for(var s,c=0;c<this.local.length;c++){var d=this.local[c].map(e,i,o);d&&d.type.valid(t,d)?(s||(s=[])).push(d):a.onRemove&&a.onRemove(this.local[c].spec)}return this.children.length?function(n,e,t,i,o,a,s){for(var c=n.slice(),d=function(ai,Ln,Bn,ar){for(var et=0;et<c.length;et+=3){var Re=c[et+1],Mo=void 0;-1==Re||ai>Re+a||(Ln>=c[et]+a?c[et+1]=-1:Bn>=o&&(Mo=ar-Bn-(Ln-ai))&&(c[et]+=Mo,c[et+1]+=Mo))}},p=0;p<t.maps.length;p++)t.maps[p].forEach(d);for(var f=!1,m=0;m<c.length;m+=3)if(-1==c[m+1]){var g=t.map(n[m]+a),y=g-o;if(y<0||y>=i.content.size){f=!0;continue}var E=t.map(n[m+1]+a,-1)-o,F=i.content.findIndex(y),N=F.offset,ee=i.maybeChild(F.index);if(ee&&N==y&&N+ee.nodeSize==E){var z=c[m+2].mapInner(t,ee,g+1,n[m]+a+1,s);z!=Ve?(c[m]=y,c[m+1]=E,c[m+2]=z):(c[m+1]=-2,f=!0)}else f=!0}if(f){var G=function(n,e,t,i,o,a,s){function c(p,f){for(var m=0;m<p.local.length;m++){var g=p.local[m].map(i,o,f);g?t.push(g):s.onRemove&&s.onRemove(p.local[m].spec)}for(var y=0;y<p.children.length;y+=3)c(p.children[y+2],p.children[y]+f+1)}for(var d=0;d<n.length;d+=3)-1==n[d+1]&&c(n[d+2],e[d]+a+1);return t}(c,n,e||[],t,o,a,s),se=Wi(G,i,0,s);e=se.local;for(var Me=0;Me<c.length;Me+=3)c[Me+1]<0&&(c.splice(Me,3),Me-=3);for(var xe=0,ke=0;xe<se.children.length;xe+=3){for(var Ie=se.children[xe];ke<c.length&&c[ke]<Ie;)ke+=3;c.splice(ke,0,se.children[xe],se.children[xe+1],se.children[xe+2])}}return new pe(e&&e.sort(On),c)}(this.children,s,e,t,i,o,a):s?new pe(s.sort(On)):Ve},pe.prototype.add=function(e,t){return t.length?this==Ve?pe.create(e,t):this.addInner(e,t,0):this},pe.prototype.addInner=function(e,t,i){var a,o=this,s=0;e.forEach(function(p,f){var g,m=f+i;if(g=ls(t,p,m)){for(a||(a=o.children.slice());s<a.length&&a[s]<f;)s+=3;a[s]==f?a[s+2]=a[s+2].addInner(p,g,m+1):a.splice(s,0,f,f+p.nodeSize,Wi(g,p,m+1,Rn)),s+=3}});for(var c=ss(s?cs(t):t,-i),d=0;d<c.length;d++)c[d].type.valid(e,c[d])||c.splice(d--,1);return new pe(c.length?this.local.concat(c).sort(On):this.local,a||this.children)},pe.prototype.remove=function(e){return 0==e.length||this==Ve?this:this.removeInner(e,0)},pe.prototype.removeInner=function(e,t){for(var i=this.children,o=this.local,a=0;a<i.length;a+=3){for(var s=void 0,c=i[a]+t,d=i[a+1]+t,p=0,f=void 0;p<e.length;p++)(f=e[p])&&f.from>c&&f.to<d&&(e[p]=null,(s||(s=[])).push(f));if(s){i==this.children&&(i=this.children.slice());var m=i[a+2].removeInner(s,c+1);m!=Ve?i[a+2]=m:(i.splice(a,3),a-=3)}}if(o.length)for(var g=0,y=void 0;g<e.length;g++)if(y=e[g])for(var T=0;T<o.length;T++)o[T].eq(y,t)&&(o==this.local&&(o=this.local.slice()),o.splice(T--,1));return i==this.children&&o==this.local?this:o.length||i.length?new pe(o,i):Ve},pe.prototype.forChild=function(e,t){if(this==Ve)return this;if(t.isLeaf)return pe.empty;for(var i,o,a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(i=this.children[a+2]);break}for(var s=e+1,c=s+t.content.size,d=0;d<this.local.length;d++){var p=this.local[d];if(p.from<c&&p.to>s&&p.type instanceof It){var f=Math.max(s,p.from)-s,m=Math.min(c,p.to)-s;f<m&&(o||(o=[])).push(p.copy(f,m))}}if(o){var g=new pe(o.sort(On));return i?new Mt([g,i]):g}return i||Ve},pe.prototype.eq=function(e){if(this==e)return!0;if(!(e instanceof pe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(var t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(var i=0;i<this.children.length;i+=3)if(this.children[i]!=e.children[i]||this.children[i+1]!=e.children[i+1]||!this.children[i+2].eq(e.children[i+2]))return!1;return!0},pe.prototype.locals=function(e){return ao(this.localsInner(e))},pe.prototype.localsInner=function(e){if(this==Ve)return Qi;if(e.inlineContent||!this.local.some(It.is))return this.local;for(var t=[],i=0;i<this.local.length;i++)this.local[i].type instanceof It||t.push(this.local[i]);return t};var Ve=new pe;pe.empty=Ve,pe.removeOverlap=ao;var Mt=function(e){this.members=e};function ss(n,e){if(!e||!n.length)return n;for(var t=[],i=0;i<n.length;i++){var o=n[i];t.push(new we(o.from+e,o.to+e,o.type))}return t}function ls(n,e,t){if(e.isLeaf)return null;for(var i=t+e.nodeSize,o=null,a=0,s=void 0;a<n.length;a++)(s=n[a])&&s.from>t&&s.to<i&&((o||(o=[])).push(s),n[a]=null);return o}function cs(n){for(var e=[],t=0;t<n.length;t++)null!=n[t]&&e.push(n[t]);return e}function Wi(n,e,t,i){var o=[],a=!1;e.forEach(function(d,p){var f=ls(n,d,p+t);if(f){a=!0;var m=Wi(f,d,t+p+1,i);m!=Ve&&o.push(p,p+d.nodeSize,m)}});for(var s=ss(a?cs(n):n,-t).sort(On),c=0;c<s.length;c++)s[c].type.valid(e,s[c])||(i.onRemove&&i.onRemove(s[c].spec),s.splice(c--,1));return s.length||o.length?new pe(s,o):Ve}function On(n,e){return n.from-e.from||n.to-e.to}function ao(n){for(var e=n,t=0;t<e.length-1;t++){var i=e[t];if(i.from!=i.to)for(var o=t+1;o<e.length;o++){var a=e[o];if(a.from!=i.from){a.from<i.to&&(e==n&&(e=n.slice()),e[t]=i.copy(i.from,a.from),ds(e,o,i.copy(a.from,i.to)));break}a.to!=i.to&&(e==n&&(e=n.slice()),e[o]=a.copy(a.from,i.to),ds(e,o+1,a.copy(i.to,a.to)))}}return e}function ds(n,e,t){for(;e<n.length&&On(t,n[e])>0;)e++;n.splice(e,0,t)}function so(n){var e=[];return n.someProp("decorations",function(t){var i=t(n.state);i&&i!=Ve&&e.push(i)}),n.cursorWrapper&&e.push(pe.create(n.state.doc,[n.cursorWrapper.deco])),Mt.from(e)}Mt.prototype.map=function(e,t){var i=this.members.map(function(o){return o.map(e,t,Rn)});return Mt.from(i)},Mt.prototype.forChild=function(e,t){if(t.isLeaf)return pe.empty;for(var i=[],o=0;o<this.members.length;o++){var a=this.members[o].forChild(e,t);a!=Ve&&(a instanceof Mt?i=i.concat(a.members):i.push(a))}return Mt.from(i)},Mt.prototype.eq=function(e){if(!(e instanceof Mt)||e.members.length!=this.members.length)return!1;for(var t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0},Mt.prototype.locals=function(e){for(var t,i=!0,o=0;o<this.members.length;o++){var a=this.members[o].localsInner(e);if(a.length)if(t){i&&(t=t.slice(),i=!1);for(var s=0;s<a.length;s++)t.push(a[s])}else t=a}return t?ao(i?t:t.sort(On)):Qi},Mt.from=function(e){switch(e.length){case 0:return Ve;case 1:return e[0];default:return new Mt(e)}};var Te=function(e,t){this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(ms),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):e.apply?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=hs(this),this.markCursor=null,this.cursorWrapper=null,ps(this),this.nodeViews=fs(this),this.docView=Ta(this.state.doc,us(this),so(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(n){n.shiftKey=!1,n.mouseDown=null,n.lastKeyCode=null,n.lastKeyCodeTime=0,n.lastClick={time:0,x:0,y:0,type:""},n.lastSelectionOrigin=null,n.lastSelectionTime=0,n.lastIOSEnter=0,n.lastIOSEnterFallbackTimeout=null,n.lastAndroidDelete=0,n.composing=!1,n.composingTimeout=null,n.compositionNodes=[],n.compositionEndedAt=-2e8,n.domObserver=new gt(n,function(i,o,a,s){return function(n,e,t,i,o){if(e<0){var a=n.lastSelectionTime>Date.now()-50?n.lastSelectionOrigin:null,s=Ia(n,a);if(s&&!n.state.selection.eq(s)){var c=n.state.tr.setSelection(s);"pointer"==a?c.setMeta("pointer",!0):"key"==a&&c.scrollIntoView(),n.dispatch(c)}}else{var d=n.state.doc.resolve(e),p=d.sharedDepth(t);e=d.before(p+1),t=n.state.doc.resolve(t).after(p+1);var f=n.state.selection,m=function(n,e,t){var i=n.docView.parseRange(e,t),o=i.node,a=i.fromOffset,s=i.toOffset,c=i.from,d=i.to,p=n.root.getSelection(),f=null,m=p.anchorNode;if(m&&n.dom.contains(1==m.nodeType?m:m.parentNode)&&(f=[{node:m,offset:p.anchorOffset}],Fr(p)||f.push({node:p.focusNode,offset:p.focusOffset})),R.chrome&&8===n.lastKeyCode)for(var g=s;g>a;g--){var y=o.childNodes[g-1],T=y.pmViewDesc;if("BR"==y.nodeName&&!T){s=g;break}if(!T||T.size)break}var E=n.state.doc,F=n.someProp("domParser")||Ct.fromSchema(n.state.schema),q=E.resolve(c),N=null,ee=F.parse(o,{topNode:q.parent,topMatch:q.parent.contentMatchAt(q.index()),topOpen:!0,from:a,to:s,preserveWhitespace:!q.parent.type.spec.code||"full",editableContent:!0,findPositions:f,ruleFromNode:Ac,context:q});if(f&&null!=f[0].pos){var z=f[0].pos,G=f[1]&&f[1].pos;null==G&&(G=z),N={anchor:z+c,head:G+c}}return{doc:ee,sel:N,from:c,to:d}}(n,e,t);if(R.chrome&&n.cursorWrapper&&m.sel&&m.sel.anchor==n.cursorWrapper.deco.from){var g=n.cursorWrapper.deco.type.toDOM.nextSibling,y=g&&g.nodeValue?g.nodeValue.length:1;m.sel={anchor:m.sel.anchor+y,head:m.sel.anchor+y}}var F,q,T=n.state.doc,E=T.slice(m.from,m.to);8===n.lastKeyCode&&Date.now()-100<n.lastKeyCodeTime?(F=n.state.selection.to,q="end"):(F=n.state.selection.from,q="start"),n.lastKeyCode=null;var N=function(n,e,t,i,o){var a=n.findDiffStart(e,t);if(null==a)return null;var s=n.findDiffEnd(e,t+n.size,t+e.size),c=s.a,d=s.b;return"end"==o&&(i-=c+Math.max(0,a-Math.min(c,d))-a),c<a&&n.size<e.size?(d=(a-=i<=a&&i>=c?a-i:0)+(d-c),c=a):d<a&&(c=(a-=i<=a&&i>=d?a-i:0)+(c-d),d=a),{start:a,endA:c,endB:d}}(E.content,m.doc.content,m.from,F,q);if(!N){if(!(i&&f instanceof be&&!f.empty&&f.$head.sameParent(f.$anchor))||n.composing||m.sel&&m.sel.anchor!=m.sel.head){if((R.ios&&n.lastIOSEnter>Date.now()-225||R.android)&&o.some(function(Re){return"DIV"==Re.nodeName||"P"==Re.nodeName})&&n.someProp("handleKeyDown",function(Re){return Re(n,Gn(13,"Enter"))}))return void(n.lastIOSEnter=0);if(m.sel){var ee=Ya(n,n.state.doc,m.sel);ee&&!ee.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(ee))}return}N={start:f.from,endA:f.to,endB:f.to}}n.domChangeCount++,n.state.selection.from<n.state.selection.to&&N.start==N.endB&&n.state.selection instanceof be&&(N.start>n.state.selection.from&&N.start<=n.state.selection.from+2?N.start=n.state.selection.from:N.endA<n.state.selection.to&&N.endA>=n.state.selection.to-2&&(N.endB+=n.state.selection.to-N.endA,N.endA=n.state.selection.to)),R.ie&&R.ie_version<=11&&N.endB==N.start+1&&N.endA==N.start&&N.start>m.from&&" \xa0"==m.doc.textBetween(N.start-m.from-1,N.start-m.from+1)&&(N.start--,N.endA--,N.endB--);var Me,z=m.doc.resolveNoCache(N.start-m.from),G=m.doc.resolveNoCache(N.endB-m.from),se=z.sameParent(G)&&z.parent.inlineContent;if((R.ios&&n.lastIOSEnter>Date.now()-225&&(!se||o.some(function(Re){return"DIV"==Re.nodeName||"P"==Re.nodeName}))||!se&&z.pos<m.doc.content.size&&(Me=de.findFrom(m.doc.resolve(z.pos+1),1,!0))&&Me.head==G.pos)&&n.someProp("handleKeyDown",function(Re){return Re(n,Gn(13,"Enter"))}))n.lastIOSEnter=0;else if(n.state.selection.anchor>N.start&&function(n,e,t,i,o){if(!i.parent.isTextblock||t-e<=o.pos-i.pos||Gr(i,!0,!1)<o.pos)return!1;var a=n.resolve(e);if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;var s=n.resolve(Gr(a,!0,!0));return!(!s.parent.isTextblock||s.pos>t||Gr(s,!0,!1)<t)&&i.parent.content.cut(i.parentOffset).eq(s.parent.content)}(T,N.start,N.endA,z,G)&&n.someProp("handleKeyDown",function(Re){return Re(n,Gn(8,"Backspace"))}))R.android&&R.chrome&&n.domObserver.suppressSelectionUpdates();else{R.chrome&&R.android&&N.toB==N.from&&(n.lastAndroidDelete=Date.now()),R.android&&!se&&z.start()!=G.start()&&0==G.parentOffset&&z.depth==G.depth&&m.sel&&m.sel.anchor==m.sel.head&&m.sel.head==N.endA&&(N.endB-=2,G=m.doc.resolveNoCache(N.endB-m.from),setTimeout(function(){n.someProp("handleKeyDown",function(Re){return Re(n,Gn(13,"Enter"))})},20));var Ie,ai,Ln,Bn,xe=N.start,ke=N.endA;if(se)if(z.pos==G.pos)R.ie&&R.ie_version<=11&&0==z.parentOffset&&(n.domObserver.suppressSelectionUpdates(),setTimeout(function(){return gn(n)},20)),Ie=n.state.tr.delete(xe,ke),ai=T.resolve(N.start).marksAcross(T.resolve(N.endA));else if(N.endA==N.endB&&(Bn=T.resolve(N.start))&&(Ln=function(n,e){for(var s,c,d,t=n.firstChild.marks,i=e.firstChild.marks,o=t,a=i,p=0;p<i.length;p++)o=i[p].removeFromSet(o);for(var f=0;f<t.length;f++)a=t[f].removeFromSet(a);if(1==o.length&&0==a.length)c=o[0],s="add",d=function(y){return y.mark(c.addToSet(y.marks))};else{if(0!=o.length||1!=a.length)return null;c=a[0],s="remove",d=function(y){return y.mark(c.removeFromSet(y.marks))}}for(var m=[],g=0;g<e.childCount;g++)m.push(d(e.child(g)));if(w.from(m).eq(n))return{mark:c,type:s}}(z.parent.content.cut(z.parentOffset,G.parentOffset),Bn.parent.content.cut(Bn.parentOffset,N.endA-Bn.start()))))Ie=n.state.tr,"add"==Ln.type?Ie.addMark(xe,ke,Ln.mark):Ie.removeMark(xe,ke,Ln.mark);else if(z.parent.child(z.index()).isText&&z.index()==G.index()-(G.textOffset?0:1)){var ar=z.parent.textBetween(z.parentOffset,G.parentOffset);if(n.someProp("handleTextInput",function(Re){return Re(n,xe,ke,ar)}))return;Ie=n.state.tr.insertText(ar,xe,ke)}if(Ie||(Ie=n.state.tr.replace(xe,ke,m.doc.slice(N.start-m.from,N.endB-m.from))),m.sel){var et=Ya(n,Ie.doc,m.sel);et&&!(R.chrome&&R.android&&n.composing&&et.empty&&(N.start!=N.endB||n.lastAndroidDelete<Date.now()-100)&&(et.head==xe||et.head==Ie.mapping.map(ke)-1)||R.ie&&et.empty&&et.head==xe)&&Ie.setSelection(et)}ai&&Ie.ensureMarks(ai),n.dispatch(Ie.scrollIntoView())}}}(n,i,o,a,s)}),n.domObserver.start(),n.domChangeCount=0,n.eventHandlers=Object.create(null);var e=function(i){var o=rt[i];n.dom.addEventListener(i,n.eventHandlers[i]=function(a){(function(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var t=e.target;t!=n.dom;t=t.parentNode)if(!t||11==t.nodeType||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0})(n,a)&&!to(n,a)&&(n.editable||!(a.type in Xe))&&o(n,a)})};for(var t in rt)e(t);R.safari&&n.dom.addEventListener("input",function(){return null}),eo(n)}(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},Gi={props:{configurable:!0},root:{configurable:!0},isDestroyed:{configurable:!0}};function us(n){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),e.translate="no",n.someProp("attributes",function(t){if("function"==typeof t&&(t=t(n.state)),t)for(var i in t)"class"==i&&(e.class+=" "+t[i]),"style"==i?e.style=(e.style?e.style+";":"")+t[i]:!e[i]&&"contenteditable"!=i&&"nodeName"!=i&&(e[i]=String(t[i]))}),[we.node(0,n.state.doc.content.size,e)]}function ps(n){if(n.markCursor){var e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),n.cursorWrapper={dom:e,deco:we.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function hs(n){return!n.someProp("editable",function(e){return!1===e(n.state)})}function fs(n){var e={};return n.someProp("nodeViews",function(t){for(var i in t)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=t[i])}),e}function ms(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}Gi.props.get=function(){if(this._props.state!=this.state){var n=this._props;for(var e in this._props={},n)this._props[e]=n[e];this._props.state=this.state}return this._props},Te.prototype.update=function(e){e.handleDOMEvents!=this._props.handleDOMEvents&&eo(this),this._props=e,e.plugins&&(e.plugins.forEach(ms),this.directPlugins=e.plugins),this.updateStateInner(e.state,!0)},Te.prototype.setProps=function(e){var t={};for(var i in this._props)t[i]=this._props[i];for(var o in t.state=this.state,e)t[o]=e[o];this.update(t)},Te.prototype.updateState=function(e){this.updateStateInner(e,this.state.plugins!=e.plugins)},Te.prototype.updateStateInner=function(e,t){var i=this,o=this.state,a=!1,s=!1;if(e.storedMarks&&this.composing&&(is(this),s=!0),this.state=e,t){var c=fs(this);(function(n,e){var t=0,i=0;for(var o in n){if(n[o]!=e[o])return!0;t++}for(var a in e)i++;return t!=i})(c,this.nodeViews)&&(this.nodeViews=c,a=!0),eo(this)}this.editable=hs(this),ps(this);var d=so(this),p=us(this),f=t?"reset":e.scrollToSelection>o.scrollToSelection?"to selection":"preserve",m=a||!this.docView.matchesNode(e.doc,p,d);(m||!e.selection.eq(o.selection))&&(s=!0);var g="preserve"==f&&s&&null==this.dom.style.overflowAnchor&&function(n){for(var i,o,e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),a=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){var c=n.root.elementFromPoint(a,s);if(c!=n.dom&&n.dom.contains(c)){var d=c.getBoundingClientRect();if(d.top>=t-20){i=c,o=d.top;break}}}return{refDOM:i,refTop:o,stack:ha(n.dom)}}(this);if(s){this.domObserver.stop();var y=m&&(R.ie||R.chrome)&&!this.composing&&!o.selection.empty&&!e.selection.empty&&function(n,e){var t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}(o.selection,e.selection);if(m){var T=R.chrome?this.trackWrites=this.root.getSelection().focusNode:null;(a||!this.docView.update(e.doc,p,d,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Ta(e.doc,p,d,this.dom,this)),T&&!this.trackWrites&&(y=!0)}y||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&function(n){var e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.root.getSelection();return Ci(e.node,e.offset,t.anchorNode,t.anchorOffset)}(this))?gn(this,y):(Pa(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(o),"reset"==f)this.dom.scrollTop=0;else if("to selection"==f){var E=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",function(F){return F(i)})||function(n,e,t){for(var i=n.someProp("scrollThreshold")||0,o=n.someProp("scrollMargin")||5,a=n.dom.ownerDocument,s=t||n.dom;s;s=Pr(s))if(1==s.nodeType){var c=s==a.body||1!=s.nodeType,d=c?Ql(a):Wl(s),p=0,f=0;if(e.top<d.top+pn(i,"top")?f=-(d.top-e.top+pn(o,"top")):e.bottom>d.bottom-pn(i,"bottom")&&(f=e.bottom-d.bottom+pn(o,"bottom")),e.left<d.left+pn(i,"left")?p=-(d.left-e.left+pn(o,"left")):e.right>d.right-pn(i,"right")&&(p=e.right-d.right+pn(o,"right")),p||f)if(c)a.defaultView.scrollBy(p,f);else{var m=s.scrollLeft,g=s.scrollTop;f&&(s.scrollTop+=f),p&&(s.scrollLeft+=p);var y=s.scrollLeft-m,T=s.scrollTop-g;e={left:e.left-y,top:e.top-T,right:e.right-y,bottom:e.bottom-T}}if(c)break}}(this,e.selection instanceof te?this.docView.domAfterPos(e.selection.from).getBoundingClientRect():this.coordsAtPos(e.selection.head,1),E)}else g&&function(n){var e=n.refDOM,t=n.refTop,i=n.stack,o=e?e.getBoundingClientRect().top:0;fa(i,0==o?0:o-t)}(g)},Te.prototype.destroyPluginViews=function(){for(var e;e=this.pluginViews.pop();)e.destroy&&e.destroy()},Te.prototype.updatePluginViews=function(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var s=0;s<this.pluginViews.length;s++){var c=this.pluginViews[s];c.update&&c.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var t=0;t<this.directPlugins.length;t++){var i=this.directPlugins[t];i.spec.view&&this.pluginViews.push(i.spec.view(this))}for(var o=0;o<this.state.plugins.length;o++){var a=this.state.plugins[o];a.spec.view&&this.pluginViews.push(a.spec.view(this))}}},Te.prototype.someProp=function(e,t){var o,i=this._props&&this._props[e];if(null!=i&&(o=t?t(i):i))return o;for(var a=0;a<this.directPlugins.length;a++){var s=this.directPlugins[a].props[e];if(null!=s&&(o=t?t(s):s))return o}var c=this.state.plugins;if(c)for(var d=0;d<c.length;d++){var p=c[d].props[e];if(null!=p&&(o=t?t(p):p))return o}},Te.prototype.hasFocus=function(){return this.root.activeElement==this.dom},Te.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(n){if(n.setActive)return n.setActive();if(Kn)return n.focus(Kn);var e=ha(n);n.focus(null==Kn?{get preventScroll(){return Kn={preventScroll:!0},!0}}:void 0),Kn||(Kn=!1,fa(e,0))}(this.dom),gn(this),this.domObserver.start()},Gi.root.get=function(){var n=this._root;if(null==n)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return n||document},Te.prototype.posAtCoords=function(e){return ic(this,e)},Te.prototype.coordsAtPos=function(e,t){return void 0===t&&(t=1),_a(this,e,t)},Te.prototype.domAtPos=function(e,t){return void 0===t&&(t=0),this.docView.domFromPos(e,t)},Te.prototype.nodeDOM=function(e){var t=this.docView.descAt(e);return t?t.nodeDOM:null},Te.prototype.posAtDOM=function(e,t,i){void 0===i&&(i=-1);var o=this.docView.posFromDOM(e,t,i);if(null==o)throw new RangeError("DOM position not inside the editor");return o},Te.prototype.endOfTextblock=function(e,t){return function(n,e,t){return ba==e&&ya==t?xa:(ba=e,ya=t,xa="up"==t||"down"==t?function(n,e,t){var i=e.selection,o="up"==t?i.$from:i.$to;return va(n,e,function(){for(var s=n.docView.domFromPos(o.pos,"up"==t?-1:1).node;;){var c=n.docView.nearestDesc(s,!0);if(!c)break;if(c.node.isBlock){s=c.dom;break}s=c.dom.parentNode}for(var d=_a(n,o.pos,1),p=s.firstChild;p;p=p.nextSibling){var f=void 0;if(1==p.nodeType)f=p.getClientRects();else{if(3!=p.nodeType)continue;f=Gt(p,0,p.nodeValue.length).getClientRects()}for(var m=0;m<f.length;m++){var g=f[m];if(g.bottom>g.top+1&&("up"==t?d.top-g.top>2*(g.bottom-d.top):g.bottom-d.bottom>2*(d.bottom-g.top)))return!1}}return!0})}(n,e,t):function(n,e,t){var o=e.selection.$head;if(!o.parent.isTextblock)return!1;var a=o.parentOffset,s=!a,c=a==o.parent.content.size,d=n.root.getSelection();return ac.test(o.parent.textContent)&&d.modify?va(n,e,function(){var p=d.getRangeAt(0),f=d.focusNode,m=d.focusOffset,g=d.caretBidiLevel;d.modify("move",t,"character");var T=!(o.depth?n.docView.domAfterPos(o.before()):n.dom).contains(1==d.focusNode.nodeType?d.focusNode:d.focusNode.parentNode)||f==d.focusNode&&m==d.focusOffset;return d.removeAllRanges(),d.addRange(p),null!=g&&(d.caretBidiLevel=g),T}):"left"==t||"backward"==t?s:c}(n,e,t))}(this,t||this.state,e)},Te.prototype.destroy=function(){!this.docView||(function(n){for(var e in n.domObserver.stop(),n.eventHandlers)n.dom.removeEventListener(e,n.eventHandlers[e]);clearTimeout(n.composingTimeout),clearTimeout(n.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],so(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},Gi.isDestroyed.get=function(){return null==this.docView},Te.prototype.dispatchEvent=function(e){return function(n,e){!to(n,e)&&rt[e.type]&&(n.editable||!(e.type in Xe))&&rt[e.type](n,e)}(this,e)},Te.prototype.dispatch=function(e){var t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))},Object.defineProperties(Te.prototype,Gi);var od=["ol",0],ad=["ul",0],sd=["li",0],gs={attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:function(e){return{order:e.hasAttribute("start")?+e.getAttribute("start"):1}}}],toDOM:function(e){return 1==e.attrs.order?od:["ol",{start:e.attrs.order},0]}},_s={parseDOM:[{tag:"ul"}],toDOM:function(){return ad}};function dd(n){return function(e,t){var i=e.selection,o=i.$from,a=i.$to,s=i.node;if(s&&s.isBlock||o.depth<2||!o.sameParent(a))return!1;var c=o.node(-1);if(c.type!=n)return!1;if(0==o.parent.content.size&&o.node(-1).childCount==o.indexAfter(-1)){if(2==o.depth||o.node(-3).type!=n||o.index(-2)!=o.node(-2).childCount-1)return!1;if(t){for(var d=w.empty,p=o.index(-1)?1:o.index(-2)?2:3,f=o.depth-p;f>=o.depth-3;f--)d=w.from(o.node(f).copy(d));var m=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;d=d.append(w.from(n.createAndFill()));var g=o.before(o.depth-(p-1)),y=e.tr.replace(g,o.after(-m),new h(d,4-p,0)),T=-1;y.doc.nodesBetween(g,y.doc.content.size,function(N,ee){if(T>-1)return!1;N.isTextblock&&0==N.content.size&&(T=ee+1)}),T>-1&&y.setSelection(e.selection.constructor.near(y.doc.resolve(T))),t(y.scrollIntoView())}return!0}var E=a.pos==o.end()?c.contentMatchAt(0).defaultType:null,F=e.tr.delete(o.pos,a.pos),q=E&&[null,{type:E}];return!!Qn(F.doc,o.pos,2,q)&&(t&&t(F.split(o.pos,2,q).scrollIntoView()),!0)}}function bs(n){return function(e,t){var i=e.selection,o=i.$from,s=o.blockRange(i.$to,function(c){return c.childCount&&c.firstChild.type==n});return!!s&&(!t||(o.node(s.depth-1).type==n?function(n,e,t,i){var o=n.tr,a=i.end,s=i.$to.end(i.depth);return a<s&&(o.step(new ft(a-1,s,a,s,new h(w.from(t.create(null,i.parent.copy())),1,0),1,!0)),i=new pi(o.doc.resolve(i.$from.pos),o.doc.resolve(s),i.depth)),e(o.lift(i,mi(i)).scrollIntoView()),!0}(e,t,n,s):function(n,e,t){for(var i=n.tr,o=t.parent,a=t.end,s=t.endIndex-1,c=t.startIndex;s>c;s--)a-=o.child(s).nodeSize,i.delete(a-1,a+1);var d=i.doc.resolve(t.start),p=d.nodeAfter;if(i.mapping.map(t.end)!=t.start+d.nodeAfter.nodeSize)return!1;var f=0==t.startIndex,m=t.endIndex==o.childCount,g=d.node(-1),y=d.index(-1);if(!g.canReplace(y+(f?0:1),y+1,p.content.append(m?w.empty:w.from(o))))return!1;var T=d.pos,E=T+p.nodeSize;return i.step(new ft(T-(f?1:0),E+(m?1:0),T+1,E-1,new h((f?w.empty:w.from(o.copy(w.empty))).append(m?w.empty:w.from(o.copy(w.empty))),f?0:1,m?0:1),f?0:1)),e(i.scrollIntoView()),!0}(e,t,s)))}}function ys(n){return function(e,t){var i=e.selection,s=i.$from.blockRange(i.$to,function(E){return E.childCount&&E.firstChild.type==n});if(!s)return!1;var c=s.startIndex;if(0==c)return!1;var d=s.parent,p=d.child(c-1);if(p.type!=n)return!1;if(t){var f=p.lastChild&&p.lastChild.type==d.type,m=w.from(f?n.create():null),g=new h(w.from(n.create(null,w.from(d.type.create(null,m)))),f?3:1,0),y=s.start,T=s.end;t(e.tr.step(new ft(y-(f?3:1),T,y,T,g,1,!0)).scrollIntoView())}return!0}}const xs=n=>{const e=(n=>{const e={};return Object.keys(n).forEach(t=>{n[t]&&(e[t]=n[t])}),e})(n);return Object.entries(e).map(([t,i])=>`${(n=>n.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()))(t)}:${i}`).join(";")},Ki=new Sn({marks:{link:{attrs:{href:{},title:{default:null},target:{default:"_blank"}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:n=>({href:n.getAttribute("href"),title:n.getAttribute("title"),target:n.getAttribute("target")})}],toDOM(n){const{href:e,title:t,target:i}=n.attrs;return["a",{href:e,title:t,target:i},0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>["em",0]},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:n=>"normal"!==n.style.fontWeight&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}],toDOM:()=>["strong",0]},code:{parseDOM:[{tag:"code"}],toDOM:()=>["code",0]},u:{parseDOM:[{tag:"u"},{style:"text-decoration=underline"}],toDOM:()=>["u",0]},s:{parseDOM:[{tag:"s"},{tag:"strike"},{style:"text-decoration=line-through"}],toDOM:()=>["s",0]},text_color:{attrs:{color:{default:null}},parseDOM:[{style:"color",getAttrs:n=>({color:n})}],toDOM(n){const{color:e}=n.attrs;return["span",{style:`color:${e};`},0]}},text_background_color:{attrs:{backgroundColor:{default:null}},parseDOM:[{style:"background-color",getAttrs:n=>({backgroundColor:n})}],toDOM(n){const{backgroundColor:e}=n.attrs;return["span",{style:`background-color:${e};`},0]}}},nodes:{doc:{content:"block+"},text:{group:"inline"},paragraph:{content:"inline*",group:"block",attrs:{align:{default:null}},parseDOM:[{tag:"p",getAttrs(n){const{textAlign:e}=n.style;return{align:n.getAttribute("align")||e||null}}}],toDOM(n){const{align:e}=n.attrs;return["p",{style:xs({textAlign:"left"!==e?e:null})||null},0]}},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]},heading:{attrs:{level:{default:1},align:{default:null}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",getAttrs(n){const{textAlign:e}=n.style;return{level:1,align:n.getAttribute("align")||e||null}}},{tag:"h2",getAttrs(n){const{textAlign:e}=n.style;return{level:2,align:n.getAttribute("align")||e||null}}},{tag:"h3",getAttrs(n){const{textAlign:e}=n.style;return{level:3,align:n.getAttribute("align")||e||null}}},{tag:"h4",getAttrs(n){const{textAlign:e}=n.style;return{level:4,align:n.getAttribute("align")||e||null}}},{tag:"h5",getAttrs(n){const{textAlign:e}=n.style;return{level:5,align:n.getAttribute("align")||e||null}}},{tag:"h6",getAttrs(n){const{textAlign:e}=n.style;return{level:6,align:n.getAttribute("align")||e||null}}}],toDOM(n){const{level:e,align:t}=n.attrs;return["h"+e,{style:xs({textAlign:"left"!==t?t:null})||null},0]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:()=>["pre",["code",0]]},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null},width:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:n=>({src:n.getAttribute("src"),title:n.getAttribute("title"),alt:n.getAttribute("alt"),width:n.getAttribute("width")})}],toDOM(n){const{src:e,alt:t,title:i,width:o}=n.attrs;return["img",{src:e,alt:t,title:i,width:o}]}},list_item:Object.assign(Object.assign({},{parseDOM:[{tag:"li"}],toDOM:function(){return sd},defining:!0}),{content:"paragraph block*"}),ordered_list:Object.assign(Object.assign({},gs),{content:"list_item+",group:"block"}),bullet_list:Object.assign(Object.assign({},_s),{content:"list_item+",group:"block"})}});var wd=D(2313),co=D(8929);function Ts(n,e){return!n.selection.empty&&(e&&e(n.tr.deleteSelection().scrollIntoView()),!0)}function ti(n,e,t){for(;n;n="start"==e?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&1!=n.childCount)return!1}return!1}function Ms(n){if(!n.parent.type.spec.isolating)for(var e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function As(n){if(!n.parent.type.spec.isolating)for(var e=n.depth-1;e>=0;e--){var t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}function ks(n,e){var t=n.selection,i=t.$head;return!(!i.parent.type.spec.code||!i.sameParent(t.$anchor)||(e&&e(n.tr.insertText("\n").scrollIntoView()),0))}function uo(n){for(var e=0;e<n.edgeCount;e++){var i=n.edge(e).type;if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}function Ss(n,e){var t=n.selection,i=t.$head;if(!i.parent.type.spec.code||!i.sameParent(t.$anchor))return!1;var a=i.node(-1),s=i.indexAfter(-1),c=uo(a.contentMatchAt(s));if(!a.canReplaceWith(s,s,c))return!1;if(e){var d=i.after(),p=n.tr.replaceWith(d,d,c.createAndFill());p.setSelection(de.near(p.doc.resolve(d),1)),e(p.scrollIntoView())}return!0}function Es(n,e){var t=n.selection,i=t.$from,o=t.$to;if(t instanceof Wt||i.parent.inlineContent||o.parent.inlineContent)return!1;var a=uo(o.parent.contentMatchAt(o.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){var s=(!i.parentOffset&&o.index()<o.parent.childCount?i:o).pos,c=n.tr.insert(s,a.createAndFill());c.setSelection(be.create(c.doc,s+1)),e(c.scrollIntoView())}return!0}function ws(n,e){var i=n.selection.$cursor;if(!i||i.parent.content.size)return!1;if(i.depth>1&&i.after()!=i.end(-1)){var o=i.before();if(Qn(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}var a=i.blockRange(),s=a&&mi(a);return null!=s&&(e&&e(n.tr.lift(a,s).scrollIntoView()),!0)}function po(n,e){var t=n.selection,i=t.$from,o=t.$to;if(n.selection instanceof te&&n.selection.node.isBlock)return!(!i.parentOffset||!Qn(n.doc,i.pos)||(e&&e(n.tr.split(i.pos).scrollIntoView()),0));if(!i.parent.isBlock)return!1;if(e){var a=o.parentOffset==o.parent.content.size,s=n.tr;(n.selection instanceof be||n.selection instanceof Wt)&&s.deleteSelection();var c=0==i.depth?null:uo(i.node(-1).contentMatchAt(i.indexAfter(-1))),d=a&&c?[{type:c}]:null,p=Qn(s.doc,s.mapping.map(i.pos),1,d);if(!d&&!p&&Qn(s.doc,s.mapping.map(i.pos),1,c&&[{type:c}])&&(d=[{type:c}],p=!0),p&&(s.split(s.mapping.map(i.pos),1,d),!a&&!i.parentOffset&&i.parent.type!=c)){var f=s.mapping.map(i.before()),m=s.doc.resolve(f);i.node(-1).canReplaceWith(m.index(),m.index()+1,c)&&s.setNodeMarkup(s.mapping.map(i.before()),c)}e(s.scrollIntoView())}return!0}function Is(n,e,t){var a,s,i=e.nodeBefore,o=e.nodeAfter;if(i.type.spec.isolating||o.type.spec.isolating)return!1;if(function(n,e,t){var i=e.nodeBefore,o=e.nodeAfter,a=e.index();return!(!(i&&o&&i.type.compatibleContent(o.type))||(!i.content.size&&e.parent.canReplace(a-1,a)?(t&&t(n.tr.delete(e.pos-i.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(a,a+1)||!o.isTextblock&&!Tr(n.doc,e.pos)||(t&&t(n.tr.clearIncompatible(e.pos,i.type,i.contentMatchAt(i.childCount)).join(e.pos).scrollIntoView()),0)))}(n,e,t))return!0;var c=e.parent.canReplace(e.index(),e.index()+1);if(c&&(a=(s=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&s.matchType(a[0]||o.type).validEnd){if(t){for(var d=e.pos+o.nodeSize,p=w.empty,f=a.length-1;f>=0;f--)p=w.from(a[f].create(null,p));p=w.from(i.copy(p));var m=n.tr.step(new ft(e.pos-1,d,e.pos,d,new h(p,1,0),a.length,!0)),g=d+2*a.length;Tr(m.doc,g)&&m.join(g),t(m.scrollIntoView())}return!0}var y=de.findFrom(e,1),T=y&&y.$from.blockRange(y.$to),E=T&&mi(T);if(null!=E&&E>=e.depth)return t&&t(n.tr.lift(T,E).scrollIntoView()),!0;if(c&&ti(o,"start",!0)&&ti(i,"end")){for(var F=i,q=[];q.push(F),!F.isTextblock;)F=F.lastChild;for(var N=o,ee=1;!N.isTextblock;N=N.firstChild)ee++;if(F.canReplace(F.childCount,F.childCount,N.content)){if(t){for(var z=w.empty,G=q.length-1;G>=0;G--)z=w.from(q[G].copy(z));t(n.tr.step(new ft(e.pos-q.length,e.pos+o.nodeSize,e.pos+ee,e.pos+o.nodeSize-ee,new h(z,q.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function ho(n,e){return function(t,i){var o=t.selection,a=o.from,s=o.to,c=!1;return t.doc.nodesBetween(a,s,function(d,p){if(c)return!1;if(d.isTextblock&&!d.hasMarkup(n,e))if(d.type==n)c=!0;else{var f=t.doc.resolve(p),m=f.index();c=f.parent.canReplaceWith(m,m+1,n)}}),!!c&&(i&&i(t.tr.setBlockType(a,s,n,e).scrollIntoView()),!0)}}function wi(n,e){return function(t,i){var o=t.selection,s=o.$cursor,c=o.ranges;if(o.empty&&!s||!function(n,e,t){for(var i=function(s){var c=e[s],d=c.$from,p=c.$to,f=0==d.depth&&n.type.allowsMarkType(t);if(n.nodesBetween(d.pos,p.pos,function(m){if(f)return!1;f=m.inlineContent&&m.type.allowsMarkType(t)}),f)return{v:!0}},o=0;o<e.length;o++){var a=i(o);if(a)return a.v}return!1}(t.doc,c,n))return!1;if(i)if(s)n.isInSet(t.storedMarks||s.marks())?i(t.tr.removeStoredMark(n)):i(t.tr.addStoredMark(n.create(e)));else{for(var d=!1,p=t.tr,f=0;!d&&f<c.length;f++){var m=c[f];d=t.doc.rangeHasMark(m.$from.pos,m.$to.pos,n)}for(var T=0;T<c.length;T++){var E=c[T],F=E.$from,q=E.$to;if(d)p.removeMark(F.pos,q.pos,n);else{var N=F.pos,ee=q.pos,z=F.nodeAfter,G=q.nodeBefore,se=z&&z.isText?/^\s*/.exec(z.text)[0].length:0,Me=G&&G.isText?/\s*$/.exec(G.text)[0].length:0;N+se<ee&&(N+=se,ee-=Me),p.addMark(N,ee,n.create(e))}}i(p.scrollIntoView())}return!0}}function Ii(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];return function(t,i,o){for(var a=0;a<n.length;a++)if(n[a](t,i,o))return!0;return!1}}D(353),D(3489);var fo=Ii(Ts,function(n,e,t){var o=n.selection.$cursor;if(!o||(t?!t.endOfTextblock("backward",n):o.parentOffset>0))return!1;var a=Ms(o);if(!a){var s=o.blockRange(),c=s&&mi(s);return null!=c&&(e&&e(n.tr.lift(s,c).scrollIntoView()),!0)}var d=a.nodeBefore;if(!d.type.spec.isolating&&Is(n,a,e))return!0;if(0==o.parent.content.size&&(ti(d,"end")||te.isSelectable(d))){if(e){var p=n.tr.deleteRange(o.before(),o.after());p.setSelection(ti(d,"end")?de.findFrom(p.doc.resolve(p.mapping.map(a.pos,-1)),-1):te.create(p.doc,a.pos-d.nodeSize)),e(p.scrollIntoView())}return!0}return!(!d.isAtom||a.depth!=o.depth-1||(e&&e(n.tr.delete(a.pos-d.nodeSize,a.pos).scrollIntoView()),0))},function(n,e,t){var i=n.selection,o=i.$head,s=o;if(!i.empty)return!1;if(o.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):o.parentOffset>0)return!1;s=Ms(o)}var c=s&&s.nodeBefore;return!(!c||!te.isSelectable(c)||(e&&e(n.tr.setSelection(te.create(n.doc,s.pos-c.nodeSize)).scrollIntoView()),0))}),Rs=Ii(Ts,function(n,e,t){var o=n.selection.$cursor;if(!o||(t?!t.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size))return!1;var a=As(o);if(!a)return!1;var s=a.nodeAfter;if(Is(n,a,e))return!0;if(0==o.parent.content.size&&(ti(s,"start")||te.isSelectable(s))){if(e){var c=n.tr.deleteRange(o.before(),o.after());c.setSelection(ti(s,"start")?de.findFrom(c.doc.resolve(c.mapping.map(a.pos)),1):te.create(c.doc,c.mapping.map(a.pos))),e(c.scrollIntoView())}return!0}return!(!s.isAtom||a.depth!=o.depth-1||(e&&e(n.tr.delete(a.pos,a.pos+s.nodeSize).scrollIntoView()),0))},function(n,e,t){var i=n.selection,o=i.$head,s=o;if(!i.empty)return!1;if(o.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):o.parentOffset<o.parent.content.size)return!1;s=As(o)}var c=s&&s.nodeAfter;return!(!c||!te.isSelectable(c)||(e&&e(n.tr.setSelection(te.create(n.doc,s.pos)).scrollIntoView()),0))}),Kt={Enter:Ii(ks,Es,ws,po),"Mod-Enter":Ss,Backspace:fo,"Mod-Backspace":fo,"Shift-Backspace":fo,Delete:Rs,"Mod-Delete":Rs,"Mod-a":function(n,e){return e&&e(n.tr.setSelection(new Wt(n.doc))),!0}},Os={"Ctrl-h":Kt.Backspace,"Alt-Backspace":Kt["Mod-Backspace"],"Ctrl-d":Kt.Delete,"Ctrl-Alt-Backspace":Kt["Mod-Delete"],"Alt-Delete":Kt["Mod-Delete"],"Alt-d":Kt["Mod-Delete"]};for(var Ns in Kt)Os[Ns]=Kt[Ns];var Wd=("undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?Os:Kt;const mo=(n,e)=>{const{from:t,$from:i,to:o,empty:a}=n.selection;return a?!!e.isInSet(n.storedMarks||i.marks()):n.doc.rangeHasMark(t,o,e)},Ps=(n,e,t={})=>{const{selection:i}=n,{$from:o,to:a}=i,s=((n,e)=>{for(let t=e.depth;t>0;t--)if(e.node(t).type===n)return e.node(t).type;return null})(e,o);return Object.entries(t).length&&s?a<=o.end()&&o.parent.hasMarkup(e,t):!!s},Fs=n=>{const e=[],{selection:{from:t,to:i}}=n;return n.doc.nodesBetween(t,i,o=>{e.push(o)}),e},Ls=(n,e,t)=>{for(const i of e){const{$from:o,$to:a}=i;let s=0===o.depth&&n.type.allowsMarkType(t);if(n.nodesBetween(o.pos,a.pos,c=>!s&&(s=c.inlineContent&&c.type.allowsMarkType(t),!0)),s)return!0}return!1},Bs=(n,e={})=>(t,i)=>{const{tr:o,selection:a}=t,{empty:s,ranges:c,$from:d,$to:p}=a;if(s&&a instanceof be){const{$cursor:f}=a;if(!f||!Ls(t.doc,c,n)||(o.addStoredMark(n.create(e)),!o.storedMarksSet))return!1;null==i||i(o)}else{if(o.addMark(d.pos,p.pos,n.create(e)),!o.docChanged)return!1;null==i||i(o.scrollIntoView())}return!0};for(var _n={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},$i={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Vs="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),Xd="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),eu="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),qs="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),tu="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),nu=Vs&&(qs||+Vs[1]<57)||eu&&qs,qe=0;qe<10;qe++)_n[48+qe]=_n[96+qe]=String(qe);for(qe=1;qe<=24;qe++)_n[qe+111]="F"+qe;for(qe=65;qe<=90;qe++)_n[qe]=String.fromCharCode(qe+32),$i[qe]=String.fromCharCode(qe);for(var go in _n)$i.hasOwnProperty(go)||($i[go]=_n[go]);var ru="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function ou(n){var e=n.split(/-(?!$)/),t=e[e.length-1];"Space"==t&&(t=" ");for(var i,o,a,s,c=0;c<e.length-1;c++){var d=e[c];if(/^(cmd|meta|m)$/i.test(d))s=!0;else if(/^a(lt)?$/i.test(d))i=!0;else if(/^(c|ctrl|control)$/i.test(d))o=!0;else if(/^s(hift)?$/i.test(d))a=!0;else{if(!/^mod$/i.test(d))throw new Error("Unrecognized modifier name: "+d);ru?s=!0:o=!0}}return i&&(t="Alt-"+t),o&&(t="Ctrl-"+t),s&&(t="Meta-"+t),a&&(t="Shift-"+t),t}function _o(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),!1!==t&&e.shiftKey&&(n="Shift-"+n),n}function Xi(n){return new St({props:{handleKeyDown:su(n)}})}function su(n){var e=function(n){var e=Object.create(null);for(var t in n)e[ou(t)]=n[t];return e}(n);return function(t,i){var s,o=function(n){var t=!(nu&&(n.ctrlKey||n.altKey||n.metaKey)||(Xd||tu)&&n.shiftKey&&n.key&&1==n.key.length)&&n.key||(n.shiftKey?$i:_n)[n.keyCode]||n.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(i),a=1==o.length&&" "!=o,c=e[_o(o,i,!a)];if(c&&c(t.state,t.dispatch,t))return!0;if(a&&(i.shiftKey||i.altKey||i.metaKey||o.charCodeAt(0)>127)&&(s=_n[i.keyCode])&&s!=o){var d=e[_o(s,i,!0)];if(d&&d(t.state,t.dispatch,t))return!0}else if(a&&i.shiftKey){var p=e[_o(o,i,!0)];if(p&&p(t.state,t.dispatch,t))return!0}return!1}}var Ue=function(){};Ue.prototype.append=function(e){return e.length?(e=Ue.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},Ue.prototype.prepend=function(e){return e.length?Ue.from(e).append(this):this},Ue.prototype.appendInner=function(e){return new lu(this,e)},Ue.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?Ue.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},Ue.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},Ue.prototype.forEach=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=this.length),t<=i?this.forEachInner(e,t,i,0):this.forEachInvertedInner(e,t,i,0)},Ue.prototype.map=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=this.length);var o=[];return this.forEach(function(a,s){return o.push(e(a,s))},t,i),o},Ue.from=function(e){return e instanceof Ue?e:e&&e.length?new Us(e):Ue.empty};var Us=function(n){function e(i){n.call(this),this.values=i}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(o,a){return 0==o&&a==this.length?this:new e(this.values.slice(o,a))},e.prototype.getInner=function(o){return this.values[o]},e.prototype.forEachInner=function(o,a,s,c){for(var d=a;d<s;d++)if(!1===o(this.values[d],c+d))return!1},e.prototype.forEachInvertedInner=function(o,a,s,c){for(var d=a-1;d>=s;d--)if(!1===o(this.values[d],c+d))return!1},e.prototype.leafAppend=function(o){if(this.length+o.length<=200)return new e(this.values.concat(o.flatten()))},e.prototype.leafPrepend=function(o){if(this.length+o.length<=200)return new e(o.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Ue);Ue.empty=new Us([]);var lu=function(n){function e(t,i){n.call(this),this.left=t,this.right=i,this.length=t.length+i.length,this.depth=Math.max(t.depth,i.depth)+1}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},e.prototype.forEachInner=function(i,o,a,s){var c=this.left.length;if(o<c&&!1===this.left.forEachInner(i,o,Math.min(a,c),s)||a>c&&!1===this.right.forEachInner(i,Math.max(o-c,0),Math.min(this.length,a)-c,s+c))return!1},e.prototype.forEachInvertedInner=function(i,o,a,s){var c=this.left.length;if(o>c&&!1===this.right.forEachInvertedInner(i,o-c,Math.max(a,c)-c,s+c)||a<c&&!1===this.left.forEachInvertedInner(i,Math.min(o,c),a,s))return!1},e.prototype.sliceInner=function(i,o){if(0==i&&o==this.length)return this;var a=this.left.length;return o<=a?this.left.slice(i,o):i>=a?this.right.slice(i-a,o-a):this.left.slice(i,a).append(this.right.slice(0,o-a))},e.prototype.leafAppend=function(i){var o=this.right.leafAppend(i);if(o)return new e(this.left,o)},e.prototype.leafPrepend=function(i){var o=this.left.leafPrepend(i);if(o)return new e(o,this.right)},e.prototype.appendInner=function(i){return this.left.depth>=Math.max(this.right.depth,i.depth)+1?new e(this.left,new e(this.right,i)):new e(this,i)},e}(Ue);const Ys=Ue;var Ye=function(e,t){this.items=e,this.eventCount=t};Ye.prototype.popEvent=function(e,t){var s,c,i=this;if(0==this.eventCount)return null;for(var o=this.items.length;;o--)if(this.items.get(o-1).selection){--o;break}t&&(s=this.remapping(o,this.items.length),c=s.maps.length);var p,f,d=e.tr,m=[],g=[];return this.items.forEach(function(y,T){if(!y.step)return s||(s=i.remapping(o,T+1),c=s.maps.length),c--,void g.push(y);if(s){g.push(new Bt(y.map));var F,E=y.step.map(s.slice(c));E&&d.maybeStep(E).doc&&m.push(new Bt(F=d.mapping.maps[d.mapping.maps.length-1],null,null,m.length+g.length)),c--,F&&s.appendMap(F,c)}else d.maybeStep(y.step);return y.selection?(p=s?y.selection.map(s.slice(c)):y.selection,f=new Ye(i.items.slice(0,o).append(g.reverse().concat(m)),i.eventCount-1),!1):void 0},this.items.length,0),{remaining:f,transform:d,selection:p}},Ye.prototype.addTransform=function(e,t,i,o){for(var a=[],s=this.eventCount,c=this.items,d=!o&&c.length?c.get(c.length-1):null,p=0;p<e.steps.length;p++){var g,f=e.steps[p].invert(e.docs[p]),m=new Bt(e.mapping.maps[p],f,t);(g=d&&d.merge(m))&&(m=g,p?a.pop():c=c.slice(0,c.length-1)),a.push(m),t&&(s++,t=null),o||(d=m)}var y=s-i.depth;return y>pu&&(c=function(n,e){var t;return n.forEach(function(i,o){if(i.selection&&0==e--)return t=o,!1}),n.slice(t)}(c,y),s-=y),new Ye(c.append(a),s)},Ye.prototype.remapping=function(e,t){var i=new je;return this.items.forEach(function(o,a){i.appendMap(o.map,null!=o.mirrorOffset&&a-o.mirrorOffset>=e?i.maps.length-o.mirrorOffset:null)},e,t),i},Ye.prototype.addMaps=function(e){return 0==this.eventCount?this:new Ye(this.items.append(e.map(function(t){return new Bt(t)})),this.eventCount)},Ye.prototype.rebased=function(e,t){if(!this.eventCount)return this;var i=[],o=Math.max(0,this.items.length-t),a=e.mapping,s=e.steps.length,c=this.eventCount;this.items.forEach(function(y){y.selection&&c--},o);var d=t;this.items.forEach(function(y){var T=a.getMirror(--d);if(null!=T){s=Math.min(s,T);var E=a.maps[T];if(y.step){var F=e.steps[T].invert(e.docs[T]),q=y.selection&&y.selection.map(a.slice(d+1,T));q&&c++,i.push(new Bt(E,F,q))}else i.push(new Bt(E))}},o);for(var p=[],f=t;f<s;f++)p.push(new Bt(a.maps[f]));var m=this.items.slice(0,o).append(p).append(i),g=new Ye(m,c);return g.emptyItemCount()>500&&(g=g.compress(this.items.length-i.length)),g},Ye.prototype.emptyItemCount=function(){var e=0;return this.items.forEach(function(t){t.step||e++}),e},Ye.prototype.compress=function(e){void 0===e&&(e=this.items.length);var t=this.remapping(0,e),i=t.maps.length,o=[],a=0;return this.items.forEach(function(s,c){if(c>=e)o.push(s),s.selection&&a++;else if(s.step){var d=s.step.map(t.slice(i)),p=d&&d.getMap();if(i--,p&&t.appendMap(p,i),d){var f=s.selection&&s.selection.map(t.slice(i));f&&a++;var g,m=new Bt(p.invert(),d,f),y=o.length-1;(g=o.length&&o[y].merge(m))?o[y]=g:o.push(m)}}else s.map&&i--},this.items.length,0),new Ye(Ys.from(o.reverse()),a)},Ye.empty=new Ye(Ys.empty,0);var Bt=function(e,t,i,o){this.map=e,this.step=t,this.selection=i,this.mirrorOffset=o};Bt.prototype.merge=function(e){if(this.step&&e.step&&!e.selection){var t=e.step.merge(this.step);if(t)return new Bt(t.getMap().invert(),t,this.selection)}};var vn=function(e,t,i,o){this.done=e,this.undone=t,this.prevRanges=i,this.prevTime=o},pu=20;function Hs(n){var e=[];return n.forEach(function(t,i,o,a){return e.push(o,a)}),e}function vo(n,e){if(!n)return null;for(var t=[],i=0;i<n.length;i+=2){var o=e.map(n[i],1),a=e.map(n[i+1],-1);o<=a&&t.push(o,a)}return t}function Js(n,e,t,i){var o=tr(e),a=Vt.get(e).spec.config,s=(i?n.undone:n.done).popEvent(e,o);if(s){var c=s.selection.resolve(s.transform.doc),d=(i?n.done:n.undone).addTransform(s.transform,e.selection.getBookmark(),a,o),p=new vn(i?d:s.remaining,i?s.remaining:d,null,0);t(s.transform.setSelection(c).setMeta(Vt,{redo:i,historyState:p}).scrollIntoView())}}var bo=!1,zs=null;function tr(n){var e=n.plugins;if(zs!=e){bo=!1,zs=e;for(var t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){bo=!0;break}}return bo}var Vt=new Et("history"),js=new Et("closeHistory");function Qs(n,e){var t=Vt.getState(n);return!(!t||0==t.done.eventCount||(e&&Js(t,n,e,!1),0))}function yo(n,e){var t=Vt.getState(n);return!(!t||0==t.undone.eventCount||(e&&Js(t,n,e,!0),0))}var bn=function(e,t){var n;this.match=e,this.handler="string"==typeof t?(n=t,function(e,t,i,o){var a=n;if(t[1]){var s=t[0].lastIndexOf(t[1]);a+=t[0].slice(s+t[1].length);var c=(i+=s)-o;c>0&&(a=t[0].slice(s-c,s)+a,i=o)}return e.tr.insertText(a,i,o)}):t};function Ws(n,e,t,i,o,a){if(n.composing)return!1;var s=n.state,c=s.doc.resolve(e);if(c.parent.type.spec.code)return!1;for(var d=c.parent.textBetween(Math.max(0,c.parentOffset-500),c.parentOffset,null,"\ufffc")+i,p=0;p<o.length;p++){var f=o[p].match.exec(d),m=f&&o[p].handler(s,f,e-(f[0].length-i.length),t);if(m)return n.dispatch(m.setMeta(a,{transform:m,from:e,to:t,text:i})),!0}return!1}var bu=new bn(/--$/,"\u2014"),yu=new bn(/\.\.\.$/,"\u2026"),Mu=[new bn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"\u201c"),new bn(/"$/,"\u201d"),new bn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"\u2018"),new bn(/'$/,"\u2019")];function xo(n,e,t,i){return new bn(n,function(o,a,s,c){var d=t instanceof Function?t(a):t,p=o.tr.delete(s,c),m=p.doc.resolve(s).blockRange(),g=m&&Dr(m,e,d);if(!g)return null;p.wrap(m,g);var y=p.doc.resolve(s-1).nodeBefore;return y&&y.type==e&&Tr(p.doc,s-1)&&(!i||i(a,y))&&p.join(s-1),p})}function Gs(n,e,t){return new bn(n,function(i,o,a,s){var c=i.doc.resolve(a),d=t instanceof Function?t(o):t;return c.node(-1).canReplaceWith(c.index(-1),c.indexAfter(-1),e)?i.tr.delete(a,s).setBlockType(a,a,e,d):null})}const Au=["imgEl"];function ku(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"span",4),r.TgZ(1,"span",5),r.NdJ("mousedown",function(o){return r.CHM(t),r.oxw().startResizing(o,"left")}),r.qZA(),r.TgZ(2,"span",6),r.NdJ("mousedown",function(o){return r.CHM(t),r.oxw().startResizing(o,"right")}),r.qZA(),r.TgZ(3,"span",7),r.NdJ("mousedown",function(o){return r.CHM(t),r.oxw().startResizing(o,"left")}),r.qZA(),r.TgZ(4,"span",8),r.NdJ("mousedown",function(o){return r.CHM(t),r.oxw().startResizing(o,"right")}),r.qZA(),r.qZA()}}const Su=function(n){return{"NgxEditor__Resizer--Active":n}},Eu=["ngxEditor"],Ks=["*"];function wu(n,e){if(1&n&&r._UZ(0,"ngx-toggle-command",7),2&n){const t=r.oxw().$implicit,i=r.oxw(2);r.Tol(i.iconContainerClass),r.Q6J("toolbarItem",t)}}function Iu(n,e){if(1&n&&r._UZ(0,"ngx-link"),2&n){const t=r.oxw(3);r.Tol(t.iconContainerClass)}}function Ru(n,e){if(1&n&&r._UZ(0,"ngx-image"),2&n){const t=r.oxw(3);r.Tol(t.iconContainerClass)}}function Ou(n,e){if(1&n&&r._UZ(0,"ngx-dropdown",9),2&n){const t=e.$implicit,i=r.oxw(4);r.Tol(i.dropdownContainerClass),r.Q6J("group",t.key)("items",t.value)}}function Nu(n,e){if(1&n&&(r.ynx(0),r.YNc(1,Ou,1,4,"ngx-dropdown",8),r.ALo(2,"keyvalue"),r.BQk()),2&n){const t=r.oxw().$implicit,i=r.oxw(2);r.xp6(1),r.Q6J("ngForOf",r.lcZ(2,1,i.getDropdownItems(t)))}}function Zu(n,e){if(1&n&&r._UZ(0,"ngx-color-picker",10),2&n){const t=r.oxw(3);r.Tol(t.iconContainerClass),r.Q6J("presets",t.presets)}}function Pu(n,e){if(1&n&&r._UZ(0,"ngx-color-picker",11),2&n){const t=r.oxw(3);r.Tol(t.iconContainerClass),r.Q6J("presets",t.presets)}}function Fu(n,e){if(1&n&&r._UZ(0,"div"),2&n){const t=r.oxw(3);r.Tol(t.seperatorClass)}}function Lu(n,e){if(1&n&&(r.ynx(0),r.YNc(1,wu,1,3,"ngx-toggle-command",3),r.YNc(2,Iu,1,2,"ngx-link",4),r.YNc(3,Ru,1,2,"ngx-image",4),r.YNc(4,Nu,3,3,"ng-container",2),r.YNc(5,Zu,1,3,"ngx-color-picker",5),r.YNc(6,Pu,1,3,"ngx-color-picker",6),r.YNc(7,Fu,1,2,"div",4),r.BQk()),2&n){const t=e.$implicit,i=e.last,o=r.oxw().last,a=r.oxw();r.xp6(1),r.Q6J("ngIf",a.toggleCommands.includes(t)),r.xp6(1),r.Q6J("ngIf","link"===t),r.xp6(1),r.Q6J("ngIf","image"===t),r.xp6(1),r.Q6J("ngIf",a.isDropDown(t)),r.xp6(1),r.Q6J("ngIf","text_color"===t),r.xp6(1),r.Q6J("ngIf","background_color"===t),r.xp6(1),r.Q6J("ngIf",i&&!o)}}function Bu(n,e){if(1&n&&(r.ynx(0),r.YNc(1,Lu,8,7,"ng-container",1),r.BQk()),2&n){const t=e.$implicit;r.xp6(1),r.Q6J("ngForOf",t)}}function Vu(n,e){if(1&n&&(r.ynx(0),r.GkF(1,12),r.BQk()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngTemplateOutlet",t.customMenuRef)}}const qu=function(n){return{"NgxEditor--Disabled":n}};function Yu(n,e){if(1&n&&(r.TgZ(0,"div",12),r._uU(1),r.qZA()),2&n){const t=r.oxw(2);r.xp6(1),r.hij(" ",(null==t.href.errors?null:t.href.errors.pattern)&&"Please enter valid url."," ")}}function Hu(n,e){if(1&n&&(r.TgZ(0,"div",12),r._uU(1),r.qZA()),2&n){const t=r.oxw(2);r.xp6(1),r.hij(" ",(null==t.text.errors?null:t.text.errors.required)&&"This is required"," ")}}function Ju(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"div",2),r.TgZ(1,"form",3),r.NdJ("ngSubmit",function(o){return r.CHM(t),r.oxw().insertLink(o)}),r.TgZ(2,"div",4),r.TgZ(3,"div",5),r.TgZ(4,"label",6),r._uU(5),r.qZA(),r._UZ(6,"input",7),r.YNc(7,Yu,2,1,"div",8),r.qZA(),r.qZA(),r.TgZ(8,"div",4),r.TgZ(9,"div",5),r.TgZ(10,"label",6),r._uU(11),r.qZA(),r._UZ(12,"input",9),r.YNc(13,Hu,2,1,"div",8),r.qZA(),r.qZA(),r.TgZ(14,"div",4),r.TgZ(15,"div",5),r.TgZ(16,"label"),r._UZ(17,"input",10),r._uU(18),r.qZA(),r.qZA(),r.qZA(),r.TgZ(19,"button",11),r._uU(20),r.qZA(),r.qZA(),r.qZA()}if(2&n){const t=r.oxw();r.xp6(1),r.Q6J("formGroup",t.form),r.xp6(4),r.Oqu(t.getLabel("url")),r.xp6(2),r.Q6J("ngIf",t.href.touched&&t.href.invalid),r.xp6(4),r.Oqu(t.getLabel("text")),r.xp6(2),r.Q6J("ngIf",t.text.touched&&t.text.invalid),r.xp6(5),r.hij(" ",t.getLabel("openInNewTab")," "),r.xp6(1),r.Q6J("disabled",!t.form.valid),r.xp6(1),r.Oqu(t.getLabel("insert"))}}const zu=function(n,e){return{"NgxEditor__Dropdown--Active":n,"NgxEditor--Disabled":e}};function ju(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"div",4),r.NdJ("mousedown",function(o){const s=r.CHM(t).$implicit;return r.oxw(2).onClick(o,s)}),r._uU(1),r.qZA()}if(2&n){const t=e.$implicit,i=r.oxw(2);r.Q6J("ngClass",r.WLB(2,zu,t===i.activeItem,i.disabledItems.includes(t))),r.xp6(1),r.hij(" ",i.getName(t)," ")}}function Qu(n,e){if(1&n&&(r.TgZ(0,"div",2),r.YNc(1,ju,2,5,"div",3),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngForOf",t.items)}}function Wu(n,e){if(1&n&&(r.TgZ(0,"div",12),r._uU(1),r.qZA()),2&n){const t=r.oxw(2);r.xp6(1),r.hij(" ",(null==t.src.errors?null:t.src.errors.pattern)&&"Please enter valid url."," ")}}function Gu(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"div",2),r.TgZ(1,"form",3),r.NdJ("ngSubmit",function(o){return r.CHM(t),r.oxw().insertLink(o)}),r.TgZ(2,"div",4),r.TgZ(3,"div",5),r.TgZ(4,"label",6),r._uU(5),r.qZA(),r._UZ(6,"input",7),r.YNc(7,Wu,2,1,"div",8),r.qZA(),r.qZA(),r.TgZ(8,"div",4),r.TgZ(9,"div",5),r.TgZ(10,"label",6),r._uU(11),r.qZA(),r._UZ(12,"input",9),r.qZA(),r.qZA(),r.TgZ(13,"div",4),r.TgZ(14,"div",5),r.TgZ(15,"label",6),r._uU(16),r.qZA(),r._UZ(17,"input",10),r.qZA(),r.qZA(),r.TgZ(18,"button",11),r._uU(19),r.qZA(),r.qZA(),r.qZA()}if(2&n){const t=r.oxw();r.xp6(1),r.Q6J("formGroup",t.form),r.xp6(4),r.Oqu(t.getLabel("url")),r.xp6(2),r.Q6J("ngIf",t.src.touched&&t.src.invalid),r.xp6(4),r.Oqu(t.getLabel("altText")),r.xp6(5),r.Oqu(t.getLabel("title")),r.xp6(2),r.Q6J("disabled",!t.form.valid||!t.form.dirty),r.xp6(1),r.Oqu(t.getLabel("insert"))}}const Ku=function(n,e){return{backgroundColor:n,color:e}},$u=function(n){return{"NgxEditor__Color--Active":n}};function Xu(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"button",7),r.NdJ("mousedown",function(o){const s=r.CHM(t).$implicit;return r.oxw(3).onColorSelect(o,s)}),r.qZA()}if(2&n){const t=e.$implicit,i=r.oxw(3);r.Q6J("ngStyle",r.WLB(3,Ku,t,i.getContrastYIQ(t)))("title",t)("ngClass",r.VKq(6,$u,i.activeColors.includes(t)))}}function ep(n,e){if(1&n&&(r.TgZ(0,"div",5),r.YNc(1,Xu,1,8,"button",6),r.qZA()),2&n){const t=e.$implicit;r.xp6(1),r.Q6J("ngForOf",t)}}function tp(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"div",2),r.YNc(1,ep,2,1,"div",3),r.TgZ(2,"button",4),r.NdJ("mousedown",function(o){return r.CHM(t),r.oxw().remove(o)}),r._uU(3),r.qZA(),r.qZA()}if(2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngForOf",t.presets),r.xp6(1),r.Q6J("disabled",!t.isActive),r.xp6(1),r.hij(" ",t.getLabel("remove")," ")}}const sp=(n=!0)=>new St({key:new Et("editable"),state:{init:()=>n,apply(e,t){var i;return null!==(i=e.getMeta("UPDATE_EDITABLE"))&&void 0!==i?i:t}},props:{editable(e){return this.getState(e)},attributes(e){return this.getState(e)?null:{class:"NgxEditor__Content--Disabled"}}}}),cp=n=>new St({key:new Et("placeholder"),state:{init:()=>null!=n?n:"",apply(e,t){var i;return null!==(i=e.getMeta("UPDATE_PLACEHOLDER"))&&void 0!==i?i:t}},props:{decorations(e){const{doc:t}=e,{textContent:i,childCount:o}=t,a=this.getState(e);if(!a||o>1)return pe.empty;const s=[];return t.descendants((d,p)=>{var f;if(d.type.isBlock&&0===d.childCount&&0===i.length){const m=we.node(p,p+d.nodeSize,{class:"NgxEditor__Placeholder","data-placeholder":a,"data-align":null!==(f=d.attrs.align)&&void 0!==f?f:null});s.push(m)}return!1}),pe.create(t,s)}}}),$s=(n=(()=>{}))=>new St({key:new Et("focus"),props:{handleDOMEvents:{focus:()=>(n(),!1)}}});let pp=(()=>{class n{constructor(){this.alt="",this.title="",this.outerWidth="",this.selected=!1,this.imageResize=new r.vpe}startResizing(t,i){t.preventDefault(),this.resizeImage(t,i)}resizeImage(t,i){const o=t.pageX,a=this.imgEl.nativeElement.clientWidth,s="left"===i,{width:c}=window.getComputedStyle(this.view.dom),d=parseInt(c,10),p=m=>{const y=m.pageX-o,T=s?a-y:a+y;T>d||T<20||(this.outerWidth=`${T}px`)},f=m=>{m.preventDefault(),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f),this.imageResize.emit()};document.addEventListener("mousemove",p),document.addEventListener("mouseup",f)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=r.Xpm({type:n,selectors:[["ngx-image-view"]],viewQuery:function(t,i){if(1&t&&r.Gf(Au,7),2&t){let o;r.iGM(o=r.CRH())&&(i.imgEl=o.first)}},inputs:{alt:"alt",title:"title",outerWidth:"outerWidth",selected:"selected",src:"src",view:"view"},outputs:{imageResize:"imageResize"},decls:4,vars:9,consts:[[1,"NgxEditor__ImageWrapper",3,"ngClass"],["class","NgxEditor__ResizeHandle",4,"ngIf"],[3,"src","alt","title"],["imgEl",""],[1,"NgxEditor__ResizeHandle"],[1,"NgxEditor__ResizeHandle--TL",3,"mousedown"],[1,"NgxEditor__ResizeHandle--TR",3,"mousedown"],[1,"NgxEditor__ResizeHandle--BL",3,"mousedown"],[1,"NgxEditor__ResizeHandle--BR",3,"mousedown"]],template:function(t,i){1&t&&(r.TgZ(0,"span",0),r.YNc(1,ku,5,0,"span",1),r._UZ(2,"img",2,3),r.qZA()),2&t&&(r.Udp("width",i.outerWidth),r.Q6J("ngClass",r.VKq(7,Su,i.selected)),r.xp6(1),r.Q6J("ngIf",i.selected),r.xp6(1),r.Q6J("src",i.src,r.LSH)("alt",i.alt)("title",i.title))},directives:[B.mk,B.O5],styles:["*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]:before{box-sizing:border-box}img[_ngcontent-%COMP%]{width:100%;height:100%}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;line-height:0;padding:2px}.NgxEditor__ImageWrapper.NgxEditor__Resizer--Active[_ngcontent-%COMP%]{padding:1px;border:1px solid #1a73e8}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--BL[_ngcontent-%COMP%], .NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--BR[_ngcontent-%COMP%], .NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--TL[_ngcontent-%COMP%], .NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--TR[_ngcontent-%COMP%]{position:absolute;width:7px;height:7px;background-color:#1a73e8;border:1px solid #fff}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--BR[_ngcontent-%COMP%]{bottom:-5px;right:-5px;cursor:se-resize}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--TR[_ngcontent-%COMP%]{top:-5px;right:-5px;cursor:ne-resize}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--TL[_ngcontent-%COMP%]{top:-5px;left:-5px;cursor:nw-resize}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--BL[_ngcontent-%COMP%]{bottom:-5px;left:-5px;cursor:sw-resize}"]}),n})();class hp{constructor(e,t,i,o){this.updating=!1,this.handleResize=()=>{if(this.updating)return;const{state:d,dispatch:p}=this.view,{tr:f}=d,m=f.setNodeMarkup(this.getPos(),void 0,{src:this.imageComponentRef.instance.src,width:this.imageComponentRef.instance.outerWidth}),g=m.doc.resolve(this.getPos()),y=new te(g);m.setSelection(y),p(m)};const a=document.createElement("image-view"),s=o.get(r._Vd);this.applicationRef=o.get(r.z2F);const c=s.resolveComponentFactory(pp);this.imageComponentRef=c.create(o,[],a),this.applicationRef.attachView(this.imageComponentRef.hostView),this.setNodeAttributes(e.attrs),this.imageComponentRef.instance.view=t,this.dom=a,this.view=t,this.node=e,this.getPos=i,this.resizeSubscription=this.imageComponentRef.instance.imageResize.subscribe(()=>{this.handleResize()})}computeChanges(e,t){return JSON.stringify(e)===JSON.stringify(t)}setNodeAttributes(e){this.imageComponentRef.instance.src=e.src,this.imageComponentRef.instance.alt=e.alt,this.imageComponentRef.instance.title=e.title,this.imageComponentRef.instance.outerWidth=e.width}update(e){return e.type===this.node.type&&(this.node=e,this.computeChanges(this.node.attrs,e.attrs)&&(this.updating=!0,this.setNodeAttributes(e.attrs),this.updating=!1),!0)}ignoreMutation(){return!0}selectNode(){this.imageComponentRef.instance.selected=!0}deselectNode(){this.imageComponentRef.instance.selected=!1}destroy(){this.resizeSubscription.unsubscribe(),this.applicationRef.detachView(this.imageComponentRef.hostView)}}const mp=/((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)$/,Xs=n=>{const e=[];return n.forEach(t=>{if(t.isText){const i=t.text;let o=0;const a=mp.exec(i);if(a){const s=a.index,c=s+a[0].length,d=t.type.schema.marks.link;s>0&&e.push(t.cut(o,s));const p=i.slice(s,c);e.push(t.cut(s,c).mark(d.create({href:p}).addToSet(t.marks))),o=c}o<i.length&&e.push(t.cut(o))}else e.push(t.copy(Xs(t.content)))}),w.fromArray(e)},_p={type:"doc",content:[{type:"paragraph"}]},Ri=(n,e)=>{if(!n)return e.nodeFromJSON(_p);if("string"!=typeof n)return e.nodeFromJSON(n);const t=((n,e)=>{const t=null!=e?e:Ki,i=document.createElement("div");return i.innerHTML=n,Ct.fromSchema(t).parse(i).toJSON()})(n,e);return e.nodeFromJSON(t)};let yp=(()=>{class n{constructor(t,i){this.renderer=t,this.injector=i,this.placeholder="Type Here...",this.enabled=!0,this.focusOut=new r.vpe,this.focusIn=new r.vpe,this.subscriptions=[],this.onChange=()=>{},this.onTouched=()=>{}}writeValue(t){!this.outputFormat&&"string"==typeof t&&(this.outputFormat="html"),this.editor.setContent(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}handleChange(t){if("html"!==this.outputFormat)this.onChange(t);else{const i=((n,e)=>{const t=null!=e?e:Ki,i=t.nodeFromJSON(n),o=Le.fromSchema(t).serializeFragment(i.content),a=document.createElement("div");return a.appendChild(o),a.innerHTML})(t,this.editor.schema);this.onChange(i)}}setMeta(t,i){const{dispatch:o,state:{tr:a}}=this.editor.view;o(a.setMeta(t,i))}enable(){this.setMeta("UPDATE_EDITABLE",!0)}disable(){this.setMeta("UPDATE_EDITABLE",!1)}setPlaceholder(t){this.setMeta("UPDATE_PLACEHOLDER",t)}registerPlugins(){this.editor.registerPlugin(sp(this.enabled)),this.editor.registerPlugin(cp(this.placeholder)),this.editor.registerPlugin(((n={})=>new St({key:new Et("attributes"),props:{attributes:n}}))({class:"NgxEditor__Content"})),this.editor.registerPlugin($s(()=>{this.focusIn.emit()})),this.editor.registerPlugin($s(()=>{this.focusIn.emit()})),this.editor.registerPlugin(((n=(()=>{}))=>new St({key:new Et("blur"),props:{handleDOMEvents:{blur:()=>(n(),!1)}}}))(()=>{this.focusOut.emit(),this.onTouched()})),this.editor.registerPlugin((n=>new St({key:new Et("link"),props:{nodeViews:{image:(e,t,i)=>new hp(e,t,i,n)}}}))(this.injector)),this.editor.registerPlugin(new St({key:new Et("link"),props:{transformPasted:n=>new h(Xs(n.content),n.openStart,n.openEnd)}}))}ngOnInit(){if(!this.editor)throw new Error("NgxEditor: Required editor instance");this.registerPlugins(),this.renderer.appendChild(this.ngxEditor.nativeElement,this.editor.view.dom);const t=this.editor.valueChanges.subscribe(i=>{this.handleChange(i)});this.subscriptions.push(t)}ngOnChanges(t){(null==t?void 0:t.placeholder)&&!t.placeholder.isFirstChange()&&this.setPlaceholder(t.placeholder.currentValue),(null==t?void 0:t.enabled)&&!t.enabled.isFirstChange()&&(t.enabled.currentValue?this.enable():this.disable())}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(r.Qsj),r.Y36(r.zs3))},n.\u0275cmp=r.Xpm({type:n,selectors:[["ngx-editor"]],viewQuery:function(t,i){if(1&t&&r.Gf(Eu,7),2&t){let o;r.iGM(o=r.CRH())&&(i.ngxEditor=o.first)}},inputs:{placeholder:"placeholder",enabled:"enabled",outputFormat:"outputFormat",editor:"editor"},outputs:{focusOut:"focusOut",focusIn:"focusIn"},features:[r._Bn([{provide:O.JU,useExisting:(0,r.Gpc)(()=>n),multi:!0}]),r.TTD],ngContentSelectors:Ks,decls:3,vars:0,consts:[[1,"NgxEditor"],["ngxEditor",""]],template:function(t,i){1&t&&(r.F$t(),r.TgZ(0,"div",0,1),r.Hsn(2),r.qZA())},styles:['.NgxEditor{background:#fff;color:#000;background-clip:padding-box;border-radius:4px;border:1px solid rgba(0,0,0,.2);position:relative}.NgxEditor--Disabled{opacity:.5;pointer-events:none}.NgxEditor__Placeholder:before{color:#6c757d;opacity:1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;cursor:text;content:attr(data-placeholder)}.NgxEditor__Placeholder[data-align=right]:before{position:relative}.NgxEditor__Content{padding:.5rem;white-space:pre-wrap;outline:none;font-variant-ligatures:none;font-feature-settings:"liga" 0}.NgxEditor__Content p{margin:0 0 .7rem}.NgxEditor__Content blockquote{padding-left:1rem;border-left:3px solid #ddd;margin-left:0;margin-right:0}.NgxEditor__Content--Disabled{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}.NgxEditor__Wrapper{border:1px solid rgba(0,0,0,.4);border-radius:4px}.NgxEditor__Wrapper .NgxEditor__MenuBar{border-top-left-radius:4px;border-top-right-radius:4px;border-bottom:1px solid rgba(0,0,0,.2)}.NgxEditor__Wrapper .NgxEditor{border-top-left-radius:0;border-top-right-radius:0;border:none}.NgxEditor__MenuBar{display:flex;padding:.2rem;cursor:default;background-color:#fff}.NgxEditor__MenuItem{border-radius:2px;display:flex;align-items:center;justify-content:center;position:relative;flex-shrink:0}.NgxEditor__MenuItem:hover{background-color:#f1f1f1}.NgxEditor__MenuItem.NgxEditor__MenuItem--Icon{height:1.85rem;width:1.85rem;transition:.3s ease-in-out}.NgxEditor__MenuItem.NgxEditor__MenuItem--Icon+.NgxEditor__MenuItem--Icon{margin-left:2px}.NgxEditor__MenuItem .NgxEditor__MenuItem--IconContainer{display:flex;height:100%;width:100%;align-items:center;justify-content:center}.NgxEditor__MenuItem.NgxEditor__MenuItem--Text{padding:0 .3rem}.NgxEditor__MenuItem.NgxEditor__MenuItem--Active{background-color:#e8f0fe}.NgxEditor__MenuItem.NgxEditor__MenuItem--Active.NgxEditor__MenuItem--Text{color:#1a73e8}.NgxEditor__MenuItem.NgxEditor__MenuItem--Active svg{fill:#1a73e8}.NgxEditor__Dropdown{min-width:4rem;position:relative;display:flex;align-items:center;flex-shrink:0}.NgxEditor__Dropdown:hover{background-color:#f1f1f1}.NgxEditor__Dropdown .NgxEditor__Dropdown--Text{display:flex;align-items:center;justify-content:center;padding:0 .3rem;height:100%;width:100%}.NgxEditor__Dropdown .NgxEditor__Dropdown--Text:after{display:inline-block;content:"";margin-left:1.5rem;vertical-align:.25rem;border-top:.25rem solid;border-right:.25rem solid transparent;border-bottom:0;border-left:.25rem solid transparent}.NgxEditor__Dropdown .NgxEditor__Dropdown--DropdownMenu{position:absolute;left:0;top:calc(1.85rem + 2px);box-shadow:0 2px 6px 2px rgba(60,64,67,.15);border-radius:4px;background-color:#fff;z-index:10;width:100%}.NgxEditor__Dropdown .NgxEditor__Dropdown--Item{padding:.5rem;white-space:nowrap;color:inherit}.NgxEditor__Dropdown .NgxEditor__Dropdown--Item:hover{background-color:#ececec}.NgxEditor__Dropdown.NgxEditor__Dropdown--Open,.NgxEditor__Dropdown.NgxEditor__Dropdown--Selected{background-color:#e8f0fe}.NgxEditor__Dropdown.NgxEditor__Dropdown--Open .NgxEditor__Dropdown--Text,.NgxEditor__Dropdown.NgxEditor__Dropdown--Selected .NgxEditor__Dropdown--Text{color:#1a73e8}.NgxEditor__Dropdown .NgxEditor__Dropdown--Active{background-color:#f1f1f1}.NgxEditor__Dropdown .NgxEditor__Dropdown--Active:hover{background-color:#e7e7e7}.NgxEditor__Popup{position:absolute;top:calc(1.85rem + 2px);box-shadow:0 2px 6px 2px rgba(60,64,67,.15);border-radius:4px;background-color:#fff;z-index:10;min-width:12rem;padding:8px}.NgxEditor__Popup .NgxEditor__Popup--FormGroup{margin-bottom:8px}.NgxEditor__Popup .NgxEditor__Popup--FormGroup label{margin-bottom:3px}.NgxEditor__Popup .NgxEditor__Popup--FormGroup input[type=text],.NgxEditor__Popup .NgxEditor__Popup--FormGroup input[type=url]{padding:2px 4px}.NgxEditor__Popup .NgxEditor__Popup--Col{display:flex;flex-direction:column;position:relative}.NgxEditor__Popup .NgxEditor__Popup--Label{font-size:85%}.NgxEditor__Seperator{border-left:1px solid #ccc;margin:0 .3rem}.NgxEditor__HelpText{font-size:80%}.NgxEditor__HelpText.NgxEditor__HelpText--Error{color:red}'],encapsulation:2}),n})(),Nn=(()=>{class n{constructor(){this.customMenuRefChange=new co.xQ}setCustomMenuRef(t){this.customMenuRefChange.next(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=(0,r.Yz7)({factory:function(){return new n},token:n,providedIn:"root"}),n})();const xp=[["bold","italic"],["code","blockquote"],["underline","strike"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["link","image"],["text_color","background_color"],["align_left","align_center","align_right","align_justify"]],Cp=["#b60205","#d93f0b","#fbca04","#0e8a16","#006b75","#1d76db","#0052cc","#5319e7","#e99695","#f9d0c4","#fef2c0","#c2e0c6","#bfdadc","#c5def5","#bfd4f2","#d4c5f9"];let Dp=(()=>{class n{constructor(t){this.menuService=t,this.toolbar=xp,this.colorPresets=Cp,this.disabled=!1,this.customMenuRef=null,this.toggleCommands=["bold","italic","underline","strike","code","blockquote","ordered_list","bullet_list","align_left","align_center","align_right","align_justify"],this.iconContainerClass=["NgxEditor__MenuItem","NgxEditor__MenuItem--Icon"],this.dropdownContainerClass=["NgxEditor__Dropdown"],this.seperatorClass=["NgxEditor__Seperator"]}get presets(){const i=[];return this.colorPresets.forEach((o,a)=>{const s=Math.floor(a/8);i[s]||i.push([]),i[s].push(o)}),i}isDropDown(t){var i;return!!(null===(i=t)||void 0===i?void 0:i.heading)}getDropdownItems(t){return t}ngOnInit(){if(!this.editor)throw new Error("NgxEditor: Required editor instance");this.menuService.editor=this.editor}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(Nn))},n.\u0275cmp=r.Xpm({type:n,selectors:[["ngx-editor-menu"]],inputs:{toolbar:"toolbar",colorPresets:"colorPresets",disabled:"disabled",customMenuRef:"customMenuRef",editor:"editor"},features:[r._Bn([Nn])],decls:3,vars:5,consts:[[1,"NgxEditor__MenuBar",3,"ngClass"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"toolbarItem","class",4,"ngIf"],[3,"class",4,"ngIf"],["type","text_color",3,"class","presets",4,"ngIf"],["type","background_color",3,"class","presets",4,"ngIf"],[3,"toolbarItem"],[3,"class","group","items",4,"ngFor","ngForOf"],[3,"group","items"],["type","text_color",3,"presets"],["type","background_color",3,"presets"],[3,"ngTemplateOutlet"]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.YNc(1,Bu,2,1,"ng-container",1),r.YNc(2,Vu,2,1,"ng-container",2),r.qZA()),2&t&&(r.Q6J("ngClass",r.VKq(3,qu,i.disabled)),r.xp6(1),r.Q6J("ngForOf",i.toolbar),r.xp6(1),r.Q6J("ngIf",i.customMenuRef))},directives:function(){return[B.mk,B.sg,B.O5,gh,_h,bh,vh,yh,B.tP]},pipes:function(){return[B.Nd]},styles:[""]}),n})();const el={bold:'\n  <path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z" />\n',italic:'\n  <path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z" />\n',code:'\n<path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>\n',underline:'\n<path d="M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"/>\n',strike:'\n<path d="M6.85,7.08C6.85,4.37,9.45,3,12.24,3c1.64,0,3,0.49,3.9,1.28c0.77,0.65,1.46,1.73,1.46,3.24h-3.01 c0-0.31-0.05-0.59-0.15-0.85c-0.29-0.86-1.2-1.28-2.25-1.28c-1.86,0-2.34,1.02-2.34,1.7c0,0.48,0.25,0.88,0.74,1.21 C10.97,8.55,11.36,8.78,12,9H7.39C7.18,8.66,6.85,8.11,6.85,7.08z M21,12v-2H3v2h9.62c1.15,0.45,1.96,0.75,1.96,1.97 c0,1-0.81,1.67-2.28,1.67c-1.54,0-2.93-0.54-2.93-2.51H6.4c0,0.55,0.08,1.13,0.24,1.58c0.81,2.29,3.29,3.3,5.67,3.3 c2.27,0,5.3-0.89,5.3-4.05c0-0.3-0.01-1.16-0.48-1.94H21V12z"/>\n',ordered_list:'\n<path d="M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"/>\n',bullet_list:'\n<path d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"/>\n',blockquote:'\n<path d="M0 0h24v24H0z" fill="none"/><path d="M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"/>\n',link:'\n<path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>\n',unlink:'\n<path d="M17 7h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.43-.98 2.63-2.31 2.98l1.46 1.46C20.88 15.61 22 13.95 22 12c0-2.76-2.24-5-5-5zm-1 4h-2.19l2 2H16zM2 4.27l3.11 3.11C3.29 8.12 2 9.91 2 12c0 2.76 2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1 0-1.59 1.21-2.9 2.76-3.07L8.73 11H8v2h2.73L13 15.27V17h1.73l4.01 4L20 19.74 3.27 3 2 4.27z"/>\n',image:'\n<path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>\n',align_left:'\n<path d="M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"/>\n',align_center:'\n<path d="M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z"/>\n',align_right:'\n<path d="M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z"/>\n',align_justify:'\n<path d="M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z"/>\n',text_color:'\n<path d="M2,20h20v4H2V20z M5.49,17h2.42l1.27-3.58h5.65L16.09,17h2.42L13.25,3h-2.5L5.49,17z M9.91,11.39l2.03-5.79h0.12l2.03,5.79 H9.91z"/>\n',color_fill:'\n<path d="M16.56,8.94L7.62,0L6.21,1.41l2.38,2.38L3.44,8.94c-0.59,0.59-0.59,1.54,0,2.12l5.5,5.5C9.23,16.85,9.62,17,10,17 s0.77-0.15,1.06-0.44l5.5-5.5C17.15,10.48,17.15,9.53,16.56,8.94z M5.21,10L10,5.21L14.79,10H5.21z M19,11.5c0,0-2,2.17-2,3.5 c0,1.1,0.9,2,2,2s2-0.9,2-2C21,13.67,19,11.5,19,11.5z M2,20h20v4H2V20z"/>\n'};class ni{static get(e,t="#000"){return`\n      <svg\n        xmlns="http://www.w3.org/2000/svg"\n        viewBox="0 0 24 24"\n        fill=${t}\n        height=20\n        width=20\n      >\n        ${el[e]||"<path></path>"}\n      </svg>\n    `}static getPath(e){return el[e]||"<path></path>"}}let Zn=(()=>{class n{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustHtml(t)}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(wd.H7,16))},n.\u0275pipe=r.Yjl({name:"sanitizeHtml",type:n,pure:!0}),n})();const tl={bold:"Bold",italic:"Italic",code:"Code",underline:"Underline",strike:"Strike",blockquote:"Blockquote",bullet_list:"Bullet List",ordered_list:"Ordered List",heading:"Heading",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6",align_left:"Left Align",align_center:"Center Align",align_right:"Right Align",align_justify:"Justify",text_color:"Text Color",background_color:"Background Color",url:"URL",text:"Text",openInNewTab:"Open in new tab",insert:"Insert",altText:"Alt Text",title:"Title",remove:"Remove"};class Yp{constructor(e={}){this.locals=tl,this.get=t=>{var i;return null!==(i=this.locals[t])&&void 0!==i?i:""},this.locals=Object.assign({},tl,e)}}let nr=(()=>{class n{constructor(){this.locals={}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=(0,r.Yz7)({factory:function(){return new n},token:n,providedIn:"root"}),n})(),Pn=(()=>{class n{constructor(t){this.config=t}get locals(){return new Yp(this.config.locals)}}return n.\u0275fac=function(t){return new(t||n)(r.LFG(nr,8))},n.\u0275prov=(0,r.Yz7)({factory:function(){return new n((0,r.LFG)(nr,8))},token:n,providedIn:"root"}),n})();const nl=n=>{var e;return{locals:null!==(e=n.locals)&&void 0!==e?e:{}}};class ii{constructor(e){this.name=e}apply(){return(e,t)=>{const{schema:i}=e,o=i.marks[this.name];return!!o&&Bs(o)(e,t)}}toggle(){return(e,t)=>{const{schema:i}=e,o=i.marks[this.name];return!!o&&wi(o)(e,t)}}isActive(e){const{schema:t}=e,i=t.marks[this.name];return!!i&&mo(e,i)}canExecute(e){return this.toggle()(e)}}class ir{constructor(e=!1){this.isBulletList=!1,this.isBulletList=e}getType(e){return this.isBulletList?e.nodes.bullet_list:e.nodes.ordered_list}toggle(){return(e,t)=>{const{schema:i}=e,o=this.getType(i);return!!o&&(this.isActive(e)?bs(i.nodes.list_item)(e,t):function(n,e){return function(t,i){var o=t.selection,a=o.$from,s=o.$to,c=a.blockRange(s),d=!1,p=c;if(!c)return!1;if(c.depth>=2&&a.node(c.depth-1).type.compatibleContent(n)&&0==c.startIndex){if(0==a.index(c.depth-1))return!1;var f=t.doc.resolve(c.start-2);p=new pi(f,f,c.depth),c.endIndex<c.parent.childCount&&(c=new pi(a,t.doc.resolve(s.end(c.depth)),c.depth)),d=!0}var m=Dr(p,n,e,c);return!!m&&(i&&i(function(n,e,t,i,o){for(var a=w.empty,s=t.length-1;s>=0;s--)a=w.from(t[s].type.create(t[s].attrs,a));n.step(new ft(e.start-(i?2:0),e.end,e.start,e.end,new h(a,0,0),t.length,!0));for(var c=0,d=0;d<t.length;d++)t[d].type==o&&(c=d+1);for(var p=t.length-c,f=e.start+t.length-(i?2:0),m=e.parent,g=e.startIndex,y=e.endIndex,T=!0;g<y;g++,T=!1)!T&&Qn(n.doc,f,p)&&(n.split(f,p),f+=2*p),f+=m.child(g).nodeSize;return n}(t.tr,c,m,d,n).scrollIntoView()),!0)}}(o)(e,t))}}isActive(e){const{schema:t}=e,i=this.getType(t);return!!i&&Ps(e,i)}canExecute(e){return this.toggle()(e)}}class Fn{constructor(e){this.level=e}apply(){return(e,t)=>{const{schema:i}=e,o=i.nodes.heading;return!!o&&ho(o)(e,t)}}toggle(){return(e,t)=>{var i;const{schema:o,selection:a,doc:s}=e,c=o.nodes.heading;if(!c)return!1;const d=a.$from.before(1),p=s.nodeAt(d),f=null!==(i=null==p?void 0:p.attrs)&&void 0!==i?i:{};return this.isActive(e)?ho(o.nodes.paragraph,f)(e,t):ho(c,Object.assign(Object.assign({},f),{level:this.level}))(e,t)}}isActive(e){const{schema:t}=e,i=Fs(e),o=t.nodes.heading;if(!o)return!1;const a=[o,t.nodes.text,t.nodes.blockquote],c=i.filter(d=>a.includes(d.type)).find(d=>d.attrs.level===this.level);return Boolean(c)}canExecute(e){return this.toggle()(e)}}class Oi{constructor(e){this.align=e}toggle(){return(e,t)=>{const{doc:i,selection:o,tr:a,schema:s}=e,{from:c,to:d}=o;let p=!1;return i.nodesBetween(c,d,(f,m)=>{const g=f.type;return[s.nodes.paragraph,s.nodes.heading].includes(g)&&(p=!0,a.setNodeMarkup(m,g,Object.assign(Object.assign({},f.attrs),{align:this.align}))),!0}),!!p&&(a.docChanged&&(null==t||t(a)),!0)}}isActive(e){const i=Fs(e).find(o=>o.attrs.align===this.align);return Boolean(i)}canExecute(e){return this.toggle()(e)}}const Jp={strict:!0};class Co{update(e={}){return(t,i)=>{const{schema:o,selection:a}=t,s=o.marks.link;return!(!s||a.empty)&&wi(s,e)(t,i)}}insert(e,t){return(i,o)=>{var a,s;const{schema:c,tr:d}=i;if(!c.marks.link)return!1;const f={href:t.href,title:null!==(a=t.title)&&void 0!==a?a:e,target:null!==(s=t.target)&&void 0!==s?s:"_blank"},m=c.text(e,[c.marks.link.create(f)]);return d.replaceSelectionWith(m,!1).scrollIntoView(),!!d.docChanged&&(null==o||o(d),!0)}}isActive(e,t=Jp){if(t.strict)return!0;const{schema:i}=e,o=i.marks.link;return!!o&&mo(e,o)}remove(e,t){return((n,e)=>{const{doc:t,selection:i,tr:o}=n,{$head:{pos:a},from:s,to:c}=i;if(s===c){const d=t.resolve(a),p=a-d.textOffset,f=p+d.parent.child(d.index()).nodeSize;o.removeMark(p,f)}else o.removeMark(s,c);return!!o.docChanged&&(null==e||e(o),!0)})(e,t)}canExecute(e){return this.update({})(e)}}class il{insert(e,t){return(i,o)=>{const{schema:a,tr:s,selection:c}=i,d=a.nodes.image;if(!d)return!1;const p=Object.assign({width:null,src:e},t);!p.width&&c instanceof te&&c.node.type===d&&(p.width=c.node.attrs.width),s.replaceSelectionWith(d.createAndFill(p));const f=s.doc.resolve(s.selection.anchor-s.selection.$anchor.nodeBefore.nodeSize);return s.setSelection(new te(f)).scrollIntoView(),!!s.docChanged&&(null==o||o(s),!0)}}isActive(e){const{selection:t}=e;return t instanceof te&&"image"===t.node.type.name}}class ri{constructor(e){this.name=e}apply(e){return(t,i)=>{const{schema:o,selection:a,doc:s}=t,c=o.marks[this.name];if(!c)return!1;const{from:d,to:p,empty:f}=a;if(!f&&d+1===p){const m=s.nodeAt(d);if((null==m?void 0:m.isAtom)&&!m.isText&&m.isLeaf)return!1}return Bs(c,e)(t,i)}}isActive(e){const{schema:t}=e,i=t.marks[this.name];return!!i&&mo(e,i)}getActiveColors(e){if(!this.isActive(e))return[];const{schema:t}=e;return(n=>{let e=[];const{selection:{from:t,to:i,empty:o,$from:a},storedMarks:s}=n;return o?e=s||a.marks():n.doc.nodesBetween(t,i,c=>{e=[...e,...c.marks]}),e})(e).filter(a=>a.type===t.marks[this.name]).map(a=>a.attrs.color).filter(Boolean)}remove(){return(e,t)=>{const{schema:i}=e,o=i.marks[this.name];return!!o&&(n=o,(e,t)=>{const{tr:i,selection:o,storedMarks:a,doc:s}=e,{empty:c,ranges:d}=o;if(c&&o instanceof be){const{$cursor:p}=o;if(!p||!Ls(e.doc,d,n))return!1;if(n.isInSet(a||p.marks()))return i.removeStoredMark(n),null==t||t(i),!0}else{for(const p of d){const{$from:f,$to:m}=p;s.rangeHasMark(f.pos,m.pos,n)&&i.removeMark(f.pos,m.pos,n)}if(!i.docChanged)return!1;null==t||t(i.scrollIntoView())}return!1})(e,t);var n}}canExecute(e){return this.apply("text_color"===this.name?{color:""}:{backgroundColor:""})(e)}}const zp=new ii("strong"),jp=new ii("em"),Qp=new ii("code"),Wp=new ii("u"),Gp=new ii("s"),Kp=new class{toggle(){return(e,t)=>{const{schema:i}=e,o=i.nodes.blockquote;return!!o&&(this.isActive(e)?function(n,e){var t=n.selection,a=t.$from.blockRange(t.$to),s=a&&mi(a);return null!=s&&(e&&e(n.tr.lift(a,s).scrollIntoView()),!0)}(e,t):(n=o,function(t,i){var o=t.selection,c=o.$from.blockRange(o.$to),d=c&&Dr(c,n,void 0);return!!d&&(i&&i(t.tr.wrap(c,d).scrollIntoView()),!0)})(e,t));var n}}isActive(e){const{schema:t}=e,i=t.nodes.blockquote;return!!i&&Ps(e,i)}canExecute(e){return this.toggle()(e)}},$p=new ir(!0),Xp=new ir(!1),eh=new Fn(1),th=new Fn(2),nh=new Fn(3),ih=new Fn(4),rh=new Fn(5),oh=new Fn(6),ah=new Oi("left"),sh=new Oi("center"),lh=new Oi("right"),ch=new Oi("justify"),dh=new Co,uh=new il,ph=new ri("text_color"),hh=new ri("text_background_color"),oi={bold:zp,italic:jp,code:Qp,underline:Wp,strike:Gp,blockquote:Kp,bullet_list:$p,ordered_list:Xp,h1:eh,h2:th,h3:nh,h4:ih,h5:rh,h6:oh,align_left:ah,align_center:sh,align_right:lh,align_justify:ch},Ni=dh,rl=uh,fh=ph,mh=hh;let gh=(()=>{class n{constructor(t,i){this.ngxeService=t,this.menuService=i,this.isActive=!1,this.disabled=!1,this.update=o=>{const{state:a}=o,s=oi[this.name];this.isActive=s.isActive(a),this.disabled=!s.canExecute(a)}}get name(){return this.toolbarItem}toggle(t){if(t.preventDefault(),0!==t.button)return;const{state:i,dispatch:o}=this.editorView;oi[this.name].toggle()(i,o)}getTitle(t){return this.ngxeService.locals.get(t)}ngOnInit(){this.html=ni.get(this.name),this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(Pn),r.Y36(Nn))},n.\u0275cmp=r.Xpm({type:n,selectors:[["ngx-toggle-command"]],hostVars:4,hostBindings:function(t,i){2&t&&r.ekj("NgxEditor__MenuItem--Active",i.isActive)("NgxEditor--Disabled",i.disabled)},inputs:{toolbarItem:"toolbarItem"},decls:2,vars:4,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","title","mousedown"]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.NdJ("mousedown",function(a){return i.toggle(a)}),r.ALo(1,"sanitizeHtml"),r.qZA()),2&t&&r.Q6J("innerHTML",r.lcZ(1,2,i.html),r.oJD)("title",i.getTitle(i.name))},pipes:[Zn],styles:[""]}),n})(),_h=(()=>{class n{constructor(t,i,o){this.el=t,this.ngxeService=i,this.menuService=o,this.showPopup=!1,this.isActive=!1,this.canExecute=!0,this.form=new O.cw({href:new O.NI("",[O.kI.required,O.kI.pattern("(https?://)?([\\da-z.-]+)\\.([a-z.]{2,6})[/\\w .-]*/?")]),text:new O.NI("",[O.kI.required]),openInNewTab:new O.NI(!0)}),this.setText=()=>{const{state:{selection:a,doc:s}}=this.editorView,{empty:c,from:d,to:p}=a,f=c?"":s.textBetween(d,p);f&&(this.text.patchValue(f),this.text.disable())},this.update=a=>{const{state:s}=a;this.isActive=Ni.isActive(s,{strict:!1}),this.canExecute=Ni.canExecute(s)}}get valid(){return this.isActive||this.showPopup}get disabled(){return!this.canExecute}get icon(){return ni.get(this.isActive?"unlink":"link")}get href(){return this.form.get("href")}get text(){return this.form.get("text")}onDocumentClick(t){!this.el.nativeElement.contains(t.target)&&this.showPopup&&this.hideForm()}getLabel(t){return this.ngxeService.locals.get(t)}hideForm(){this.showPopup=!1,this.form.reset({href:"",text:"",openInNewTab:!0}),this.text.enable()}onMouseDown(t){if(t.preventDefault(),0!==t.button)return;const{state:i,dispatch:o}=this.editorView;this.isActive?Ni.remove(i,o):(this.showPopup=!this.showPopup,this.showPopup&&this.setText())}insertLink(t){t.preventDefault();const{text:i,href:o,openInNewTab:a}=this.form.getRawValue(),{dispatch:s,state:c}=this.editorView,{selection:d}=c,p={title:o,href:o,target:a?"_blank":"_self"};d.empty?(Ni.insert(i,p)(c,s),this.editorView.focus()):Ni.update(p)(c,s),this.hideForm()}ngOnInit(){this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(r.SBq),r.Y36(Pn),r.Y36(Nn))},n.\u0275cmp=r.Xpm({type:n,selectors:[["ngx-link"]],hostVars:4,hostBindings:function(t,i){1&t&&r.NdJ("mousedown",function(a){return i.onDocumentClick(a)},!1,r.evT),2&t&&r.ekj("NgxEditor__MenuItem--Active",i.valid)("NgxEditor--Disabled",i.disabled)},decls:3,vars:4,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","mousedown"],["class","NgxEditor__Popup",4,"ngIf"],[1,"NgxEditor__Popup"],[1,"NgxEditor__Popup--Form",3,"formGroup","ngSubmit"],[1,"NgxEditor__Popup--FormGroup"],[1,"NgxEditor__Popup--Col"],[1,"NgxEditor__Popup--Label"],["type","href","id","href","formControlName","href","autofocus","","autocomplete","off"],["class","NgxEditor__HelpText NgxEditor__HelpText--Error",4,"ngIf"],["type","text","formControlName","text","autocomplete","off"],["type","checkbox","formControlName","openInNewTab"],["type","submit",3,"disabled"],[1,"NgxEditor__HelpText","NgxEditor__HelpText--Error"]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.NdJ("mousedown",function(a){return i.onMouseDown(a)}),r.ALo(1,"sanitizeHtml"),r.qZA(),r.YNc(2,Ju,21,8,"div",1)),2&t&&(r.Q6J("innerHTML",r.lcZ(1,2,i.icon),r.oJD),r.xp6(2),r.Q6J("ngIf",i.showPopup))},directives:[B.O5,O._Y,O.JL,O.sg,O.Fj,O.JJ,O.u,O.Wl],pipes:[Zn],styles:[""]}),n})(),vh=(()=>{class n{constructor(t,i,o){this.ngxeService=t,this.menuService=i,this.el=o,this.isDropdownOpen=!1,this.activeItems=[],this.disabledItems=[],this.update=a=>{const{state:s}=a;this.activeItems=[],this.disabledItems=[],this.items.forEach(c=>{const d=oi[c];d.isActive(s)&&this.activeItems.push(c),d.canExecute(s)||this.disabledItems.push(c)}),this.activeItem=1===this.activeItems.length?this.activeItems[0]:null}}get isSelected(){return Boolean(this.activeItem||this.isDropdownOpen)}get isDropdownDisabled(){return this.disabledItems.length===this.items.length}onDocumentClick(t){!this.el.nativeElement.contains(t)&&this.isDropdownOpen&&(this.isDropdownOpen=!1)}getName(t){return this.ngxeService.locals.get(t)}toggleDropdown(t){t.preventDefault(),this.isDropdownOpen=!this.isDropdownOpen}onClick(t,i){if(t.preventDefault(),0!==t.button)return;const o=oi[i],{state:a,dispatch:s}=this.editorView;o.toggle()(a,s),this.isDropdownOpen=!1}ngOnInit(){this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(Pn),r.Y36(Nn),r.Y36(r.SBq))},n.\u0275cmp=r.Xpm({type:n,selectors:[["ngx-dropdown"]],hostVars:4,hostBindings:function(t,i){1&t&&r.NdJ("mousedown",function(a){return i.onDocumentClick(a.target)},!1,r.evT),2&t&&r.ekj("NgxEditor__Dropdown--Selected",i.isSelected)("NgxEditor--Disabled",i.isDropdownDisabled)},inputs:{group:"group",items:"items"},decls:3,vars:2,consts:[[1,"NgxEditor__Dropdown--Text",3,"mousedown"],["class","NgxEditor__Dropdown--DropdownMenu",4,"ngIf"],[1,"NgxEditor__Dropdown--DropdownMenu"],["class","NgxEditor__Dropdown--Item",3,"ngClass","mousedown",4,"ngFor","ngForOf"],[1,"NgxEditor__Dropdown--Item",3,"ngClass","mousedown"]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.NdJ("mousedown",function(a){return i.toggleDropdown(a)}),r._uU(1),r.qZA(),r.YNc(2,Qu,2,1,"div",1)),2&t&&(r.xp6(1),r.hij(" ",i.getName(i.activeItem||i.group),"\n"),r.xp6(1),r.Q6J("ngIf",i.isDropdownOpen))},directives:[B.O5,B.sg,B.mk],styles:[""]}),n})(),bh=(()=>{class n{constructor(t,i,o){this.el=t,this.ngxeService=i,this.menuService=o,this.showPopup=!1,this.isActive=!1,this.form=new O.cw({src:new O.NI("",[O.kI.required,O.kI.pattern("(https?://)?([\\da-z.-]+)\\.([a-z.]{2,6})[/\\w .-]*/?")]),alt:new O.NI(""),title:new O.NI("")}),this.update=a=>{const{state:s}=a;this.isActive=rl.isActive(s)}}get valid(){return this.isActive||this.showPopup}get icon(){return ni.get("image")}get src(){return this.form.get("src")}onDocumentClick(t){!this.el.nativeElement.contains(t.target)&&this.showPopup&&this.hideForm()}getLabel(t){return this.ngxeService.locals.get(t)}hideForm(){this.showPopup=!1,this.form.reset({src:"",alt:"",title:""})}onMouseDown(t){t.preventDefault(),0===t.button&&(this.showPopup=!this.showPopup,this.showPopup&&this.fillForm())}fillForm(){const{state:t}=this.editorView,{selection:i}=t;if(i instanceof te&&this.isActive){const{src:o,alt:a="",title:s=""}=i.node.attrs;this.form.setValue({src:o,alt:a,title:s})}}insertLink(t){t.preventDefault();const{src:i,alt:o,title:a}=this.form.getRawValue(),{dispatch:s,state:c}=this.editorView;rl.insert(i,{alt:o,title:a})(c,s),this.editorView.focus(),this.hideForm()}ngOnInit(){this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(r.SBq),r.Y36(Pn),r.Y36(Nn))},n.\u0275cmp=r.Xpm({type:n,selectors:[["ngx-image"]],hostVars:2,hostBindings:function(t,i){1&t&&r.NdJ("mousedown",function(a){return i.onDocumentClick(a)},!1,r.evT),2&t&&r.ekj("NgxEditor__MenuItem--Active",i.valid)},decls:3,vars:4,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","mousedown"],["class","NgxEditor__Popup",4,"ngIf"],[1,"NgxEditor__Popup"],[1,"NgxEditor__Popup--Form",3,"formGroup","ngSubmit"],[1,"NgxEditor__Popup--FormGroup"],[1,"NgxEditor__Popup--Col"],[1,"NgxEditor__Popup--Label"],["type","href","id","href","formControlName","src","autofocus","","autocomplete","off"],["class","NgxEditor__HelpText NgxEditor__HelpText--Error",4,"ngIf"],["type","text","formControlName","alt","autocomplete","off"],["type","text","formControlName","title","autocomplete","off"],["type","submit",3,"disabled"],[1,"NgxEditor__HelpText","NgxEditor__HelpText--Error"]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.NdJ("mousedown",function(a){return i.onMouseDown(a)}),r.ALo(1,"sanitizeHtml"),r.qZA(),r.YNc(2,Gu,20,7,"div",1)),2&t&&(r.Q6J("innerHTML",r.lcZ(1,2,i.icon),r.oJD),r.xp6(2),r.Q6J("ngIf",i.showPopup))},directives:[B.O5,O._Y,O.JL,O.sg,O.Fj,O.JJ,O.u],pipes:[Zn],styles:[""]}),n})(),yh=(()=>{class n{constructor(t,i,o){this.el=t,this.menuService=i,this.ngxeService=o,this.showPopup=!1,this.isActive=!1,this.activeColors=[],this.canExecute=!0,this.update=a=>{const{state:s}=a;this.canExecute=this.command.canExecute(s),this.isActive=this.command.isActive(s),this.activeColors=[],this.isActive&&(this.activeColors=this.command.getActiveColors(s))}}get valid(){return this.isActive||this.showPopup}get disabled(){return!this.canExecute}get title(){return this.getLabel("text_color"===this.type?"text_color":"background_color")}get icon(){return ni.get("text_color"===this.type?"text_color":"color_fill")}get command(){return"text_color"===this.type?fh:mh}getContrastYIQ(t){return t=t.replace("#",""),(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>=128?"black":"white"}onDocumentClick(t){!this.el.nativeElement.contains(t.target)&&this.showPopup&&this.hidePopup()}hidePopup(){this.showPopup=!1}togglePopup(t){t.preventDefault(),0===t.button&&(this.showPopup=!this.showPopup)}remove(t){t.preventDefault();const{state:i,dispatch:o}=this.editorView;this.command.remove()(i,o),this.hidePopup()}onColorSelect(t,i){if(t.preventDefault(),0!==t.button)return;const{state:o,dispatch:a}=this.editorView;"text_color"===this.type?this.command.apply({color:i})(o,a):this.command.apply({backgroundColor:i})(o,a),this.editorView.hasFocus()||this.editorView.focus(),this.hidePopup()}getLabel(t){return this.ngxeService.locals.get(t)}ngOnInit(){this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(r.SBq),r.Y36(Nn),r.Y36(Pn))},n.\u0275cmp=r.Xpm({type:n,selectors:[["ngx-color-picker"]],hostVars:4,hostBindings:function(t,i){1&t&&r.NdJ("mousedown",function(a){return i.onDocumentClick(a)},!1,r.evT),2&t&&r.ekj("NgxEditor__MenuItem--Active",i.valid)("NgxEditor--Disabled",i.disabled)},inputs:{presets:"presets",type:"type"},decls:3,vars:5,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","title","mousedown"],["class","NgxEditor__Popup",4,"ngIf"],[1,"NgxEditor__Popup"],["class","NgxEditor__ColorContainer",4,"ngFor","ngForOf"],[1,"NgxEditor__MenuItem--Button",3,"disabled","mousedown"],[1,"NgxEditor__ColorContainer"],["class","NgxEditor__Color",3,"ngStyle","title","ngClass","mousedown",4,"ngFor","ngForOf"],[1,"NgxEditor__Color",3,"ngStyle","title","ngClass","mousedown"]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.NdJ("mousedown",function(a){return i.togglePopup(a)}),r.ALo(1,"sanitizeHtml"),r.qZA(),r.YNc(2,tp,4,3,"div",1)),2&t&&(r.Q6J("innerHTML",r.lcZ(1,3,i.icon),r.oJD)("title",i.title),r.xp6(2),r.Q6J("ngIf",i.showPopup))},directives:[B.O5,B.sg,B.PC,B.mk],pipes:[Zn],styles:['@charset "UTF-8";.NgxEditor__Popup[_ngcontent-%COMP%]{width:230px}.NgxEditor__ColorContainer[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.NgxEditor__ColorContainer[_ngcontent-%COMP%] + .NgxEditor__ColorContainer[_ngcontent-%COMP%]{margin-top:5px}.NgxEditor__Color[_ngcontent-%COMP%]{border:none;outline:none;border-radius:6px;width:24px;height:24px;flex-shrink:0}.NgxEditor__Color--Active[_ngcontent-%COMP%]:after{content:"\u2714";font-size:90%}.NgxEditor__MenuItem--Button[_ngcontent-%COMP%]{margin-top:5px}']}),n})(),Ch=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=r.oAB({type:n}),n.\u0275inj=r.cJS({providers:[Zn],imports:[[B.ez,O.UX]]}),n})();const rr=new r.OlP("NgxEditorConfig");let Dh=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:rr,useValue:t},{provide:nr,useFactory:nl,deps:[rr]}]}}static forChild(t){return{ngModule:n,providers:[{provide:rr,useValue:t},{provide:nr,useFactory:nl,deps:[rr]},Pn]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=r.oAB({type:n}),n.\u0275inj=r.cJS({providers:[],imports:[[B.ez,Ch]]}),n})();const At=(n,e=!1)=>(t,i)=>{const o=new ii(n);return e?o.toggle()(t,i):o.apply()(t,i)};class Ah{constructor(e){if(this.applyTrx=t=>{this.state=this.state.apply(null!=t?t:this.tr),this.tr=this.state.tr,this.tr.setMeta("APPLIED_TRX",!0)},this.dispatch=t=>{this.applyTrx(t)},!e)throw Error("NgxEditor: Required view to initialize commands.");this.view=e,this.state=e.state,this.tr=this.view.state.tr}exec(){if(!this.tr.getMeta("APPLIED_TRX"))return!1;const e=!this.view.state.doc.eq(this.state.doc);this.view.updateState(this.state);const t=this.tr.setMeta("FORCE_EMIT",e);return this.view.dispatch(t),!0}focus(){return this.view.focus(),this}scrollIntoView(){return this.tr.scrollIntoView(),this.applyTrx(),this}insertText(e){return this.tr.insertText(e),this.applyTrx(),this}insertNewLine(){return Ii(ks,Es,ws,po)(this.state,this.dispatch),this}applyMark(e){return At(e,!1)(this.state,this.dispatch),this}toggleMark(e){return At(e,!0)(this.state,this.dispatch),this}bold(){return At("strong")(this.state,this.dispatch),this}toggleBold(){return At("strong",!0)(this.state,this.dispatch),this}italics(){return At("em")(this.state,this.dispatch),this}toggleItalics(){return At("em",!0)(this.state,this.dispatch),this}underline(){return At("u")(this.state,this.dispatch),this}toggleUnderline(){return At("u",!0)(this.state,this.dispatch),this}strike(){return At("s")(this.state,this.dispatch),this}toggleStrike(){return At("s",!0)(this.state,this.dispatch),this}code(){return At("code")(this.state,this.dispatch),this}toggleCode(){return At("code",!0)(this.state,this.dispatch),this}toggleOrderedList(){return new ir(!1).toggle()(this.state,this.dispatch),this}toggleBulletList(){return new ir(!0).toggle()(this.state,this.dispatch),this}toggleHeading(e){return new Fn(e).toggle()(this.state,this.dispatch),this}insertLink(e,t){return(new Co).insert(e,t)(this.state,this.dispatch),this}updateLink(e){return(new Co).update(e)(this.state,this.dispatch),this}insertImage(e,t={}){return(new il).insert(e,t)(this.state,this.dispatch),this}textColor(e){return new ri("text_color").apply({color:e})(this.state,this.dispatch),this}backgroundColor(e){return new ri("text_background_color").apply({backgroundColor:e})(this.state,this.dispatch),this}removeTextColor(){return new ri("text_color").remove()(this.state,this.dispatch),this}removeBackgroundColor(){return new ri("text_background_color").remove()(this.state,this.dispatch),this}align(e){return new Oi(e).toggle()(this.state,this.dispatch),this}insertHTML(e){const{selection:t,schema:i,tr:o}=this.state,{from:a,to:s}=t,c=document.createElement("div");c.innerHTML=e.trim();const d=Ct.fromSchema(i).parseSlice(c),p=o.replaceRange(a,s,d);return this.applyTrx(p),this}}const kh=/Mac/.test(navigator.platform),Oh=n=>{const e=Mu.concat(yu,bu);return e.push((n=>xo(/^\s*>\s$/,n))(n.nodes.blockquote)),e.push((n=>xo(/^(\d+)\.\s$/,n,e=>({order:+e[1]}),(e,t)=>t.childCount+t.attrs.order===+e[1]))(n.nodes.ordered_list)),e.push((n=>xo(/^\s*([-+*])\s$/,n))(n.nodes.bullet_list)),e.push((n=>Gs(/^```$/,n))(n.nodes.code_block)),e.push(((n,e)=>Gs(new RegExp("^(#{1,6})\\s$"),n,t=>({level:t[1].length})))(n.nodes.heading)),function(n){var e=n.rules,t=new St({state:{init:function(){return null},apply:function(o,a){return o.getMeta(this)||(o.selectionSet||o.docChanged?null:a)}},props:{handleTextInput:function(o,a,s,c){return Ws(o,a,s,c,e,t)},handleDOMEvents:{compositionend:function(i){setTimeout(function(){var a=i.state.selection.$cursor;a&&Ws(i,a.pos,a.pos,"",e,t)})}}},isInputRules:!0});return t}({rules:e})},Zh=(n,e)=>{const t=[];return e.keyboardShortcuts&&t.push(...((n,e)=>{const t={};t["Mod-z"]=Qs,kh?t["Shift-Mod-z"]=yo:t["Mod-y"]=yo;const i=[Xi({"Mod-b":wi(n.marks.strong),"Mod-i":wi(n.marks.em),"Mod-`":wi(n.marks.code)}),Xi({Enter:dd(n.nodes.list_item),"Shift-Enter":Ii(Ss,(o,a)=>(a(o.tr.replaceSelectionWith(n.nodes.hard_break.create()).scrollIntoView()),!0)),"Mod-[":bs(n.nodes.list_item),"Mod-]":ys(n.nodes.list_item),Tab:ys(n.nodes.list_item)}),Xi(Wd)];return e.history&&i.push(Xi(t)),i})(n,{history:e.history})),e.history&&t.push(function(n){return new St({key:Vt,state:{init:function(){return new vn(Ye.empty,Ye.empty,null,0)},apply:function(t,i,o){return function(n,e,t,i){var a,o=t.getMeta(Vt);if(o)return o.historyState;t.getMeta(js)&&(n=new vn(n.done,n.undone,null,0));var s=t.getMeta("appendedTransaction");if(0==t.steps.length)return n;if(s&&s.getMeta(Vt))return s.getMeta(Vt).redo?new vn(n.done.addTransform(t,null,i,tr(e)),n.undone,Hs(t.mapping.maps[t.steps.length-1]),n.prevTime):new vn(n.done,n.undone.addTransform(t,null,i,tr(e)),null,n.prevTime);if(!1===t.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(a=t.getMeta("rebased"))?new vn(n.done.rebased(t,a),n.undone.rebased(t,a),vo(n.prevRanges,t.mapping),n.prevTime):new vn(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),vo(n.prevRanges,t.mapping),n.prevTime);var c=0==n.prevTime||!s&&(n.prevTime<(t.time||0)-i.newGroupDelay||!function(n,e){if(!e)return!1;if(!n.docChanged)return!0;var t=!1;return n.mapping.maps[0].forEach(function(i,o){for(var a=0;a<e.length;a+=2)i<=e[a+1]&&o>=e[a]&&(t=!0)}),t}(t,n.prevRanges)),d=s?vo(n.prevRanges,t.mapping):Hs(t.mapping.maps[t.steps.length-1]);return new vn(n.done.addTransform(t,c?e.selection.getBookmark():null,i,tr(e)),Ye.empty,d,t.time)}(i,o,t,n)}},config:n={depth:n&&n.depth||100,newGroupDelay:n&&n.newGroupDelay||500},props:{handleDOMEvents:{beforeinput:function(t,i){var o="historyUndo"==i.inputType?Qs(t.state,t.dispatch):"historyRedo"==i.inputType&&yo(t.state,t.dispatch);return o&&i.preventDefault(),o}}}})}()),e.inputRules&&t.push(Oh(n)),t},al={content:null,history:!0,keyboardShortcuts:!0,inputRules:!0,schema:Ki,plugins:[],nodeViews:{}};class Ph{constructor(e=al){this.valueChangesSubject=new co.xQ,this.updateSubject=new co.xQ,this.options=Object.assign({},al,e),this.createEditor()}get valueChanges(){return this.valueChangesSubject.asObservable()}get update(){return this.updateSubject.asObservable()}get schema(){return this.options.schema||Ki}get commands(){return new Ah(this.view)}setContent(e){if(null==e)return;const{state:t}=this.view,{tr:i,doc:o}=t,a=Ri(e,this.schema);i.replaceWith(0,t.doc.content.size,a),!o.eq(i.doc)&&(!i.docChanged||this.view.dispatch(i))}handleTransactions(e){const t=this.view.state.apply(e);if(this.view.updateState(t),this.updateSubject.next(this.view),!e.docChanged&&!e.getMeta("FORCE_EMIT"))return;const i=t.doc.toJSON();this.valueChangesSubject.next(i)}createEditor(){var e;const{options:t}=this,{content:i=null,nodeViews:o}=t,{history:a=!0,keyboardShortcuts:s=!0,inputRules:c=!0}=t,d=this.schema,p=Ri(i,d),f=null!==(e=t.plugins)&&void 0!==e?e:[],m=Zh(d,{history:a,keyboardShortcuts:s,inputRules:c});this.view=new Te(null,{state:We.create({doc:p,schema:d,plugins:[...m,...f]}),nodeViews:o,dispatchTransaction:this.handleTransactions.bind(this)})}registerPlugin(e){const{state:t}=this.view,i=[...t.plugins,e],o=t.reconfigure({plugins:i});this.view.updateState(o)}destroy(){this.view.destroy()}}var sl=D(7221),Fh=D(8032);let Lh=(()=>{class n{constructor(t,i){this.httpClient=t,this.commonHttpErrorService=i}sendEmail(t){return this.httpClient.post("Email",t).pipe((0,sl.K)(this.commonHttpErrorService.handleError))}}return n.\u0275fac=function(t){return new(t||n)(r.LFG(l.eN),r.LFG(Fh.U))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Bh(n,e){1&n&&(r.TgZ(0,"div",30),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"TO_ADDRESS_IS_REQUIRED")," "))}function Vh(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Bh,3,3,"div",29),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.emailForm.get("toAddress").errors?null:t.emailForm.get("toAddress").errors.required)}}function qh(n,e){1&n&&(r.TgZ(0,"div",30),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"EMAIL_IS_NOT_PROPER_FORMAT")," "))}function Uh(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,qh,3,3,"div",29),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.emailForm.get("toAddress").errors?null:t.emailForm.get("toAddress").errors.email)}}function Yh(n,e){1&n&&(r.TgZ(0,"div",30),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"SUBJECT_IS_REQUIRED")," "))}function Hh(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Yh,3,3,"div",29),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.emailForm.get("subject").errors?null:t.emailForm.get("subject").errors.required)}}function Jh(n,e){1&n&&(r.TgZ(0,"div",30),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"BODY_IS_REQUIRED")," "))}function zh(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Jh,3,3,"div",29),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.emailForm.get("body").errors?null:t.emailForm.get("body").errors.required)}}function jh(n,e){1&n&&(r.TgZ(0,"div",31),r._UZ(1,"mat-spinner"),r.qZA())}let Qh=(()=>{class n extends Ne.H{constructor(t,i,o,a,s,c,d){super(),this.fb=t,this.toastrService=i,this.emailSendService=o,this.data=a,this.dialogRef=s,this.commonService=c,this.translationService=d,this.isLoading=!1}ngOnInit(){this.createEmailForm(),this.editor=new Ph}closeDialog(){this.dialogRef.close()}createEmailForm(){this.emailForm=this.fb.group({id:[""],toAddress:["",[O.kI.required,O.kI.email]],subject:["",[O.kI.required]],body:["",[O.kI.required]],documentId:[this.data.id,[O.kI.required]]})}sendEmail(){this.emailForm.valid?(this.isLoading=!0,this.sub$.sink=this.emailSendService.sendEmail(this.buildObject()).subscribe(()=>{this.addDocumentTrail(),this.toastrService.success(this.translationService.getValue("EMAIL_SENT_SUCCESSFULLY")),this.dialogRef.close(),this.isLoading=!1},()=>{this.isLoading=!1})):this.emailForm.markAllAsTouched()}buildObject(){return{documentId:this.emailForm.get("documentId").value,email:this.emailForm.get("toAddress").value,subject:this.emailForm.get("subject").value,message:this.emailForm.get("body").value}}addDocumentTrail(){const t={documentId:this.data.id,operationName:j.g.Send_Email.toString()};this.sub$.sink=this.commonService.addDocumentAuditTrail(t).subscribe(i=>{})}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(O.qu),r.Y36(K._W),r.Y36(Lh),r.Y36(ge.WI),r.Y36(ge.so),r.Y36(tt.v),r.Y36(st.D))},n.\u0275cmp=r.Xpm({type:n,selectors:[["app-send-email"]],features:[r.qOj],decls:52,vars:27,consts:[[1,"dialog-header"],[1,"folder-dialog-info"],[1,"section-title"],[1,"close-icon","m-2","text-danger",3,"click"],[1,"material-icons","cursor-pointer"],[1,"d-content"],[1,"box","box-primary"],[1,"box-body"],[3,"formGroup"],[1,"row"],[1,"col-md-12","pb-1"],[1,"input-group"],[1,"input-group-prepend"],["id","toAddress",1,"input-group-text"],["formControlName","toAddress","type","text","placeholder","To Email","aria-label","To","aria-describedby","toAddress",1,"form-control"],[4,"ngIf"],["id","subject",1,"input-group-text"],["formControlName","subject","type","text","placeholder","Subject","aria-label","To","aria-describedby","subject",1,"form-control"],[1,"col-md-12"],[1,"form-group"],[1,"font-weight-bold"],[1,"NgxEditor__Wrapper"],[3,"editor"],["formControlName","body",3,"editor"],[1,"input-group-text"],["class","loading-shade",4,"ngIf"],[1,"col-md-12","mt-1"],["type","submit",1,"btn","btn-success",3,"click"],[1,"fas","fa-paper-plane"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"loading-shade"]],template:function(t,i){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"h2"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"div",3),r.NdJ("click",function(){return i.closeDialog()}),r.TgZ(7,"span",4),r._uU(8," close "),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",5),r.TgZ(10,"div",6),r.TgZ(11,"div",7),r.TgZ(12,"form",8),r.TgZ(13,"div",9),r.TgZ(14,"div",10),r.TgZ(15,"div",11),r.TgZ(16,"div",12),r.TgZ(17,"span",13),r._uU(18),r.ALo(19,"translate"),r.qZA(),r.qZA(),r._UZ(20,"input",14),r.qZA(),r.YNc(21,Vh,2,1,"div",15),r.YNc(22,Uh,2,1,"div",15),r.qZA(),r.TgZ(23,"div",10),r.TgZ(24,"div",11),r.TgZ(25,"div",12),r.TgZ(26,"span",16),r._uU(27),r.ALo(28,"translate"),r.qZA(),r.qZA(),r._UZ(29,"input",17),r.qZA(),r.YNc(30,Hh,2,1,"div",15),r.qZA(),r.TgZ(31,"div",18),r.TgZ(32,"div",19),r.TgZ(33,"label",20),r._uU(34),r.ALo(35,"translate"),r.qZA(),r.TgZ(36,"div",21),r._UZ(37,"ngx-editor-menu",22),r._UZ(38,"ngx-editor",23),r.qZA(),r.YNc(39,zh,2,1,"div",15),r.qZA(),r.qZA(),r.TgZ(40,"div",10),r.TgZ(41,"div",11),r.TgZ(42,"div",12),r.TgZ(43,"span",24),r._uU(44),r.ALo(45,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.YNc(46,jh,2,0,"div",25),r.TgZ(47,"div",26),r.TgZ(48,"button",27),r.NdJ("click",function(){return i.sendEmail()}),r._UZ(49,"i",28),r._uU(50),r.ALo(51,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t&&(r.xp6(4),r.Oqu(r.lcZ(5,15,"SEND_EMAIL")),r.xp6(8),r.Q6J("formGroup",i.emailForm),r.xp6(6),r.hij(" ",r.lcZ(19,17,"TO")," "),r.xp6(3),r.Q6J("ngIf",i.emailForm.get("toAddress").touched&&i.emailForm.get("toAddress").errors),r.xp6(1),r.Q6J("ngIf",i.emailForm.get("toAddress").touched&&i.emailForm.get("toAddress").errors),r.xp6(5),r.hij(" ",r.lcZ(28,19,"SUBJECT")," "),r.xp6(3),r.Q6J("ngIf",i.emailForm.get("subject").touched&&i.emailForm.get("subject").errors),r.xp6(4),r.hij(" ",r.lcZ(35,21,"BODY")," "),r.xp6(3),r.Q6J("editor",i.editor),r.xp6(1),r.Q6J("editor",i.editor),r.xp6(1),r.Q6J("ngIf",i.emailForm.get("body").touched&&i.emailForm.get("body").errors),r.xp6(5),r.AsE(" ",r.lcZ(45,23,"ATTACHMENT_DOCUMENT")," :: ",null==i.data?null:i.data.name," "),r.xp6(2),r.Q6J("ngIf",i.isLoading),r.xp6(4),r.hij(" ",r.lcZ(51,25,"SEND")," "))},directives:[O._Y,O.JL,O.sg,O.Fj,O.JJ,O.u,B.O5,Dp,yp,an.$g],pipes:[ct.X$],styles:[".NgxEditor{height:200px;overflow-y:scroll}  .NgxEditor__Content{min-height:300px}"]}),n})();var Do=D(591),To=D(1086),Wh=D(537);class Gh{constructor(e){this.documentService=e,this.documentsSubject=new Do.X([]),this.responseHeaderSubject=new Do.X(null),this.loadingSubject=new Do.X(!1),this.loading$=this.loadingSubject.asObservable(),this.responseHeaderSubject$=this.responseHeaderSubject.asObservable()}get data(){return this._data}set data(e){this._data=e}connect(e){return this.documentsSubject.asObservable()}disconnect(e){this.documentsSubject.complete(),this.loadingSubject.complete()}loadDocuments(e){this.loadingSubject.next(!0),this.documentService.getDocuments(e).pipe((0,sl.K)(()=>(0,To.of)([])),(0,Wh.x)(()=>this.loadingSubject.next(!1))).subscribe(t=>{const i=JSON.parse(t.headers.get("X-Pagination"));this.responseHeaderSubject.next(i),this._data=[...t.body],this.documentsSubject.next(this._data)})}}var ll=D(6943),Kh=D(1218),$h=D(8757),Rt=D(2075),cl=D(7423),dl=D(5245),or=D(2181);const Xh=["input"],ef=function(){return["/documents/add"]};function tf(n,e){1&n&&(r.TgZ(0,"button",37),r._UZ(1,"i",38),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&n&&(r.Q6J("routerLink",r.DdM(4,ef)),r.xp6(2),r.hij(" ",r.lcZ(3,2,"ADD_DOCUMENT")," "))}function nf(n,e){1&n&&(r.TgZ(0,"div",39),r._UZ(1,"mat-spinner"),r.qZA())}function rf(n,e){if(1&n&&(r.TgZ(0,"div"),r.TgZ(1,"b"),r._uU(2),r.qZA(),r.qZA()),2&n){const t=r.oxw().$implicit;r.xp6(2),r.hij(" ",t.name,"")}}function af(n,e){if(1&n&&(r.TgZ(0,"div"),r._uU(1),r.qZA()),2&n){const t=r.oxw().$implicit;r.xp6(1),r.hij(" ",t.name," ")}}const sf=function(n){return{"margin-left.px":n}};function lf(n,e){if(1&n&&(r.TgZ(0,"mat-option",14),r.TgZ(1,"div",40),r.YNc(2,rf,3,1,"div",41),r.YNc(3,af,2,1,"div",41),r.qZA(),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.Q6J("ngStyle",r.VKq(4,sf,20*t.deafLevel)),r.xp6(1),r.Q6J("ngIf",!t.parentId),r.xp6(1),r.Q6J("ngIf",t.parentId)}}function cf(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"button",44),r.NdJ("click",function(){return r.CHM(t),r.oxw(2).onSharedSelectDocument()}),r.TgZ(1,"mat-icon"),r._uU(2,"share"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()}2&n&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"SHARE")," "))}function df(n,e){1&n&&(r.TgZ(0,"div",42),r.YNc(1,cf,5,3,"button",43),r.qZA()),2&n&&(r.xp6(1),r.Q6J("hasClaim","all_documents_share_document"))}function uf(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"th",45),r.TgZ(1,"mat-checkbox",46),r.NdJ("change",function(o){r.CHM(t);const a=r.oxw();return o?a.masterToggle():null}),r.qZA(),r.qZA()}if(2&n){const t=r.oxw();r.xp6(1),r.Q6J("checked",t.selection.hasValue()&&t.isAllSelected())("indeterminate",t.selection.hasValue()&&!t.isAllSelected())}}function pf(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"td",47),r.TgZ(1,"mat-checkbox",48),r.NdJ("click",function(o){return o.stopPropagation()})("change",function(o){const s=r.CHM(t).$implicit,c=r.oxw();return o?c.selection.toggle(s):null}),r.qZA(),r.qZA()}if(2&n){const t=e.$implicit,i=r.oxw();r.xp6(1),r.Q6J("checked",i.selection.isSelected(t))}}function hf(n,e){1&n&&(r.TgZ(0,"th",49),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij("",r.lcZ(2,1,"ACTION")," "))}function ff(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"button",57),r.NdJ("click",function(){r.CHM(t);const o=r.oxw().$implicit;return r.oxw().editDocument(o)}),r.TgZ(1,"mat-icon"),r._uU(2,"edit"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()}2&n&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"EDIT")," "))}function mf(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"button",55),r.NdJ("click",function(){r.CHM(t);const o=r.oxw().$implicit;return r.oxw().manageDocumentPermission(o)}),r.TgZ(1,"mat-icon"),r._uU(2,"share"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()}2&n&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"SHARE")," "))}function gf(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"button",55),r.NdJ("click",function(){r.CHM(t);const o=r.oxw().$implicit;return r.oxw().downloadDocument(o)}),r.TgZ(1,"mat-icon"),r._uU(2,"download"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()}2&n&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"DOWNLOAD")," "))}function _f(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"button",55),r.NdJ("click",function(){r.CHM(t);const o=r.oxw().$implicit;return r.oxw().deleteDocument(o)}),r.TgZ(1,"mat-icon"),r._uU(2,"delete"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()}2&n&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"DELETE")," "))}function vf(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"td",47),r.TgZ(1,"button",50),r._UZ(2,"i",51),r.qZA(),r.TgZ(3,"mat-menu",null,52),r.YNc(5,ff,5,3,"button",53),r.YNc(6,mf,5,3,"button",54),r.TgZ(7,"button",55),r.NdJ("click",function(){const a=r.CHM(t).$implicit;return r.oxw().onDocumentView(a)}),r.TgZ(8,"mat-icon"),r._uU(9,"visibility"),r.qZA(),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.YNc(12,gf,5,3,"button",56),r.TgZ(13,"button",55),r.NdJ("click",function(){const a=r.CHM(t).$implicit;return r.oxw().sendEmail(a)}),r.TgZ(14,"mat-icon"),r._uU(15,"forward_to_inbox"),r.qZA(),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"button",55),r.NdJ("click",function(){const a=r.CHM(t).$implicit;return r.oxw().addReminder(a)}),r.TgZ(19,"mat-icon"),r._uU(20,"notifications"),r.qZA(),r._uU(21),r.ALo(22,"translate"),r.qZA(),r.YNc(23,_f,5,3,"button",54),r.qZA(),r.qZA()}if(2&n){const t=r.MAs(4);r.xp6(1),r.Q6J("matMenuTriggerFor",t),r.xp6(4),r.Q6J("hasClaim","all_documents_edit_document"),r.xp6(1),r.Q6J("hasClaim","all_documents_share_document"),r.xp6(4),r.hij(" ",r.lcZ(11,8,"VIEW")," "),r.xp6(2),r.Q6J("hasClaim","all_documents_download_document"),r.xp6(4),r.hij(" ",r.lcZ(17,10,"SEND_EMAIL")," "),r.xp6(5),r.hij(" ",r.lcZ(22,12,"ADD_REMINDER")," "),r.xp6(2),r.Q6J("hasClaim","all_documents_delete_document")}}function bf(n,e){1&n&&(r.TgZ(0,"th",58),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"NAME")," "))}function yf(n,e){if(1&n&&(r.TgZ(0,"td",47),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.xp6(1),r.hij(" ",t.name," ")}}function xf(n,e){1&n&&(r.TgZ(0,"th",58),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"DOCUMENT_CATEGORY")))}function Cf(n,e){if(1&n&&(r.TgZ(0,"td",47),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.xp6(1),r.hij(" ",t.categoryName," ")}}function Df(n,e){1&n&&(r.TgZ(0,"th",58),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"CREATED_DATE")," "))}function Tf(n,e){if(1&n&&(r.TgZ(0,"td",47),r._uU(1),r.ALo(2,"date"),r.qZA()),2&n){const t=e.$implicit;r.xp6(1),r.hij(" ",r.xi3(2,1,null==t?null:t.createdDate,"dd/MM/yyyy")," ")}}function Mf(n,e){1&n&&(r.TgZ(0,"th",58),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"CREATED_BY")," "))}function Af(n,e){if(1&n&&(r.TgZ(0,"td",47),r._uU(1),r.qZA()),2&n){const t=e.$implicit;r.xp6(1),r.hij(" ",null==t?null:t.createdBy," ")}}function kf(n,e){1&n&&r._UZ(0,"tr",59)}function Sf(n,e){1&n&&r._UZ(0,"tr",60)}const Ef=function(){return[10,20,30]};let wf=(()=>{class n extends Ne.H{constructor(t,i,o,a,s,c,d,p,f){super(),this.documentService=t,this.toastrService=i,this.commonDialogService=o,this.categoryService=a,this.dialog=s,this.overlay=c,this.documentLibraryService=d,this.translationService=p,this.commonService=f,this.documents=[],this.displayedColumns=["select","action","name","categoryName","createdDate","createdBy"],this.isLoadingResults=!0,this.categories=[],this.allCategories=[],this.selection=new X.Ov(!0,[]),this.documentResource=new re.J,this.documentResource.pageSize=10,this.documentResource.orderBy="CreatedDate desc"}ngOnInit(){this.dataSource=new Gh(this.documentService),this.dataSource.loadDocuments(this.documentResource),this.getCategories(),this.getResourceParameter()}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,He.T)(this.sort.sortChange,this.paginator.page).pipe((0,W.b)(t=>{this.documentResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.documentResource.pageSize=this.paginator.pageSize,this.documentResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadDocuments(this.documentResource)})).subscribe(),this.sub$.sink=(0,at.R)(this.input.nativeElement,"keyup").pipe((0,Oe.b)(1e3),(0,Ce.x)(),(0,W.b)(()=>{this.paginator.pageIndex=0,this.documentResource.name=this.input.nativeElement.value,this.dataSource.loadDocuments(this.documentResource)})).subscribe()}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.dataSource.data.forEach(t=>this.selection.select(t))}onCategoryChange(t){this.documentResource.categoryId=t.value?t.value:"",this.documentResource.skip=0,this.dataSource.loadDocuments(this.documentResource)}onCreatedDateChange(t){this.documentResource.createDate=t||null,this.documentResource.skip=0,this.dataSource.loadDocuments(this.documentResource)}getCategories(){this.categoryService.getAllCategoriesForDropDown().subscribe(t=>{this.categories=[...t],this.setDeafLevel()})}setDeafLevel(t,i){const o=this.categories.filter(a=>a.parentId==i);return o.length>0&&o.map((a,s)=>{a.deafLevel=t?t.deafLevel+1:0,a.index=(t?t.index:0)+s*Math.pow(.1,a.deafLevel),this.allCategories.push(a),this.setDeafLevel(a,a.id)}),t}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(t=>{t&&(this.documentResource.pageSize=t.pageSize,this.documentResource.skip=t.skip,this.documentResource.totalCount=t.totalCount)})}deleteDocument(t){this.sub$.sink=this.commonDialogService.deleteConformationDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")} ${t.name}`).subscribe(i=>{i&&(this.sub$.sink=this.documentService.deleteDocument(t.id).subscribe(()=>{this.addDocumentTrail(t.id,j.g.Deleted.toString()),this.toastrService.success(this.translationService.getValue("DOCUMENT_DELETED_SUCCESSFULLY")),this.dataSource.loadDocuments(this.documentResource)}))})}getDocuments(){this.isLoadingResults=!0,this.sub$.sink=this.documentService.getDocuments(this.documentResource).subscribe(t=>{const i=JSON.parse(t.headers.get("X-Pagination"));this.documentResource.pageSize=i.pageSize,this.documentResource.skip=i.skip,this.documents=[...t.body],this.isLoadingResults=!1},()=>this.isLoadingResults=!1)}editDocument(t){const o=this.dialog.open(Ot,{width:"600px",data:Object.assign({},{document:t,categories:this.categories})});this.sub$.sink=o.afterClosed().subscribe(a=>{"loaded"===a&&this.dataSource.loadDocuments(this.documentResource)})}manageDocumentPermission(t){this.dialog.open(nn.z,{data:t,width:"80vw",height:"80vh"})}onSharedSelectDocument(){this.dialog.open(Ae,{data:this.selection.selected,width:"80vw",height:"80vh"})}downloadDocument(t){this.sub$.sink=this.commonService.downloadDocument(t.id).subscribe(i=>{i.type===l.dt.Response&&(this.addDocumentTrail(t.id,j.g.Download.toString()),this.downloadFile(i,t))},i=>{this.toastrService.error(this.translationService.getValue("ERROR_WHILE_DOWNLOADING_DOCUMENT"))})}addDocumentTrail(t,i){this.sub$.sink=this.commonService.addDocumentAuditTrail({documentId:t,operationName:i}).subscribe(a=>{})}sendEmail(t){this.dialog.open(Qh,{data:t,width:"80vw",height:"80vh"})}addReminder(t){this.dialog.open(So,{data:t,width:"80vw",height:"80vh"})}onDocumentView(t){const o=t.url.split(".")[1];this.overlay.open(ce.Y,{position:"center",origin:"global",panelClass:["file-preview-overlay-container","white-background"],data:{documentId:t.id,name:t.name,extension:o,isRestricted:t.isAllowDownload}})}downloadFile(t,i){const o=new Blob([t.body],{type:t.body.type}),a=document.createElement("a");a.setAttribute("style","display:none;"),document.body.appendChild(a),a.download=i.name,a.href=URL.createObjectURL(o),a.target="_blank",a.click(),document.body.removeChild(a)}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(Je.Z),r.Y36(K._W),r.Y36(J.V),r.Y36(ll.H),r.Y36(ge.uw),r.Y36(Kh.T),r.Y36($h.Y),r.Y36(st.D),r.Y36(tt.v))},n.\u0275cmp=r.Xpm({type:n,selectors:[["app-document-list"]],viewQuery:function(t,i){if(1&t&&(r.Gf(ve.NW,5),r.Gf(Se.YE,5),r.Gf(Xh,5)),2&t){let o;r.iGM(o=r.CRH())&&(i.paginator=o.first),r.iGM(o=r.CRH())&&(i.sort=o.first),r.iGM(o=r.CRH())&&(i.input=o.first)}},features:[r.qOj],decls:61,vars:31,consts:[[1,"row","mb-3","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"section-title"],[1,"widget-title"],["class","btn btn-success btn-sm m-right-10",3,"routerLink",4,"hasClaim"],[1,"mat-elevation-z8"],["class","loading-shade",4,"ngIf"],[1,"table-container"],[1,"row","mt-3","ml-5"],[1,"col-sm-4"],[1,"w-100"],["matInput","",3,"placeholder"],["input",""],[3,"placeholder","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],["matInput","",3,"matDatepicker","dateInput"],["ref",""],["matSuffix","",3,"for"],["picker",""],[1,"row"],["class","col-sm-4 m-2",4,"ngIf"],["mat-table","","matSort","","matSortActive","createdDate","matSortDirection","desc",1,"mat-elevation-z8","table",3,"dataSource"],["matColumnDef","select"],["style","width:100px;","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","categoryName"],["matColumnDef","createdDate"],["matColumnDef","createdBy"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize","pageSizeOptions"],[1,"btn","btn-success","btn-sm","m-right-10",3,"routerLink"],[1,"las","la-plus"],[1,"loading-shade"],[1,"country-item",3,"ngStyle"],[4,"ngIf"],[1,"col-sm-4","m-2"],["mat-raised-button","","color","primary",3,"click",4,"hasClaim"],["mat-raised-button","","color","primary",3,"click"],["mat-header-cell","",2,"width","100px"],["color","primary",3,"checked","indeterminate","change"],["mat-cell",""],["color","primary",3,"checked","click","change"],["mat-header-cell",""],["aria-label","Action",1,"btn","btn-sm","btn-primary",3,"matMenuTriggerFor"],[1,"las","la-ellipsis-v"],["menu","matMenu"],["mat-menu-item","","class","btn btn-light btn-sm",3,"click",4,"hasClaim"],["mat-menu-item","","class","btn btn-light btn-sm","type","button",3,"click",4,"hasClaim"],["mat-menu-item","","type","button",1,"btn","btn-light","btn-sm",3,"click"],["class","btn btn-light btn-sm","mat-menu-item","","type","button",3,"click",4,"hasClaim"],["mat-menu-item","",1,"btn","btn-light","btn-sm",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-header-row",""],["mat-row",""]],template:function(t,i){if(1&t){const o=r.EpF();r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"h2"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"div",1),r.TgZ(7,"h4",3),r.YNc(8,tf,4,5,"button",4),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",5),r.YNc(10,nf,2,0,"div",6),r.ALo(11,"async"),r.TgZ(12,"div",7),r.TgZ(13,"div",8),r.TgZ(14,"div",9),r.TgZ(15,"mat-form-field",10),r._UZ(16,"input",11,12),r.ALo(18,"translate"),r.qZA(),r.qZA(),r.TgZ(19,"div",9),r.TgZ(20,"mat-form-field",10),r.TgZ(21,"mat-select",13),r.NdJ("selectionChange",function(s){return i.onCategoryChange(s)}),r.ALo(22,"translate"),r.TgZ(23,"mat-option",14),r._uU(24),r.ALo(25,"translate"),r.qZA(),r.YNc(26,lf,4,6,"mat-option",15),r.qZA(),r.qZA(),r.qZA(),r.TgZ(27,"div",9),r.TgZ(28,"mat-form-field",16),r.TgZ(29,"mat-label"),r._uU(30),r.ALo(31,"translate"),r.qZA(),r.TgZ(32,"input",17,18),r.NdJ("dateInput",function(){r.CHM(o);const s=r.MAs(33);return i.onCreatedDateChange(s.value)}),r.qZA(),r._UZ(34,"mat-datepicker-toggle",19),r._UZ(35,"mat-datepicker",null,20),r.qZA(),r.qZA(),r.qZA(),r.TgZ(37,"div",21),r.YNc(38,df,2,1,"div",22),r.qZA(),r.TgZ(39,"table",23),r.ynx(40,24),r.YNc(41,uf,2,2,"th",25),r.YNc(42,pf,2,1,"td",26),r.BQk(),r.ynx(43,27),r.YNc(44,hf,3,3,"th",28),r.YNc(45,vf,24,14,"td",26),r.BQk(),r.ynx(46,29),r.YNc(47,bf,3,3,"th",30),r.YNc(48,yf,2,1,"td",26),r.BQk(),r.ynx(49,31),r.YNc(50,xf,3,3,"th",30),r.YNc(51,Cf,2,1,"td",26),r.BQk(),r.ynx(52,32),r.YNc(53,Df,3,3,"th",30),r.YNc(54,Tf,3,4,"td",26),r.BQk(),r.ynx(55,33),r.YNc(56,Mf,3,3,"th",30),r.YNc(57,Af,2,1,"td",26),r.BQk(),r.YNc(58,kf,1,0,"tr",34),r.YNc(59,Sf,1,0,"tr",35),r.qZA(),r._UZ(60,"mat-paginator",36),r.qZA(),r.qZA()}if(2&t){const o=r.MAs(36);r.xp6(4),r.Oqu(r.lcZ(5,18,"ALL_DOCUMENTS")),r.xp6(4),r.Q6J("hasClaim","all_documents_create_document"),r.xp6(2),r.Q6J("ngIf",r.lcZ(11,20,i.dataSource.loading$)),r.xp6(6),r.s9C("placeholder",r.lcZ(18,22,"SEARCH_DOCUMENT_BY_NAME_OR_DESCRIPTION")),r.xp6(5),r.s9C("placeholder",r.lcZ(22,24,"SELECT_CATEGORY")),r.xp6(3),r.hij("-- ",r.lcZ(25,26,"NONE")," --"),r.xp6(2),r.Q6J("ngForOf",i.allCategories),r.xp6(4),r.Oqu(r.lcZ(31,28,"CREATED_DATE")),r.xp6(2),r.Q6J("matDatepicker",o),r.xp6(2),r.Q6J("for",o),r.xp6(4),r.Q6J("ngIf",i.selection.hasValue()),r.xp6(1),r.Q6J("dataSource",i.dataSource),r.xp6(19),r.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),r.xp6(1),r.Q6J("matRowDefColumns",i.displayedColumns),r.xp6(1),r.Q6J("length",i.documentResource.totalCount)("pageSize",i.documentResource.pageSize)("pageSizeOptions",r.DdM(30,Ef))}},directives:[lt.d,B.O5,Ze.KE,k.Nt,nt.gD,_t.ey,B.sg,Ze.hX,Q.hl,Q.nW,Ze.R9,Q.Mq,Rt.BZ,Se.YE,Rt.w1,Rt.fO,Rt.Dz,Rt.as,Rt.nj,ve.NW,I.rH,an.$g,B.PC,cl.lW,dl.Hw,Rt.ge,b.oG,Rt.ev,or.p6,or.VK,or.OP,Se.nU,Rt.XQ,Rt.Gk],pipes:[ct.X$,B.Ov,B.uU],styles:[""]}),n})();var If=D(2986),Rf=D(1709);let Of=(()=>{class n{constructor(t,i){this.documentService=t,this.router=i}resolve(t,i){const o=t.paramMap.get("id");return"add"===o?null:this.documentService.getDocument(o).pipe((0,If.q)(1),(0,Rf.zg)(a=>a?(0,To.of)(a):(this.router.navigate(["/document"]),(0,To.of)(null))))}}return n.\u0275fac=function(t){return new(t||n)(r.LFG(Je.Z),r.LFG(I.F0))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Nf=D(2340),ul=D(5899);function Zf(n,e){1&n&&(r.TgZ(0,"div",22),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"NAME_IS_REQUIRED")," "))}function Pf(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Zf,3,3,"div",21),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.documentForm.get("name").errors?null:t.documentForm.get("name").errors.required)}}function Ff(n,e){if(1&n&&(r.TgZ(0,"div"),r.TgZ(1,"b"),r._uU(2),r.qZA(),r.qZA()),2&n){const t=r.oxw().$implicit;r.xp6(2),r.hij(" ",t.name,"")}}function Lf(n,e){if(1&n&&(r.TgZ(0,"div"),r._uU(1),r.qZA()),2&n){const t=r.oxw().$implicit;r.xp6(1),r.hij(" ",t.name," ")}}const Bf=function(n){return{"margin-left.px":n}};function Vf(n,e){if(1&n&&(r.TgZ(0,"mat-option",23),r.TgZ(1,"div",24),r.YNc(2,Ff,3,1,"div",8),r.YNc(3,Lf,2,1,"div",8),r.qZA(),r.qZA()),2&n){const t=e.$implicit;r.Q6J("value",t.id),r.xp6(1),r.Q6J("ngStyle",r.VKq(4,Bf,20*t.deafLevel)),r.xp6(1),r.Q6J("ngIf",!t.parentId),r.xp6(1),r.Q6J("ngIf",t.parentId)}}function qf(n,e){1&n&&(r.TgZ(0,"div",22),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"CATEGORY_IS_REQUIRED")," "))}function Uf(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,qf,3,3,"div",21),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.documentForm.get("categoryId").errors?null:t.documentForm.get("categoryId").errors.required)}}function Yf(n,e){1&n&&(r.TgZ(0,"div",22),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"DOCUMENT_IS_REQUIRED")," "))}function Hf(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Yf,3,3,"div",21),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.documentForm.get("url").errors?null:t.documentForm.get("url").errors.required)}}function Jf(n,e){1&n&&(r.TgZ(0,"div",22),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&n&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"DOCUMENT_TYPE_IS_NOT_ALLOW")," "))}function zf(n,e){if(1&n&&(r.TgZ(0,"div"),r.YNc(1,Jf,3,3,"div",21),r.qZA()),2&n){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",null==t.documentForm.get("extension").errors?null:t.documentForm.get("extension").errors.required)}}function jf(n,e){if(1&n&&r._UZ(0,"mat-progress-bar",25),2&n){const t=r.oxw();r.Q6J("value",t.progress)}}function Qf(n,e){if(1&n){const t=r.EpF();r.TgZ(0,"button",26),r.NdJ("click",function(){return r.CHM(t),r.oxw().SaveDocument()}),r._UZ(1,"i",27),r._uU(2),r.ALo(3,"translate"),r.qZA()}if(2&n){const t=r.oxw();r.Q6J("disabled",!t.isFileUpload),r.xp6(2),r.hij(" ",r.lcZ(3,2,"SAVE"),"")}}const Wf=function(){return["/documents"]};let Gf=(()=>{class n extends Ne.H{constructor(t,i,o,a){super(),this.fb=t,this.httpClient=i,this.cd=o,this.categoryService=a,this.extension="",this.categories=[],this.allCategories=[],this.onSaveDocument=new r.vpe,this.progress=0,this.message="",this.showProgress=!1,this.isFileUpload=!1}ngOnInit(){this.createDocumentForm(),this.getCategories()}getCategories(){this.categoryService.getAllCategoriesForDropDown().subscribe(t=>{this.categories=t,this.setDeafLevel()})}setDeafLevel(t,i){const o=this.categories.filter(a=>a.parentId==i);return o.length>0&&o.map((a,s)=>{a.deafLevel=t?t.deafLevel+1:0,a.index=(t?t.index:0)+s*Math.pow(.1,a.deafLevel),this.allCategories.push(a),this.setDeafLevel(a,a.id)}),t}onDocumentChange(t){const o=(t.target.files||t.srcElement.files)[0];if(this.extension=o.name.split(".").pop(),this.fileExtesionValidation(this.extension)){var a=new FileReader;a.onload=s=>{this.documentSource=s.target.result,this.fileUploadValidation("upload")},a.readAsDataURL(o)}else this.documentSource=null,this.fileUploadValidation("")}fileUploadValidation(t){this.documentForm.patchValue({url:t}),this.documentForm.get("url").markAsTouched(),this.documentForm.updateValueAndValidity()}fileUploadSizeValidation(t){this.documentForm.patchValue({fileSize:t}),this.documentForm.get("fileSize").markAsTouched(),this.documentForm.updateValueAndValidity()}fileUploadExtensionValidation(t){this.documentForm.patchValue({extension:t}),this.documentForm.get("extension").markAsTouched(),this.documentForm.updateValueAndValidity()}fileExtesionValidation(t){return!!Nf.N.allowExtesions.find(a=>a.extentions.find(s=>s===t))}createDocumentForm(){this.documentForm=this.fb.group({name:["",[O.kI.required]],description:[""],categoryId:["",[O.kI.required]],url:["",[O.kI.required]],fileSize:["",[O.kI.required]],extension:["",[O.kI.required]]})}SaveDocument(){this.documentForm.valid?this.onSaveDocument.emit(this.buildDocumentObject()):this.markFormGroupTouched(this.documentForm)}markFormGroupTouched(t){Object.values(t.controls).forEach(i=>{i.markAsTouched(),i.controls&&this.markFormGroupTouched(i)})}buildDocumentObject(){return{id:this.fileInfo.id,categoryId:this.documentForm.get("categoryId").value,description:this.documentForm.get("description").value,name:this.documentForm.get("name").value,url:this.fileInfo.fileName}}upload(t){if(0===t.length)return;if(this.extension=t[0].name.split(".").pop(),this.showProgress=!0,!this.fileExtesionValidation(this.extension))return this.fileUploadExtensionValidation(""),this.showProgress=!1,void this.cd.markForCheck();this.fileUploadExtensionValidation("valid"),this.fileUploadSizeValidation("valid");const o=new FormData;for(let s of t)o.append(s.name,s);const a=new l.aW("POST","api/document/upload",o,{reportProgress:!0});this.sub$.sink=this.httpClient.request(a).subscribe(s=>{s.type===l.dt.UploadProgress?(this.progress=Math.round(100*s.loaded/s.total),this.cd.markForCheck()):s.type===l.dt.Response&&(this.fileInfo=s.body,this.fileUploadValidation(this.fileInfo.fileName),this.isFileUpload=!0,this.cd.markForCheck())})}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(O.qu),r.Y36(l.eN),r.Y36(r.sBO),r.Y36(ll.H))},n.\u0275cmp=r.Xpm({type:n,selectors:[["app-document-manage-presentation"]],inputs:{loading:"loading"},outputs:{onSaveDocument:"onSaveDocument"},features:[r.qOj],decls:50,vars:31,consts:[[1,"row","mb-3","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"section-title"],[3,"formGroup"],[1,"row"],[1,"col-sm-12"],[1,"form-group"],["formControlName","name","type","text",1,"form-control"],[4,"ngIf"],[1,"col-sm-12","col-md-6"],["formControlName","categoryId",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["formControlName","description",1,"form-control"],[1,"col-md-12"],["type","file",1,"form-control",3,"change"],["file",""],["mode","determinate",3,"value",4,"ngIf"],[1,"m-top-10","col-md-12"],["class","btn btn-success btn-sm m-right-10","cdkFocusInitial","",3,"disabled","click",4,"hasClaim"],["type","button",1,"btn","btn-danger","btn-sm",3,"routerLink"],[1,"las","la-times-circle"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[3,"value"],[1,"country-item",3,"ngStyle"],["mode","determinate",3,"value"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-right-10",3,"disabled","click"],[1,"las","la-save"]],template:function(t,i){if(1&t){const o=r.EpF();r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"h2"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(6,"form",3),r.TgZ(7,"div",4),r.TgZ(8,"div",5),r.TgZ(9,"div",6),r.TgZ(10,"label"),r._uU(11),r.ALo(12,"translate"),r.qZA(),r._UZ(13,"input",7),r.YNc(14,Pf,2,1,"div",8),r.qZA(),r.qZA(),r.TgZ(15,"div",9),r.TgZ(16,"div",6),r.TgZ(17,"mat-label"),r._uU(18),r.ALo(19,"translate"),r.qZA(),r.TgZ(20,"mat-select",10),r.TgZ(21,"mat-option"),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.YNc(24,Vf,4,6,"mat-option",11),r.qZA(),r.YNc(25,Uf,2,1,"div",8),r.qZA(),r.qZA(),r.TgZ(26,"div",5),r.TgZ(27,"div",6),r.TgZ(28,"label"),r._uU(29),r.ALo(30,"translate"),r.qZA(),r.TgZ(31,"textarea",12),r._uU(32,"        "),r.qZA(),r.qZA(),r.qZA(),r.TgZ(33,"div",13),r.TgZ(34,"div",6),r.TgZ(35,"label"),r._uU(36),r.ALo(37,"translate"),r.qZA(),r.TgZ(38,"input",14,15),r.NdJ("change",function(){r.CHM(o);const s=r.MAs(39);return i.upload(s.files)}),r.qZA(),r.YNc(40,Hf,2,1,"div",8),r.YNc(41,zf,2,1,"div",8),r.qZA(),r.qZA(),r.TgZ(42,"div",13),r.YNc(43,jf,1,1,"mat-progress-bar",16),r.qZA(),r.TgZ(44,"div",17),r.YNc(45,Qf,4,4,"button",18),r.TgZ(46,"button",19),r._UZ(47,"i",20),r._uU(48),r.ALo(49,"translate"),r.qZA(),r.qZA(),r.qZA(),r.qZA()}2&t&&(r.xp6(4),r.Oqu(r.lcZ(5,16,"ADD_DOCUMENT")),r.xp6(2),r.Q6J("formGroup",i.documentForm),r.xp6(5),r.Oqu(r.lcZ(12,18,"NAME")),r.xp6(3),r.Q6J("ngIf",i.documentForm.get("name").touched&&i.documentForm.get("name").errors),r.xp6(4),r.Oqu(r.lcZ(19,20,"CATEGORY")),r.xp6(4),r.hij("-- ",r.lcZ(23,22,"NONE")," --"),r.xp6(2),r.Q6J("ngForOf",i.allCategories),r.xp6(1),r.Q6J("ngIf",i.documentForm.get("categoryId").touched&&i.documentForm.get("categoryId").errors),r.xp6(4),r.Oqu(r.lcZ(30,24,"DESCRIPTION")),r.xp6(7),r.Oqu(r.lcZ(37,26,"DOCUMENT_UPLOAD")),r.xp6(4),r.Q6J("ngIf",(i.documentForm.get("url").touched||i.documentForm.get("url").dirty)&&i.documentForm.get("url").errors),r.xp6(1),r.Q6J("ngIf",(i.documentForm.get("extension").touched||i.documentForm.get("extension").dirty)&&i.documentForm.get("url").errors),r.xp6(2),r.Q6J("ngIf",i.showProgress),r.xp6(2),r.Q6J("hasClaim","all_documents_create_document"),r.xp6(1),r.Q6J("routerLink",r.DdM(30,Wf)),r.xp6(2),r.hij(" ",r.lcZ(49,28,"CANCEL"),""))},directives:[O._Y,O.JL,O.sg,O.Fj,O.JJ,O.u,B.O5,Ze.hX,nt.gD,_t.ey,B.sg,lt.d,I.rH,B.PC,ul.pW],pipes:[ct.X$],styles:[""],changeDetection:0}),n})(),pl=(()=>{class n extends Ne.H{constructor(t,i,o,a,s){super(),this.toastrService=t,this.documentService=i,this.router=o,this.commonService=a,this.translationService=s}ngOnInit(){}saveDocument(t){this.sub$.sink=this.documentService.addDocument(t).subscribe(i=>{this.addDocumentTrail(i.id),this.toastrService.success(this.translationService.getValue("DOCUMENT_SAVE_SUCCESSFULLY")),this.router.navigate(["/documents"])})}addDocumentTrail(t){const i={documentId:t,operationName:j.g.Created.toString()};this.sub$.sink=this.commonService.addDocumentAuditTrail(i).subscribe(o=>{})}}return n.\u0275fac=function(t){return new(t||n)(r.Y36(K._W),r.Y36(Je.Z),r.Y36(I.F0),r.Y36(tt.v),r.Y36(st.D))},n.\u0275cmp=r.Xpm({type:n,selectors:[["app-document-manage"]],features:[r.qOj],decls:2,vars:3,consts:[[3,"loading","onSaveDocument"]],template:function(t,i){1&t&&(r.TgZ(0,"app-document-manage-presentation",0),r.NdJ("onSaveDocument",function(a){return i.saveDocument(a)}),r.ALo(1,"async"),r.qZA()),2&t&&r.Q6J("loading",r.lcZ(1,1,i.loading$))},directives:[Gf],pipes:[B.Ov],styles:[""]}),n})();const Kf=[{path:"",component:wf,data:{claimType:"all_documents_view_documents"},canActivate:[he.a]},{path:"add",component:pl,data:{claimType:"all_documents_create_document"},canActivate:[he.a]},{path:":id",component:pl,resolve:{document:Of},data:{claimType:"all_documents_edit_document"},canActivate:[he.a]},{path:"permission",loadChildren:()=>Promise.resolve().then(D.bind(D,3477)).then(n=>n.DocumentPermissionModule)}];let $f=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=r.oAB({type:n}),n.\u0275inj=r.cJS({imports:[[I.Bz.forChild(Kf)],I.Bz]}),n})();var Xf=D(2368),em=D(6845),tm=D(3477);let nm=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=r.oAB({type:n}),n.\u0275inj=r.cJS({imports:[[B.ez,$f,O.UX,Rt.p0,an.Cq,ge.Is,nt.LD,Xf.rP,Se.JX,ve.TU,k.c,Q.FA,dl.Ps,cl.ot,em.m,ul.Cv,tm.DocumentPermissionModule,b.p9,or.Tx,Dh,Zt.Ll,Zt.x,Ht.Fk]]}),n})()},2140:(si,ot,D)=>{D.d(ot,{HS:()=>lt,qn:()=>Ot,Hi:()=>rn});var B=D(1159),I=D(5e3),he=D(508),X=D(3191),l=D(9808),ve=D(6360),Se=D(8929),j=D(6787),re=D(2986),ce=D(7625),He=D(1059),at=D(925),W=D(5664),Oe=D(449),Ce=D(3075),Ne=D(7322),O=D(226);const ge=["*"],K=new I.OlP("MatChipRemove"),Je=new I.OlP("MatChipAvatar"),tt=new I.OlP("MatChipTrailingIcon");class st{constructor(oe){this._elementRef=oe}}const Ze=(0,he.sb)((0,he.pj)((0,he.Kr)(st),"primary"),-1);let lt=(()=>{class J extends Ze{constructor(b,k,Q,ie,vt,Ge,bt,dt){super(b),this._ngZone=k,this._changeDetectorRef=vt,this._hasFocus=!1,this.chipListSelectable=!0,this._chipListMultiple=!1,this._chipListDisabled=!1,this._selected=!1,this._selectable=!0,this._disabled=!1,this._removable=!0,this._onFocus=new Se.xQ,this._onBlur=new Se.xQ,this.selectionChange=new I.vpe,this.destroyed=new I.vpe,this.removed=new I.vpe,this._addHostClassName(),this._chipRippleTarget=Ge.createElement("div"),this._chipRippleTarget.classList.add("mat-chip-ripple"),this._elementRef.nativeElement.appendChild(this._chipRippleTarget),this._chipRipple=new he.IR(this,k,this._chipRippleTarget,Q),this._chipRipple.setupTriggerEvents(b),this.rippleConfig=ie||{},this._animationsDisabled="NoopAnimations"===bt,this.tabIndex=null!=dt&&parseInt(dt)||-1}get rippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||!!this.rippleConfig.disabled}get selected(){return this._selected}set selected(b){const k=(0,X.Ig)(b);k!==this._selected&&(this._selected=k,this._dispatchSelectionChange())}get value(){return void 0!==this._value?this._value:this._elementRef.nativeElement.textContent}set value(b){this._value=b}get selectable(){return this._selectable&&this.chipListSelectable}set selectable(b){this._selectable=(0,X.Ig)(b)}get disabled(){return this._chipListDisabled||this._disabled}set disabled(b){this._disabled=(0,X.Ig)(b)}get removable(){return this._removable}set removable(b){this._removable=(0,X.Ig)(b)}get ariaSelected(){return this.selectable&&(this._chipListMultiple||this.selected)?this.selected.toString():null}_addHostClassName(){const b="mat-basic-chip",k=this._elementRef.nativeElement;k.hasAttribute(b)||k.tagName.toLowerCase()===b?k.classList.add(b):k.classList.add("mat-standard-chip")}ngOnDestroy(){this.destroyed.emit({chip:this}),this._chipRipple._removeTriggerEvents()}select(){this._selected||(this._selected=!0,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())}deselect(){this._selected&&(this._selected=!1,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())}selectViaInteraction(){this._selected||(this._selected=!0,this._dispatchSelectionChange(!0),this._changeDetectorRef.markForCheck())}toggleSelected(b=!1){return this._selected=!this.selected,this._dispatchSelectionChange(b),this._changeDetectorRef.markForCheck(),this.selected}focus(){this._hasFocus||(this._elementRef.nativeElement.focus(),this._onFocus.next({chip:this})),this._hasFocus=!0}remove(){this.removable&&this.removed.emit({chip:this})}_handleClick(b){this.disabled?b.preventDefault():b.stopPropagation()}_handleKeydown(b){if(!this.disabled)switch(b.keyCode){case B.yY:case B.ZH:this.remove(),b.preventDefault();break;case B.L_:this.selectable&&this.toggleSelected(!0),b.preventDefault()}}_blur(){this._ngZone.onStable.pipe((0,re.q)(1)).subscribe(()=>{this._ngZone.run(()=>{this._hasFocus=!1,this._onBlur.next({chip:this})})})}_dispatchSelectionChange(b=!1){this.selectionChange.emit({source:this,isUserInput:b,selected:this._selected})}}return J.\u0275fac=function(b){return new(b||J)(I.Y36(I.SBq),I.Y36(I.R0b),I.Y36(at.t4),I.Y36(he.Y2,8),I.Y36(I.sBO),I.Y36(l.K0),I.Y36(ve.Qb,8),I.$8M("tabindex"))},J.\u0275dir=I.lG2({type:J,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(b,k,Q){if(1&b&&(I.Suo(Q,Je,5),I.Suo(Q,tt,5),I.Suo(Q,K,5)),2&b){let ie;I.iGM(ie=I.CRH())&&(k.avatar=ie.first),I.iGM(ie=I.CRH())&&(k.trailingIcon=ie.first),I.iGM(ie=I.CRH())&&(k.removeIcon=ie.first)}},hostAttrs:["role","option",1,"mat-chip","mat-focus-indicator"],hostVars:14,hostBindings:function(b,k){1&b&&I.NdJ("click",function(ie){return k._handleClick(ie)})("keydown",function(ie){return k._handleKeydown(ie)})("focus",function(){return k.focus()})("blur",function(){return k._blur()}),2&b&&(I.uIk("tabindex",k.disabled?null:k.tabIndex)("disabled",k.disabled||null)("aria-disabled",k.disabled.toString())("aria-selected",k.ariaSelected),I.ekj("mat-chip-selected",k.selected)("mat-chip-with-avatar",k.avatar)("mat-chip-with-trailing-icon",k.trailingIcon||k.removeIcon)("mat-chip-disabled",k.disabled)("_mat-animation-noopable",k._animationsDisabled))},inputs:{color:"color",disableRipple:"disableRipple",tabIndex:"tabIndex",selected:"selected",value:"value",selectable:"selectable",disabled:"disabled",removable:"removable"},outputs:{selectionChange:"selectionChange",destroyed:"destroyed",removed:"removed"},exportAs:["matChip"],features:[I.qOj]}),J})();const qt=new I.OlP("mat-chips-default-options"),en=(0,he.FD)(class{constructor(J,oe,b,k){this._defaultErrorStateMatcher=J,this._parentForm=oe,this._parentFormGroup=b,this.ngControl=k}});let tn=0;class Ut{constructor(oe,b){this.source=oe,this.value=b}}let Ot=(()=>{class J extends en{constructor(b,k,Q,ie,vt,Ge,bt){super(Ge,ie,vt,bt),this._elementRef=b,this._changeDetectorRef=k,this._dir=Q,this.controlType="mat-chip-list",this._lastDestroyedChipIndex=null,this._destroyed=new Se.xQ,this._uid="mat-chip-list-"+tn++,this._tabIndex=0,this._userTabIndex=null,this._onTouched=()=>{},this._onChange=()=>{},this._multiple=!1,this._compareWith=(dt,Nt)=>dt===Nt,this._disabled=!1,this.ariaOrientation="horizontal",this._selectable=!0,this.change=new I.vpe,this.valueChange=new I.vpe,this.ngControl&&(this.ngControl.valueAccessor=this)}get selected(){var b,k;return this.multiple?(null===(b=this._selectionModel)||void 0===b?void 0:b.selected)||[]:null===(k=this._selectionModel)||void 0===k?void 0:k.selected[0]}get role(){return this.empty?null:"listbox"}get multiple(){return this._multiple}set multiple(b){this._multiple=(0,X.Ig)(b),this._syncChipsState()}get compareWith(){return this._compareWith}set compareWith(b){this._compareWith=b,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(b){this.writeValue(b),this._value=b}get id(){return this._chipInput?this._chipInput.id:this._uid}get required(){var b,k,Q,ie;return null!==(ie=null!==(b=this._required)&&void 0!==b?b:null===(Q=null===(k=this.ngControl)||void 0===k?void 0:k.control)||void 0===Q?void 0:Q.hasValidator(Ce.kI.required))&&void 0!==ie&&ie}set required(b){this._required=(0,X.Ig)(b),this.stateChanges.next()}get placeholder(){return this._chipInput?this._chipInput.placeholder:this._placeholder}set placeholder(b){this._placeholder=b,this.stateChanges.next()}get focused(){return this._chipInput&&this._chipInput.focused||this._hasFocusedChip()}get empty(){return(!this._chipInput||this._chipInput.empty)&&(!this.chips||0===this.chips.length)}get shouldLabelFloat(){return!this.empty||this.focused}get disabled(){return this.ngControl?!!this.ngControl.disabled:this._disabled}set disabled(b){this._disabled=(0,X.Ig)(b),this._syncChipsState()}get selectable(){return this._selectable}set selectable(b){this._selectable=(0,X.Ig)(b),this.chips&&this.chips.forEach(k=>k.chipListSelectable=this._selectable)}set tabIndex(b){this._userTabIndex=b,this._tabIndex=b}get chipSelectionChanges(){return(0,j.T)(...this.chips.map(b=>b.selectionChange))}get chipFocusChanges(){return(0,j.T)(...this.chips.map(b=>b._onFocus))}get chipBlurChanges(){return(0,j.T)(...this.chips.map(b=>b._onBlur))}get chipRemoveChanges(){return(0,j.T)(...this.chips.map(b=>b.destroyed))}ngAfterContentInit(){this._keyManager=new W.Em(this.chips).withWrap().withVerticalOrientation().withHomeAndEnd().withHorizontalOrientation(this._dir?this._dir.value:"ltr"),this._dir&&this._dir.change.pipe((0,ce.R)(this._destroyed)).subscribe(b=>this._keyManager.withHorizontalOrientation(b)),this._keyManager.tabOut.pipe((0,ce.R)(this._destroyed)).subscribe(()=>{this._allowFocusEscape()}),this.chips.changes.pipe((0,He.O)(null),(0,ce.R)(this._destroyed)).subscribe(()=>{this.disabled&&Promise.resolve().then(()=>{this._syncChipsState()}),this._resetChips(),this._initializeSelection(),this._updateTabIndex(),this._updateFocusForDestroyedChips(),this.stateChanges.next()})}ngOnInit(){this._selectionModel=new Oe.Ov(this.multiple,void 0,!1),this.stateChanges.next()}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==this._disabled&&(this.disabled=!!this.ngControl.disabled))}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this.stateChanges.complete(),this._dropSubscriptions()}registerInput(b){this._chipInput=b,this._elementRef.nativeElement.setAttribute("data-mat-chip-input",b.id)}setDescribedByIds(b){this._ariaDescribedby=b.join(" ")}writeValue(b){this.chips&&this._setSelectionByValue(b,!1)}registerOnChange(b){this._onChange=b}registerOnTouched(b){this._onTouched=b}setDisabledState(b){this.disabled=b,this.stateChanges.next()}onContainerClick(b){this._originatesFromChip(b)||this.focus()}focus(b){this.disabled||this._chipInput&&this._chipInput.focused||(this.chips.length>0?(this._keyManager.setFirstItemActive(),this.stateChanges.next()):(this._focusInput(b),this.stateChanges.next()))}_focusInput(b){this._chipInput&&this._chipInput.focus(b)}_keydown(b){const k=b.target;k&&k.classList.contains("mat-chip")&&(this._keyManager.onKeydown(b),this.stateChanges.next())}_updateTabIndex(){this._tabIndex=this._userTabIndex||(0===this.chips.length?-1:0)}_updateFocusForDestroyedChips(){if(null!=this._lastDestroyedChipIndex)if(this.chips.length){const b=Math.min(this._lastDestroyedChipIndex,this.chips.length-1);this._keyManager.setActiveItem(b)}else this.focus();this._lastDestroyedChipIndex=null}_isValidIndex(b){return b>=0&&b<this.chips.length}_setSelectionByValue(b,k=!0){if(this._clearSelection(),this.chips.forEach(Q=>Q.deselect()),Array.isArray(b))b.forEach(Q=>this._selectValue(Q,k)),this._sortValues();else{const Q=this._selectValue(b,k);Q&&k&&this._keyManager.setActiveItem(Q)}}_selectValue(b,k=!0){const Q=this.chips.find(ie=>null!=ie.value&&this._compareWith(ie.value,b));return Q&&(k?Q.selectViaInteraction():Q.select(),this._selectionModel.select(Q)),Q}_initializeSelection(){Promise.resolve().then(()=>{(this.ngControl||this._value)&&(this._setSelectionByValue(this.ngControl?this.ngControl.value:this._value,!1),this.stateChanges.next())})}_clearSelection(b){this._selectionModel.clear(),this.chips.forEach(k=>{k!==b&&k.deselect()}),this.stateChanges.next()}_sortValues(){this._multiple&&(this._selectionModel.clear(),this.chips.forEach(b=>{b.selected&&this._selectionModel.select(b)}),this.stateChanges.next())}_propagateChanges(b){let k=null;k=Array.isArray(this.selected)?this.selected.map(Q=>Q.value):this.selected?this.selected.value:b,this._value=k,this.change.emit(new Ut(this,k)),this.valueChange.emit(k),this._onChange(k),this._changeDetectorRef.markForCheck()}_blur(){this._hasFocusedChip()||this._keyManager.setActiveItem(-1),this.disabled||(this._chipInput?setTimeout(()=>{this.focused||this._markAsTouched()}):this._markAsTouched())}_markAsTouched(){this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next()}_allowFocusEscape(){-1!==this._tabIndex&&(this._tabIndex=-1,setTimeout(()=>{this._tabIndex=this._userTabIndex||0,this._changeDetectorRef.markForCheck()}))}_resetChips(){this._dropSubscriptions(),this._listenToChipsFocus(),this._listenToChipsSelection(),this._listenToChipsRemoved()}_dropSubscriptions(){this._chipFocusSubscription&&(this._chipFocusSubscription.unsubscribe(),this._chipFocusSubscription=null),this._chipBlurSubscription&&(this._chipBlurSubscription.unsubscribe(),this._chipBlurSubscription=null),this._chipSelectionSubscription&&(this._chipSelectionSubscription.unsubscribe(),this._chipSelectionSubscription=null),this._chipRemoveSubscription&&(this._chipRemoveSubscription.unsubscribe(),this._chipRemoveSubscription=null)}_listenToChipsSelection(){this._chipSelectionSubscription=this.chipSelectionChanges.subscribe(b=>{b.source.selected?this._selectionModel.select(b.source):this._selectionModel.deselect(b.source),this.multiple||this.chips.forEach(k=>{!this._selectionModel.isSelected(k)&&k.selected&&k.deselect()}),b.isUserInput&&this._propagateChanges()})}_listenToChipsFocus(){this._chipFocusSubscription=this.chipFocusChanges.subscribe(b=>{let k=this.chips.toArray().indexOf(b.chip);this._isValidIndex(k)&&this._keyManager.updateActiveItem(k),this.stateChanges.next()}),this._chipBlurSubscription=this.chipBlurChanges.subscribe(()=>{this._blur(),this.stateChanges.next()})}_listenToChipsRemoved(){this._chipRemoveSubscription=this.chipRemoveChanges.subscribe(b=>{const k=b.chip,Q=this.chips.toArray().indexOf(b.chip);this._isValidIndex(Q)&&k._hasFocus&&(this._lastDestroyedChipIndex=Q)})}_originatesFromChip(b){let k=b.target;for(;k&&k!==this._elementRef.nativeElement;){if(k.classList.contains("mat-chip"))return!0;k=k.parentElement}return!1}_hasFocusedChip(){return this.chips&&this.chips.some(b=>b._hasFocus)}_syncChipsState(){this.chips&&this.chips.forEach(b=>{b._chipListDisabled=this._disabled,b._chipListMultiple=this.multiple})}}return J.\u0275fac=function(b){return new(b||J)(I.Y36(I.SBq),I.Y36(I.sBO),I.Y36(O.Is,8),I.Y36(Ce.F,8),I.Y36(Ce.sg,8),I.Y36(he.rD),I.Y36(Ce.a5,10))},J.\u0275cmp=I.Xpm({type:J,selectors:[["mat-chip-list"]],contentQueries:function(b,k,Q){if(1&b&&I.Suo(Q,lt,5),2&b){let ie;I.iGM(ie=I.CRH())&&(k.chips=ie)}},hostAttrs:[1,"mat-chip-list"],hostVars:15,hostBindings:function(b,k){1&b&&I.NdJ("focus",function(){return k.focus()})("blur",function(){return k._blur()})("keydown",function(ie){return k._keydown(ie)}),2&b&&(I.Ikx("id",k._uid),I.uIk("tabindex",k.disabled?null:k._tabIndex)("aria-describedby",k._ariaDescribedby||null)("aria-required",k.role?k.required:null)("aria-disabled",k.disabled.toString())("aria-invalid",k.errorState)("aria-multiselectable",k.multiple)("role",k.role)("aria-orientation",k.ariaOrientation),I.ekj("mat-chip-list-disabled",k.disabled)("mat-chip-list-invalid",k.errorState)("mat-chip-list-required",k.required))},inputs:{errorStateMatcher:"errorStateMatcher",multiple:"multiple",compareWith:"compareWith",value:"value",required:"required",placeholder:"placeholder",disabled:"disabled",ariaOrientation:["aria-orientation","ariaOrientation"],selectable:"selectable",tabIndex:"tabIndex"},outputs:{change:"change",valueChange:"valueChange"},exportAs:["matChipList"],features:[I._Bn([{provide:Ne.Eo,useExisting:J}]),I.qOj],ngContentSelectors:ge,decls:2,vars:0,consts:[[1,"mat-chip-list-wrapper"]],template:function(b,k){1&b&&(I.F$t(),I.TgZ(0,"div",0),I.Hsn(1),I.qZA())},styles:['.mat-chip{position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;transform:translateZ(0);border:none;-webkit-appearance:none;-moz-appearance:none}.mat-standard-chip{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:inline-flex;padding:7px 12px;border-radius:16px;align-items:center;cursor:default;min-height:32px;height:1px}._mat-animation-noopable.mat-standard-chip{transition:none;animation:none}.mat-standard-chip .mat-chip-remove{border:none;-webkit-appearance:none;-moz-appearance:none;padding:0;background:none}.mat-standard-chip .mat-chip-remove.mat-icon,.mat-standard-chip .mat-chip-remove .mat-icon{width:18px;height:18px;font-size:18px}.mat-standard-chip::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;opacity:0;content:"";pointer-events:none;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-standard-chip:hover::after{opacity:.12}.mat-standard-chip:focus{outline:none}.mat-standard-chip:focus::after{opacity:.16}.cdk-high-contrast-active .mat-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-standard-chip:focus{outline:dotted 2px}.cdk-high-contrast-active .mat-standard-chip.mat-chip-selected{outline-width:3px}.mat-standard-chip.mat-chip-disabled::after{opacity:0}.mat-standard-chip.mat-chip-disabled .mat-chip-remove,.mat-standard-chip.mat-chip-disabled .mat-chip-trailing-icon{cursor:default}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar,.mat-standard-chip.mat-chip-with-avatar{padding-top:0;padding-bottom:0}.mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-right:8px;padding-left:0}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon.mat-chip-with-avatar{padding-left:8px;padding-right:0}.mat-standard-chip.mat-chip-with-trailing-icon{padding-top:7px;padding-bottom:7px;padding-right:8px;padding-left:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-trailing-icon{padding-left:8px;padding-right:12px}.mat-standard-chip.mat-chip-with-avatar{padding-left:0;padding-right:12px}[dir=rtl] .mat-standard-chip.mat-chip-with-avatar{padding-right:0;padding-left:12px}.mat-standard-chip .mat-chip-avatar{width:24px;height:24px;margin-right:8px;margin-left:4px}[dir=rtl] .mat-standard-chip .mat-chip-avatar{margin-left:8px;margin-right:4px}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{width:18px;height:18px;cursor:pointer}.mat-standard-chip .mat-chip-remove,.mat-standard-chip .mat-chip-trailing-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-standard-chip .mat-chip-remove,[dir=rtl] .mat-standard-chip .mat-chip-trailing-icon{margin-right:8px;margin-left:0}.mat-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit;overflow:hidden}.mat-chip-list-wrapper{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;margin:-4px}.mat-chip-list-wrapper input.mat-input-element,.mat-chip-list-wrapper .mat-standard-chip{margin:4px}.mat-chip-list-stacked .mat-chip-list-wrapper{flex-direction:column;align-items:flex-start}.mat-chip-list-stacked .mat-chip-list-wrapper .mat-standard-chip{width:100%}.mat-chip-avatar{border-radius:50%;justify-content:center;align-items:center;display:flex;overflow:hidden;object-fit:cover}input.mat-chip-input{width:150px;margin:4px;flex:1 0 150px}\n'],encapsulation:2,changeDetection:0}),J})(),rn=(()=>{class J{}return J.\u0275fac=function(b){return new(b||J)},J.\u0275mod=I.oAB({type:J}),J.\u0275inj=I.cJS({providers:[he.rD,{provide:qt,useValue:{separatorKeyCodes:[B.K5]}}],imports:[[he.BQ]]}),J})()},6856:(si,ot,D)=>{D.d(ot,{Mq:()=>P,hl:()=>Yn,FA:()=>Hn,nW:()=>lr});var B=D(5664),I=D(2845),he=D(7429),X=D(9808),l=D(5e3),ve=D(7423),Se=D(9071),j=D(508),re=D(8929),ce=D(2654),He=D(6787),at=D(1086),W=D(1159),Oe=D(2986),Ce=D(1059),Ne=D(2198),O=D(226),ge=D(3191),r=D(925),K=D(1777),Je=D(3075),tt=D(7322),st=D(7531);const Ze=["mat-calendar-body",""];function nt(v,C){if(1&v&&(l.TgZ(0,"tr",2),l.TgZ(1,"td",3),l._uU(2),l.qZA(),l.qZA()),2&v){const u=l.oxw();l.xp6(1),l.Udp("padding-top",u._cellPadding)("padding-bottom",u._cellPadding),l.uIk("colspan",u.numCols),l.xp6(1),l.hij(" ",u.label," ")}}function _t(v,C){if(1&v&&(l.TgZ(0,"td",3),l._uU(1),l.qZA()),2&v){const u=l.oxw(2);l.Udp("padding-top",u._cellPadding)("padding-bottom",u._cellPadding),l.uIk("colspan",u._firstRowOffset),l.xp6(1),l.hij(" ",u._firstRowOffset>=u.labelMinRequiredCells?u.label:""," ")}}function lt(v,C){if(1&v){const u=l.EpF();l.TgZ(0,"td",7),l.NdJ("click",function(_){const U=l.CHM(u).$implicit;return l.oxw(2)._cellClicked(U,_)}),l.TgZ(1,"div",8),l._uU(2),l.qZA(),l._UZ(3,"div",9),l.qZA()}if(2&v){const u=C.$implicit,h=C.index,_=l.oxw().index,x=l.oxw();l.Udp("width",x._cellWidth)("padding-top",x._cellPadding)("padding-bottom",x._cellPadding),l.ekj("mat-calendar-body-disabled",!u.enabled)("mat-calendar-body-active",x._isActiveCell(_,h))("mat-calendar-body-range-start",x._isRangeStart(u.compareValue))("mat-calendar-body-range-end",x._isRangeEnd(u.compareValue))("mat-calendar-body-in-range",x._isInRange(u.compareValue))("mat-calendar-body-comparison-bridge-start",x._isComparisonBridgeStart(u.compareValue,_,h))("mat-calendar-body-comparison-bridge-end",x._isComparisonBridgeEnd(u.compareValue,_,h))("mat-calendar-body-comparison-start",x._isComparisonStart(u.compareValue))("mat-calendar-body-comparison-end",x._isComparisonEnd(u.compareValue))("mat-calendar-body-in-comparison-range",x._isInComparisonRange(u.compareValue))("mat-calendar-body-preview-start",x._isPreviewStart(u.compareValue))("mat-calendar-body-preview-end",x._isPreviewEnd(u.compareValue))("mat-calendar-body-in-preview",x._isInPreview(u.compareValue)),l.Q6J("ngClass",u.cssClasses)("tabindex",x._isActiveCell(_,h)?0:-1),l.uIk("data-mat-row",_)("data-mat-col",h)("aria-label",u.ariaLabel)("aria-disabled",!u.enabled||null)("aria-selected",x._isSelected(u.compareValue))("aria-current",x.todayValue===u.compareValue?"date":null),l.xp6(1),l.ekj("mat-calendar-body-selected",x._isSelected(u.compareValue))("mat-calendar-body-comparison-identical",x._isComparisonIdentical(u.compareValue))("mat-calendar-body-today",x.todayValue===u.compareValue),l.xp6(1),l.hij(" ",u.displayValue," ")}}function ct(v,C){if(1&v&&(l.TgZ(0,"tr",4),l.YNc(1,_t,2,6,"td",5),l.YNc(2,lt,4,47,"td",6),l.qZA()),2&v){const u=C.$implicit,h=C.index,_=l.oxw();l.xp6(1),l.Q6J("ngIf",0===h&&_._firstRowOffset),l.xp6(1),l.Q6J("ngForOf",u)}}function qt(v,C){if(1&v&&(l.TgZ(0,"th",5),l.TgZ(1,"abbr",6),l._uU(2),l.qZA(),l.qZA()),2&v){const u=C.$implicit;l.uIk("aria-label",u.long),l.xp6(1),l.uIk("title",u.long),l.xp6(1),l.Oqu(u.narrow)}}const $t=["*"];function Xt(v,C){}function en(v,C){if(1&v){const u=l.EpF();l.TgZ(0,"mat-month-view",5),l.NdJ("activeDateChange",function(_){return l.CHM(u),l.oxw().activeDate=_})("_userSelection",function(_){return l.CHM(u),l.oxw()._dateSelected(_)}),l.qZA()}if(2&v){const u=l.oxw();l.Q6J("activeDate",u.activeDate)("selected",u.selected)("dateFilter",u.dateFilter)("maxDate",u.maxDate)("minDate",u.minDate)("dateClass",u.dateClass)("comparisonStart",u.comparisonStart)("comparisonEnd",u.comparisonEnd)}}function tn(v,C){if(1&v){const u=l.EpF();l.TgZ(0,"mat-year-view",6),l.NdJ("activeDateChange",function(_){return l.CHM(u),l.oxw().activeDate=_})("monthSelected",function(_){return l.CHM(u),l.oxw()._monthSelectedInYearView(_)})("selectedChange",function(_){return l.CHM(u),l.oxw()._goToDateInView(_,"month")}),l.qZA()}if(2&v){const u=l.oxw();l.Q6J("activeDate",u.activeDate)("selected",u.selected)("dateFilter",u.dateFilter)("maxDate",u.maxDate)("minDate",u.minDate)("dateClass",u.dateClass)}}function Ut(v,C){if(1&v){const u=l.EpF();l.TgZ(0,"mat-multi-year-view",7),l.NdJ("activeDateChange",function(_){return l.CHM(u),l.oxw().activeDate=_})("yearSelected",function(_){return l.CHM(u),l.oxw()._yearSelectedInMultiYearView(_)})("selectedChange",function(_){return l.CHM(u),l.oxw()._goToDateInView(_,"year")}),l.qZA()}if(2&v){const u=l.oxw();l.Q6J("activeDate",u.activeDate)("selected",u.selected)("dateFilter",u.dateFilter)("maxDate",u.maxDate)("minDate",u.minDate)("dateClass",u.dateClass)}}function Ot(v,C){}const nn=["button"];function rn(v,C){1&v&&(l.O4$(),l.TgZ(0,"svg",3),l._UZ(1,"path",4),l.qZA())}const J=[[["","matDatepickerToggleIcon",""]]],oe=["[matDatepickerToggleIcon]"];class vt{constructor(C,u,h,_,x={},U=C,le){this.value=C,this.displayValue=u,this.ariaLabel=h,this.enabled=_,this.cssClasses=x,this.compareValue=U,this.rawValue=le}}let Ge=(()=>{class v{constructor(u,h){this._elementRef=u,this._ngZone=h,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new l.vpe,this.previewChange=new l.vpe,this._enterHandler=_=>{if(this._skipNextFocus&&"focus"===_.type)this._skipNextFocus=!1;else if(_.target&&this.isRange){const x=this._getCellFromElement(_.target);x&&this._ngZone.run(()=>this.previewChange.emit({value:x.enabled?x:null,event:_}))}},this._leaveHandler=_=>{null!==this.previewEnd&&this.isRange&&_.target&&bt(_.target)&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:_}))},h.runOutsideAngular(()=>{const _=u.nativeElement;_.addEventListener("mouseenter",this._enterHandler,!0),_.addEventListener("focus",this._enterHandler,!0),_.addEventListener("mouseleave",this._leaveHandler,!0),_.addEventListener("blur",this._leaveHandler,!0)})}_cellClicked(u,h){u.enabled&&this.selectedValueChange.emit({value:u.value,event:h})}_isSelected(u){return this.startValue===u||this.endValue===u}ngOnChanges(u){const h=u.numCols,{rows:_,numCols:x}=this;(u.rows||h)&&(this._firstRowOffset=_&&_.length&&_[0].length?x-_[0].length:0),(u.cellAspectRatio||h||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/x+"%"),(h||!this._cellWidth)&&(this._cellWidth=100/x+"%")}ngOnDestroy(){const u=this._elementRef.nativeElement;u.removeEventListener("mouseenter",this._enterHandler,!0),u.removeEventListener("focus",this._enterHandler,!0),u.removeEventListener("mouseleave",this._leaveHandler,!0),u.removeEventListener("blur",this._leaveHandler,!0)}_isActiveCell(u,h){let _=u*this.numCols+h;return u&&(_-=this._firstRowOffset),_==this.activeCell}_focusActiveCell(u=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,Oe.q)(1)).subscribe(()=>{const h=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");h&&(u||(this._skipNextFocus=!0),h.focus())})})}_isRangeStart(u){return dt(u,this.startValue,this.endValue)}_isRangeEnd(u){return Nt(u,this.startValue,this.endValue)}_isInRange(u){return on(u,this.startValue,this.endValue,this.isRange)}_isComparisonStart(u){return dt(u,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(u,h,_){if(!this._isComparisonStart(u)||this._isRangeStart(u)||!this._isInRange(u))return!1;let x=this.rows[h][_-1];if(!x){const U=this.rows[h-1];x=U&&U[U.length-1]}return x&&!this._isRangeEnd(x.compareValue)}_isComparisonBridgeEnd(u,h,_){if(!this._isComparisonEnd(u)||this._isRangeEnd(u)||!this._isInRange(u))return!1;let x=this.rows[h][_+1];if(!x){const U=this.rows[h+1];x=U&&U[0]}return x&&!this._isRangeStart(x.compareValue)}_isComparisonEnd(u){return Nt(u,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(u){return on(u,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(u){return this.comparisonStart===this.comparisonEnd&&u===this.comparisonStart}_isPreviewStart(u){return dt(u,this.previewStart,this.previewEnd)}_isPreviewEnd(u){return Nt(u,this.previewStart,this.previewEnd)}_isInPreview(u){return on(u,this.previewStart,this.previewEnd,this.isRange)}_getCellFromElement(u){let h;if(bt(u)?h=u:bt(u.parentNode)&&(h=u.parentNode),h){const _=h.getAttribute("data-mat-row"),x=h.getAttribute("data-mat-col");if(_&&x)return this.rows[parseInt(_)][parseInt(x)]}return null}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(l.SBq),l.Y36(l.R0b))},v.\u0275cmp=l.Xpm({type:v,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange"},exportAs:["matCalendarBody"],features:[l.TTD],attrs:Ze,decls:2,vars:2,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell",3,"ngClass","tabindex","mat-calendar-body-disabled","mat-calendar-body-active","mat-calendar-body-range-start","mat-calendar-body-range-end","mat-calendar-body-in-range","mat-calendar-body-comparison-bridge-start","mat-calendar-body-comparison-bridge-end","mat-calendar-body-comparison-start","mat-calendar-body-comparison-end","mat-calendar-body-in-comparison-range","mat-calendar-body-preview-start","mat-calendar-body-preview-end","mat-calendar-body-in-preview","width","paddingTop","paddingBottom","click",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],[1,"mat-calendar-body-cell-preview"]],template:function(u,h){1&u&&(l.YNc(0,nt,3,6,"tr",0),l.YNc(1,ct,3,2,"tr",1)),2&u&&(l.Q6J("ngIf",h._firstRowOffset<h.labelMinRequiredCells),l.xp6(1),l.Q6J("ngForOf",h.rows))},directives:[X.O5,X.sg,X.mk],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%}.mat-calendar-body-cell{position:relative;height:0;line-height:0;text-align:center;outline:none;cursor:pointer}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected),.cdk-high-contrast-active .cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected){outline:dotted 2px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}\n'],encapsulation:2,changeDetection:0}),v})();function bt(v){return"TD"===v.nodeName}function dt(v,C,u){return null!==u&&C!==u&&v<u&&v===C}function Nt(v,C,u){return null!==C&&C!==u&&v>=C&&v===u}function on(v,C,u,h){return h&&null!==C&&null!==u&&C!==u&&v>=C&&v<=u}class Ae{constructor(C,u){this.start=C,this.end=u}}let De=(()=>{class v{constructor(u,h){this.selection=u,this._adapter=h,this._selectionChanged=new re.xQ,this.selectionChanged=this._selectionChanged,this.selection=u}updateSelection(u,h){const _=this.selection;this.selection=u,this._selectionChanged.next({selection:u,source:h,oldValue:_})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(u){return this._adapter.isDateInstance(u)&&this._adapter.isValid(u)}}return v.\u0275fac=function(u){l.$Z()},v.\u0275prov=l.Yz7({token:v,factory:v.\u0275fac}),v})(),Yt=(()=>{class v extends De{constructor(u){super(null,u)}add(u){super.updateSelection(u,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const u=new v(this._adapter);return u.updateSelection(this.selection,this),u}}return v.\u0275fac=function(u){return new(u||v)(l.LFG(j._A))},v.\u0275prov=l.Yz7({token:v,factory:v.\u0275fac}),v})();const Ht={provide:De,deps:[[new l.FiY,new l.tp0,De],j._A],useFactory:function(v,C){return v||new Yt(C)}},Jt=new l.OlP("MAT_DATE_RANGE_SELECTION_STRATEGY");let yn=(()=>{class v{constructor(u,h,_,x,U){this._changeDetectorRef=u,this._dateFormats=h,this._dateAdapter=_,this._dir=x,this._rangeStrategy=U,this._rerenderSubscription=ce.w.EMPTY,this.selectedChange=new l.vpe,this._userSelection=new l.vpe,this.activeDateChange=new l.vpe,this._activeDate=this._dateAdapter.today()}get activeDate(){return this._activeDate}set activeDate(u){const h=this._activeDate,_=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(_,this.minDate,this.maxDate),this._hasSameMonthAndYear(h,this._activeDate)||this._init()}get selected(){return this._selected}set selected(u){this._selected=u instanceof Ae?u:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(u){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}get maxDate(){return this._maxDate}set maxDate(u){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe((0,Ce.O)(null)).subscribe(()=>this._init())}ngOnChanges(u){const h=u.comparisonStart||u.comparisonEnd;h&&!h.firstChange&&this._setRanges(this.selected)}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(u){const h=u.value,_=this._dateAdapter.getYear(this.activeDate),x=this._dateAdapter.getMonth(this.activeDate),U=this._dateAdapter.createDate(_,x,h);let le,pt;this._selected instanceof Ae?(le=this._getDateInCurrentMonth(this._selected.start),pt=this._getDateInCurrentMonth(this._selected.end)):le=pt=this._getDateInCurrentMonth(this._selected),(le!==h||pt!==h)&&this.selectedChange.emit(U),this._userSelection.emit({value:U,event:u.event}),this._previewStart=this._previewEnd=null,this._changeDetectorRef.markForCheck()}_handleCalendarBodyKeydown(u){const h=this._activeDate,_=this._isRtl();switch(u.keyCode){case W.oh:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,_?1:-1);break;case W.SV:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,_?-1:1);break;case W.LH:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case W.JH:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case W.Sd:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case W.uR:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case W.Ku:this.activeDate=u.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case W.VM:this.activeDate=u.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case W.K5:case W.L_:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&u.preventDefault());case W.hY:return void(null!=this._previewEnd&&!(0,W.Vb)(u)&&(this._previewStart=this._previewEnd=null,this.selectedChange.emit(null),this._userSelection.emit({value:null,event:u}),u.preventDefault(),u.stopPropagation()));default:return}this._dateAdapter.compareDate(h,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCell(),u.preventDefault()}_handleCalendarBodyKeyup(u){(u.keyCode===W.L_||u.keyCode===W.K5)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:u}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let u=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(u)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(u){this._matCalendarBody._focusActiveCell(u)}_previewChanged({event:u,value:h}){if(this._rangeStrategy){const x=this._rangeStrategy.createPreview(h?h.rawValue:null,this.selected,u);this._previewStart=this._getCellCompareValue(x.start),this._previewEnd=this._getCellCompareValue(x.end),this._changeDetectorRef.detectChanges()}}_initWeekdays(){const u=this._dateAdapter.getFirstDayOfWeek(),h=this._dateAdapter.getDayOfWeekNames("narrow");let x=this._dateAdapter.getDayOfWeekNames("long").map((U,le)=>({long:U,narrow:h[le]}));this._weekdays=x.slice(u).concat(x.slice(0,u))}_createWeekCells(){const u=this._dateAdapter.getNumDaysInMonth(this.activeDate),h=this._dateAdapter.getDateNames();this._weeks=[[]];for(let _=0,x=this._firstWeekOffset;_<u;_++,x++){7==x&&(this._weeks.push([]),x=0);const U=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),_+1),le=this._shouldEnableDate(U),pt=this._dateAdapter.format(U,this._dateFormats.display.dateA11yLabel),Mn=this.dateClass?this.dateClass(U,"month"):void 0;this._weeks[this._weeks.length-1].push(new vt(_+1,h[_],pt,le,Mn,this._getCellCompareValue(U),U))}}_shouldEnableDate(u){return!!u&&(!this.minDate||this._dateAdapter.compareDate(u,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(u,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(u))}_getDateInCurrentMonth(u){return u&&this._hasSameMonthAndYear(u,this.activeDate)?this._dateAdapter.getDate(u):null}_hasSameMonthAndYear(u,h){return!(!u||!h||this._dateAdapter.getMonth(u)!=this._dateAdapter.getMonth(h)||this._dateAdapter.getYear(u)!=this._dateAdapter.getYear(h))}_getCellCompareValue(u){if(u){const h=this._dateAdapter.getYear(u),_=this._dateAdapter.getMonth(u),x=this._dateAdapter.getDate(u);return new Date(h,_,x).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(u){u instanceof Ae?(this._rangeStart=this._getCellCompareValue(u.start),this._rangeEnd=this._getCellCompareValue(u.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(u),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(u){return!this.dateFilter||this.dateFilter(u)}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(l.sBO),l.Y36(j.sG,8),l.Y36(j._A,8),l.Y36(O.Is,8),l.Y36(Jt,8))},v.\u0275cmp=l.Xpm({type:v,selectors:[["mat-month-view"]],viewQuery:function(u,h){if(1&u&&l.Gf(Ge,5),2&u){let _;l.iGM(_=l.CRH())&&(h._matCalendarBody=_.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[l.TTD],decls:7,vars:13,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","selectedValueChange","previewChange","keyup","keydown"],["scope","col"],[1,"mat-calendar-abbr"]],template:function(u,h){1&u&&(l.TgZ(0,"table",0),l.TgZ(1,"thead",1),l.TgZ(2,"tr"),l.YNc(3,qt,3,3,"th",2),l.qZA(),l.TgZ(4,"tr"),l._UZ(5,"th",3),l.qZA(),l.qZA(),l.TgZ(6,"tbody",4),l.NdJ("selectedValueChange",function(x){return h._dateSelected(x)})("previewChange",function(x){return h._previewChanged(x)})("keyup",function(x){return h._handleCalendarBodyKeyup(x)})("keydown",function(x){return h._handleCalendarBodyKeydown(x)}),l.qZA(),l.qZA()),2&u&&(l.xp6(3),l.Q6J("ngForOf",h._weekdays),l.xp6(3),l.Q6J("label",h._monthLabel)("rows",h._weeks)("todayValue",h._todayDate)("startValue",h._rangeStart)("endValue",h._rangeEnd)("comparisonStart",h._comparisonRangeStart)("comparisonEnd",h._comparisonRangeEnd)("previewStart",h._previewStart)("previewEnd",h._previewEnd)("isRange",h._isRange)("labelMinRequiredCells",3)("activeCell",h._dateAdapter.getDate(h.activeDate)-1))},directives:[X.sg,Ge],encapsulation:2,changeDetection:0}),v})(),xn=(()=>{class v{constructor(u,h,_){this._changeDetectorRef=u,this._dateAdapter=h,this._dir=_,this._rerenderSubscription=ce.w.EMPTY,this.selectedChange=new l.vpe,this.yearSelected=new l.vpe,this.activeDateChange=new l.vpe,this._activeDate=this._dateAdapter.today()}get activeDate(){return this._activeDate}set activeDate(u){let h=this._activeDate;const _=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(_,this.minDate,this.maxDate),Cn(this._dateAdapter,h,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(u){this._selected=u instanceof Ae?u:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u)),this._setSelectedYear(u)}get minDate(){return this._minDate}set minDate(u){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}get maxDate(){return this._maxDate}set maxDate(u){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe((0,Ce.O)(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const h=this._dateAdapter.getYear(this._activeDate)-Pt(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let _=0,x=[];_<24;_++)x.push(h+_),4==x.length&&(this._years.push(x.map(U=>this._createCellForYear(U))),x=[]);this._changeDetectorRef.markForCheck()}_yearSelected(u){const h=u.value;this.yearSelected.emit(this._dateAdapter.createDate(h,0,1));let _=this._dateAdapter.getMonth(this.activeDate),x=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(h,_,1));this.selectedChange.emit(this._dateAdapter.createDate(h,_,Math.min(this._dateAdapter.getDate(this.activeDate),x)))}_handleCalendarBodyKeydown(u){const h=this._activeDate,_=this._isRtl();switch(u.keyCode){case W.oh:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,_?1:-1);break;case W.SV:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,_?-1:1);break;case W.LH:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case W.JH:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case W.Sd:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-Pt(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case W.uR:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,24-Pt(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case W.Ku:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,u.altKey?-240:-24);break;case W.VM:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,u.altKey?240:24);break;case W.K5:case W.L_:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(h,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCell(),u.preventDefault()}_handleCalendarBodyKeyup(u){(u.keyCode===W.L_||u.keyCode===W.K5)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:u}),this._selectionKeyPressed=!1)}_getActiveCell(){return Pt(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_createCellForYear(u){const h=this._dateAdapter.createDate(u,0,1),_=this._dateAdapter.getYearName(h),x=this.dateClass?this.dateClass(h,"multi-year"):void 0;return new vt(u,_,_,this._shouldEnableYear(u),x)}_shouldEnableYear(u){if(null==u||this.maxDate&&u>this._dateAdapter.getYear(this.maxDate)||this.minDate&&u<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let _=this._dateAdapter.createDate(u,0,1);this._dateAdapter.getYear(_)==u;_=this._dateAdapter.addCalendarDays(_,1))if(this.dateFilter(_))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(u){if(this._selectedYear=null,u instanceof Ae){const h=u.start||u.end;h&&(this._selectedYear=this._dateAdapter.getYear(h))}else u&&(this._selectedYear=this._dateAdapter.getYear(u))}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(l.sBO),l.Y36(j._A,8),l.Y36(O.Is,8))},v.\u0275cmp=l.Xpm({type:v,selectors:[["mat-multi-year-view"]],viewQuery:function(u,h){if(1&u&&l.Gf(Ge,5),2&u){let _;l.iGM(_=l.CRH())&&(h._matCalendarBody=_.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","keyup","keydown"]],template:function(u,h){1&u&&(l.TgZ(0,"table",0),l.TgZ(1,"thead",1),l.TgZ(2,"tr"),l._UZ(3,"th",2),l.qZA(),l.qZA(),l.TgZ(4,"tbody",3),l.NdJ("selectedValueChange",function(x){return h._yearSelected(x)})("keyup",function(x){return h._handleCalendarBodyKeyup(x)})("keydown",function(x){return h._handleCalendarBodyKeydown(x)}),l.qZA(),l.qZA()),2&u&&(l.xp6(4),l.Q6J("rows",h._years)("todayValue",h._todayYear)("startValue",h._selectedYear)("endValue",h._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",h._getActiveCell()))},directives:[Ge],encapsulation:2,changeDetection:0}),v})();function Cn(v,C,u,h,_){const x=v.getYear(C),U=v.getYear(u),le=M(v,h,_);return Math.floor((x-le)/24)===Math.floor((U-le)/24)}function Pt(v,C,u,h){return function(v,C){return(v%24+24)%24}(v.getYear(C)-M(v,u,h))}function M(v,C,u){let h=0;return u?h=v.getYear(u)-24+1:C&&(h=v.getYear(C)),h}let S=(()=>{class v{constructor(u,h,_,x){this._changeDetectorRef=u,this._dateFormats=h,this._dateAdapter=_,this._dir=x,this._rerenderSubscription=ce.w.EMPTY,this.selectedChange=new l.vpe,this.monthSelected=new l.vpe,this.activeDateChange=new l.vpe,this._activeDate=this._dateAdapter.today()}get activeDate(){return this._activeDate}set activeDate(u){let h=this._activeDate;const _=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(_,this.minDate,this.maxDate),this._dateAdapter.getYear(h)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(u){this._selected=u instanceof Ae?u:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u)),this._setSelectedMonth(u)}get minDate(){return this._minDate}set minDate(u){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}get maxDate(){return this._maxDate}set maxDate(u){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe((0,Ce.O)(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(u){const h=u.value,_=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),h,1);this.monthSelected.emit(_);const x=this._dateAdapter.getNumDaysInMonth(_);this.selectedChange.emit(this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),h,Math.min(this._dateAdapter.getDate(this.activeDate),x)))}_handleCalendarBodyKeydown(u){const h=this._activeDate,_=this._isRtl();switch(u.keyCode){case W.oh:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,_?1:-1);break;case W.SV:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,_?-1:1);break;case W.LH:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case W.JH:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case W.Sd:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case W.uR:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case W.Ku:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,u.altKey?-10:-1);break;case W.VM:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,u.altKey?10:1);break;case W.K5:case W.L_:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(h,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCell(),u.preventDefault()}_handleCalendarBodyKeyup(u){(u.keyCode===W.L_||u.keyCode===W.K5)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:u}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let u=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(h=>h.map(_=>this._createCellForMonth(_,u[_]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_getMonthInCurrentYear(u){return u&&this._dateAdapter.getYear(u)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(u):null}_createCellForMonth(u,h){const _=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),u,1),x=this._dateAdapter.format(_,this._dateFormats.display.monthYearA11yLabel),U=this.dateClass?this.dateClass(_,"year"):void 0;return new vt(u,h.toLocaleUpperCase(),x,this._shouldEnableMonth(u),U)}_shouldEnableMonth(u){const h=this._dateAdapter.getYear(this.activeDate);if(null==u||this._isYearAndMonthAfterMaxDate(h,u)||this._isYearAndMonthBeforeMinDate(h,u))return!1;if(!this.dateFilter)return!0;for(let x=this._dateAdapter.createDate(h,u,1);this._dateAdapter.getMonth(x)==u;x=this._dateAdapter.addCalendarDays(x,1))if(this.dateFilter(x))return!0;return!1}_isYearAndMonthAfterMaxDate(u,h){if(this.maxDate){const _=this._dateAdapter.getYear(this.maxDate),x=this._dateAdapter.getMonth(this.maxDate);return u>_||u===_&&h>x}return!1}_isYearAndMonthBeforeMinDate(u,h){if(this.minDate){const _=this._dateAdapter.getYear(this.minDate),x=this._dateAdapter.getMonth(this.minDate);return u<_||u===_&&h<x}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(u){this._selectedMonth=u instanceof Ae?this._getMonthInCurrentYear(u.start)||this._getMonthInCurrentYear(u.end):this._getMonthInCurrentYear(u)}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(l.sBO),l.Y36(j.sG,8),l.Y36(j._A,8),l.Y36(O.Is,8))},v.\u0275cmp=l.Xpm({type:v,selectors:[["mat-year-view"]],viewQuery:function(u,h){if(1&u&&l.Gf(Ge,5),2&u){let _;l.iGM(_=l.CRH())&&(h._matCalendarBody=_.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","keyup","keydown"]],template:function(u,h){1&u&&(l.TgZ(0,"table",0),l.TgZ(1,"thead",1),l.TgZ(2,"tr"),l._UZ(3,"th",2),l.qZA(),l.qZA(),l.TgZ(4,"tbody",3),l.NdJ("selectedValueChange",function(x){return h._monthSelected(x)})("keyup",function(x){return h._handleCalendarBodyKeyup(x)})("keydown",function(x){return h._handleCalendarBodyKeydown(x)}),l.qZA(),l.qZA()),2&u&&(l.xp6(4),l.Q6J("label",h._yearLabel)("rows",h._months)("todayValue",h._todayMonth)("startValue",h._selectedMonth)("endValue",h._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",h._dateAdapter.getMonth(h.activeDate)))},directives:[Ge],encapsulation:2,changeDetection:0}),v})(),V=(()=>{class v{constructor(){this.changes=new re.xQ,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}formatYearRange(u,h){return`${u} \u2013 ${h}`}}return v.\u0275fac=function(u){return new(u||v)},v.\u0275prov=l.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})(),$=0,ue=(()=>{class v{constructor(u,h,_,x,U){this._intl=u,this.calendar=h,this._dateAdapter=_,this._dateFormats=x,this._buttonDescriptionId="mat-calendar-button-"+$++,this.calendar.stateChanges.subscribe(()=>U.markForCheck())}get periodButtonText(){if("month"==this.calendar.currentView)return this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase();if("year"==this.calendar.currentView)return this._dateAdapter.getYearName(this.calendar.activeDate);const h=this._dateAdapter.getYear(this.calendar.activeDate)-Pt(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),_=h+24-1,x=this._dateAdapter.getYearName(this._dateAdapter.createDate(h,0,1)),U=this._dateAdapter.getYearName(this._dateAdapter.createDate(_,0,1));return this._intl.formatYearRange(x,U)}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-24)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:24)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(u,h){return"month"==this.calendar.currentView?this._dateAdapter.getYear(u)==this._dateAdapter.getYear(h)&&this._dateAdapter.getMonth(u)==this._dateAdapter.getMonth(h):"year"==this.calendar.currentView?this._dateAdapter.getYear(u)==this._dateAdapter.getYear(h):Cn(this._dateAdapter,u,h,this.calendar.minDate,this.calendar.maxDate)}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(V),l.Y36((0,l.Gpc)(()=>ut)),l.Y36(j._A,8),l.Y36(j.sG,8),l.Y36(l.sBO))},v.\u0275cmp=l.Xpm({type:v,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:$t,decls:11,vars:10,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","cdkAriaLive","polite",1,"mat-calendar-period-button",3,"click"],["viewBox","0 0 10 5","focusable","false",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"]],template:function(u,h){1&u&&(l.F$t(),l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.TgZ(2,"button",2),l.NdJ("click",function(){return h.currentPeriodClicked()}),l.TgZ(3,"span"),l._uU(4),l.qZA(),l.O4$(),l.TgZ(5,"svg",3),l._UZ(6,"polygon",4),l.qZA(),l.qZA(),l.kcU(),l._UZ(7,"div",5),l.Hsn(8),l.TgZ(9,"button",6),l.NdJ("click",function(){return h.previousClicked()}),l.qZA(),l.TgZ(10,"button",7),l.NdJ("click",function(){return h.nextClicked()}),l.qZA(),l.qZA(),l.qZA()),2&u&&(l.xp6(2),l.uIk("aria-label",h.periodButtonLabel)("aria-describedby",h._buttonDescriptionId),l.xp6(1),l.uIk("id",h._buttonDescriptionId),l.xp6(1),l.Oqu(h.periodButtonText),l.xp6(1),l.ekj("mat-calendar-invert","month"!==h.calendar.currentView),l.xp6(4),l.Q6J("disabled",!h.previousEnabled()),l.uIk("aria-label",h.prevButtonLabel),l.xp6(1),l.Q6J("disabled",!h.nextEnabled()),l.uIk("aria-label",h.nextButtonLabel))},directives:[ve.lW,B.Qr],encapsulation:2,changeDetection:0}),v})(),ut=(()=>{class v{constructor(u,h,_,x){this._dateAdapter=h,this._dateFormats=_,this._changeDetectorRef=x,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new l.vpe,this.yearSelected=new l.vpe,this.monthSelected=new l.vpe,this.viewChanged=new l.vpe(!0),this._userSelection=new l.vpe,this.stateChanges=new re.xQ,this._intlChanges=u.changes.subscribe(()=>{x.markForCheck(),this.stateChanges.next()})}get startAt(){return this._startAt}set startAt(u){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}get selected(){return this._selected}set selected(u){this._selected=u instanceof Ae?u:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}get minDate(){return this._minDate}set minDate(u){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}get maxDate(){return this._maxDate}set maxDate(u){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}get activeDate(){return this._clampedActiveDate}set activeDate(u){this._clampedActiveDate=this._dateAdapter.clampDate(u,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(u){const h=this._currentView!==u?u:null;this._currentView=u,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),h&&this.viewChanged.emit(h)}ngAfterContentInit(){this._calendarHeaderPortal=new he.C5(this.headerComponent||ue),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(u){const h=u.minDate||u.maxDate||u.dateFilter;if(h&&!h.firstChange){const _=this._getCurrentViewComponent();_&&(this._changeDetectorRef.detectChanges(),_._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(u){const h=u.value;(this.selected instanceof Ae||h&&!this._dateAdapter.sameDate(h,this.selected))&&this.selectedChange.emit(h),this._userSelection.emit(u)}_yearSelectedInMultiYearView(u){this.yearSelected.emit(u)}_monthSelectedInYearView(u){this.monthSelected.emit(u)}_goToDateInView(u,h){this.activeDate=u,this.currentView=h}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(V),l.Y36(j._A,8),l.Y36(j.sG,8),l.Y36(l.sBO))},v.\u0275cmp=l.Xpm({type:v,selectors:[["mat-calendar"]],viewQuery:function(u,h){if(1&u&&(l.Gf(yn,5),l.Gf(S,5),l.Gf(xn,5)),2&u){let _;l.iGM(_=l.CRH())&&(h.monthView=_.first),l.iGM(_=l.CRH())&&(h.yearView=_.first),l.iGM(_=l.CRH())&&(h.multiYearView=_.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection"},exportAs:["matCalendar"],features:[l._Bn([Ht]),l.TTD],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","activeDateChange","_userSelection",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","activeDateChange","_userSelection"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(u,h){1&u&&(l.YNc(0,Xt,0,0,"ng-template",0),l.TgZ(1,"div",1),l.YNc(2,en,1,8,"mat-month-view",2),l.YNc(3,tn,1,6,"mat-year-view",3),l.YNc(4,Ut,1,6,"mat-multi-year-view",4),l.qZA()),2&u&&(l.Q6J("cdkPortalOutlet",h._calendarHeaderPortal),l.xp6(1),l.Q6J("ngSwitch",h.currentView),l.xp6(1),l.Q6J("ngSwitchCase","month"),l.xp6(1),l.Q6J("ngSwitchCase","year"),l.xp6(1),l.Q6J("ngSwitchCase","multi-year"))},directives:[he.Pl,B.kH,X.RF,X.n9,yn,S,xn],styles:['.mat-calendar{display:block}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-controls .mat-icon-button:hover .mat-button-focus-overlay{opacity:.04}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px}.mat-calendar-abbr{text-decoration:none}\n'],encapsulation:2,changeDetection:0}),v})();const yt={transformPanel:(0,K.X$)("transformPanel",[(0,K.eR)("void => enter-dropdown",(0,K.jt)("120ms cubic-bezier(0, 0, 0.2, 1)",(0,K.F4)([(0,K.oB)({opacity:0,transform:"scale(1, 0.8)"}),(0,K.oB)({opacity:1,transform:"scale(1, 1)"})]))),(0,K.eR)("void => enter-dialog",(0,K.jt)("150ms cubic-bezier(0, 0, 0.2, 1)",(0,K.F4)([(0,K.oB)({opacity:0,transform:"scale(0.7)"}),(0,K.oB)({transform:"none",opacity:1})]))),(0,K.eR)("* => void",(0,K.jt)("100ms linear",(0,K.oB)({opacity:0})))]),fadeInCalendar:(0,K.X$)("fadeInCalendar",[(0,K.SB)("void",(0,K.oB)({opacity:0})),(0,K.SB)("enter",(0,K.oB)({opacity:1})),(0,K.eR)("void => *",(0,K.jt)("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let Dn=0;const zt=new l.OlP("mat-datepicker-scroll-strategy"),Y={provide:zt,deps:[I.aV],useFactory:function(v){return()=>v.scrollStrategies.reposition()}},L=(0,j.pj)(class{constructor(v){this._elementRef=v}});let A=(()=>{class v extends L{constructor(u,h,_,x,U,le){super(u),this._changeDetectorRef=h,this._globalModel=_,this._dateAdapter=x,this._rangeSelectionStrategy=U,this._subscriptions=new ce.w,this._animationDone=new re.xQ,this._actionsPortal=null,this._closeButtonText=le.closeCalendarLabel}ngOnInit(){this._model=this._actionsPortal?this._globalModel.clone():this._globalModel,this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(u){const h=this._model.selection,_=u.value,x=h instanceof Ae;if(x&&this._rangeSelectionStrategy){const U=this._rangeSelectionStrategy.selectionFinished(_,h,u.event);this._model.updateSelection(U,this)}else _&&(x||!this._dateAdapter.sameDate(_,h))&&this._model.add(_);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(l.SBq),l.Y36(l.sBO),l.Y36(De),l.Y36(j._A),l.Y36(Jt,8),l.Y36(V))},v.\u0275cmp=l.Xpm({type:v,selectors:[["mat-datepicker-content"]],viewQuery:function(u,h){if(1&u&&l.Gf(ut,5),2&u){let _;l.iGM(_=l.CRH())&&(h._calendar=_.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(u,h){1&u&&l.WFA("@transformPanel.done",function(){return h._animationDone.next()}),2&u&&(l.d8E("@transformPanel",h._animationState),l.ekj("mat-datepicker-content-touch",h.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[l.qOj],decls:5,vars:20,consts:[["cdkTrapFocus","",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","yearSelected","monthSelected","viewChanged","_userSelection"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(u,h){1&u&&(l.TgZ(0,"div",0),l.TgZ(1,"mat-calendar",1),l.NdJ("yearSelected",function(x){return h.datepicker._selectYear(x)})("monthSelected",function(x){return h.datepicker._selectMonth(x)})("viewChanged",function(x){return h.datepicker._viewChanged(x)})("_userSelection",function(x){return h._handleUserSelection(x)}),l.qZA(),l.YNc(2,Ot,0,0,"ng-template",2),l.TgZ(3,"button",3),l.NdJ("focus",function(){return h._closeButtonFocused=!0})("blur",function(){return h._closeButtonFocused=!1})("click",function(){return h.datepicker.close()}),l._uU(4),l.qZA(),l.qZA()),2&u&&(l.ekj("mat-datepicker-content-container-with-actions",h._actionsPortal),l.xp6(1),l.Q6J("id",h.datepicker.id)("ngClass",h.datepicker.panelClass)("startAt",h.datepicker.startAt)("startView",h.datepicker.startView)("minDate",h.datepicker._getMinDate())("maxDate",h.datepicker._getMaxDate())("dateFilter",h.datepicker._getDateFilter())("headerComponent",h.datepicker.calendarHeaderComponent)("selected",h._getSelected())("dateClass",h.datepicker.dateClass)("comparisonStart",h.comparisonStart)("comparisonEnd",h.comparisonEnd)("@fadeInCalendar","enter"),l.xp6(1),l.Q6J("cdkPortalOutlet",h._actionsPortal),l.xp6(1),l.ekj("cdk-visually-hidden",!h._closeButtonFocused),l.Q6J("color",h.color||"primary"),l.xp6(1),l.Oqu(h._closeButtonText))},directives:[B.mK,ut,X.mk,he.Pl,ve.lW],styles:[".mat-datepicker-content{display:block;border-radius:4px}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}\n"],encapsulation:2,data:{animation:[yt.transformPanel,yt.fadeInCalendar]},changeDetection:0}),v})(),Z=(()=>{class v{constructor(u,h,_,x,U,le,pt){this._overlay=u,this._ngZone=h,this._viewContainerRef=_,this._dateAdapter=U,this._dir=le,this._model=pt,this._inputStateChanges=ce.w.EMPTY,this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new l.vpe,this.monthSelected=new l.vpe,this.viewChanged=new l.vpe(!0),this.openedStream=new l.vpe,this.closedStream=new l.vpe,this._opened=!1,this.id="mat-datepicker-"+Dn++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new re.xQ,this._scrollStrategy=x}get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(u){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(u){this._color=u}get touchUi(){return this._touchUi}set touchUi(u){this._touchUi=(0,ge.Ig)(u)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(u){const h=(0,ge.Ig)(u);h!==this._disabled&&(this._disabled=h,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(u){this._restoreFocus=(0,ge.Ig)(u)}get panelClass(){return this._panelClass}set panelClass(u){this._panelClass=(0,ge.du)(u)}get opened(){return this._opened}set opened(u){(0,ge.Ig)(u)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}ngOnChanges(u){const h=u.xPosition||u.yPosition;if(h&&!h.firstChange&&this._overlayRef){const _=this._overlayRef.getConfig().positionStrategy;_ instanceof I._G&&(this._setConnectedPositions(_),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(u){this._model.add(u)}_selectYear(u){this.yearSelected.emit(u)}_selectMonth(u){this.monthSelected.emit(u)}_viewChanged(u){this.viewChanged.emit(u)}registerInput(u){return this._inputStateChanges.unsubscribe(),this.datepickerInput=u,this._inputStateChanges=u.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(u){this._actionsPortal=u}removeActions(u){u===this._actionsPortal&&(this._actionsPortal=null)}open(){this._opened||this.disabled||(this._focusedElementBeforeOpen=(0,r.ht)(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened)return;if(this._componentRef){const h=this._componentRef.instance;h._startExitAnimation(),h._animationDone.pipe((0,Oe.q)(1)).subscribe(()=>this._destroyOverlay())}const u=()=>{this._opened&&(this._opened=!1,this.closedStream.emit(),this._focusedElementBeforeOpen=null)};this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus?(this._focusedElementBeforeOpen.focus(),setTimeout(u)):u()}_applyPendingSelection(){var u,h;null===(h=null===(u=this._componentRef)||void 0===u?void 0:u.instance)||void 0===h||h._applyPendingSelection()}_forwardContentValues(u){u.datepicker=this,u.color=this.color,u._actionsPortal=this._actionsPortal}_openOverlay(){this._destroyOverlay();const u=this.touchUi,h=this.datepickerInput.getOverlayLabelId(),_=new he.C5(A,this._viewContainerRef),x=this._overlayRef=this._overlay.create(new I.X_({positionStrategy:u?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[u?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:u?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(u?"dialog":"popup")})),U=x.overlayElement;U.setAttribute("role","dialog"),h&&U.setAttribute("aria-labelledby",h),u&&U.setAttribute("aria-modal","true"),this._getCloseStream(x).subscribe(le=>{le&&le.preventDefault(),this.close()}),this._componentRef=x.attach(_),this._forwardContentValues(this._componentRef.instance),u||this._ngZone.onStable.pipe((0,Oe.q)(1)).subscribe(()=>x.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const u=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(u)}_setConnectedPositions(u){const h="end"===this.xPosition?"end":"start",_="start"===h?"end":"start",x="above"===this.yPosition?"bottom":"top",U="top"===x?"bottom":"top";return u.withPositions([{originX:h,originY:U,overlayX:h,overlayY:x},{originX:h,originY:x,overlayX:h,overlayY:U},{originX:_,originY:U,overlayX:_,overlayY:x},{originX:_,originY:x,overlayX:_,overlayY:U}])}_getCloseStream(u){return(0,He.T)(u.backdropClick(),u.detachments(),u.keydownEvents().pipe((0,Ne.h)(h=>h.keyCode===W.hY&&!(0,W.Vb)(h)||this.datepickerInput&&(0,W.Vb)(h,"altKey")&&h.keyCode===W.LH)))}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(I.aV),l.Y36(l.R0b),l.Y36(l.s_b),l.Y36(zt),l.Y36(j._A,8),l.Y36(O.Is,8),l.Y36(De))},v.\u0275dir=l.lG2({type:v,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[l.TTD]}),v})(),P=(()=>{class v extends Z{}return v.\u0275fac=function(){let C;return function(h){return(C||(C=l.n5z(v)))(h||v)}}(),v.\u0275cmp=l.Xpm({type:v,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[l._Bn([Ht,{provide:Z,useExisting:v}]),l.qOj],decls:0,vars:0,template:function(u,h){},encapsulation:2,changeDetection:0}),v})();class ne{constructor(C,u){this.target=C,this.targetElement=u,this.value=this.target.value}}let Pe=(()=>{class v{constructor(u,h,_){this._elementRef=u,this._dateAdapter=h,this._dateFormats=_,this.dateChange=new l.vpe,this.dateInput=new l.vpe,this.stateChanges=new re.xQ,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=ce.w.EMPTY,this._localeSubscription=ce.w.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=x=>{const U=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(x.value));return!U||this._matchesFilter(U)?null:{matDatepickerFilter:!0}},this._minValidator=x=>{const U=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(x.value)),le=this._getMinDate();return!le||!U||this._dateAdapter.compareDate(le,U)<=0?null:{matDatepickerMin:{min:le,actual:U}}},this._maxValidator=x=>{const U=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(x.value)),le=this._getMaxDate();return!le||!U||this._dateAdapter.compareDate(le,U)>=0?null:{matDatepickerMax:{max:le,actual:U}}},this._lastValueValid=!1,this._localeSubscription=h.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(u){this._assignValueProgrammatically(u)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(u){const h=(0,ge.Ig)(u),_=this._elementRef.nativeElement;this._disabled!==h&&(this._disabled=h,this.stateChanges.next(void 0)),h&&this._isInitialized&&_.blur&&_.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(u){this._model=u,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(h=>{if(this._shouldHandleChangeEvent(h)){const _=this._getValueFromModel(h.selection);this._lastValueValid=this._isValidValue(_),this._cvaOnChange(_),this._onTouched(),this._formatValue(_),this.dateInput.emit(new ne(this,this._elementRef.nativeElement)),this.dateChange.emit(new ne(this,this._elementRef.nativeElement))}})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(u){(function(v,C){const u=Object.keys(v);for(let h of u){const{previousValue:_,currentValue:x}=v[h];if(!C.isDateInstance(_)||!C.isDateInstance(x))return!0;if(!C.sameDate(_,x))return!0}return!1})(u,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(u){this._validatorOnChange=u}validate(u){return this._validator?this._validator(u):null}writeValue(u){this._assignValueProgrammatically(u)}registerOnChange(u){this._cvaOnChange=u}registerOnTouched(u){this._onTouched=u}setDisabledState(u){this.disabled=u}_onKeydown(u){u.altKey&&u.keyCode===W.JH&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),u.preventDefault())}_onInput(u){const h=this._lastValueValid;let _=this._dateAdapter.parse(u,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(_),_=this._dateAdapter.getValidDateOrNull(_),this._dateAdapter.sameDate(_,this.value)?(u&&!this.value&&this._cvaOnChange(_),h!==this._lastValueValid&&this._validatorOnChange()):(this._assignValue(_),this._cvaOnChange(_),this.dateInput.emit(new ne(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new ne(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(u){this._elementRef.nativeElement.value=u?this._dateAdapter.format(u,this._dateFormats.display.dateInput):""}_assignValue(u){this._model?(this._assignValueToModel(u),this._pendingValue=null):this._pendingValue=u}_isValidValue(u){return!u||this._dateAdapter.isValid(u)}_parentDisabled(){return!1}_assignValueProgrammatically(u){u=this._dateAdapter.deserialize(u),this._lastValueValid=this._isValidValue(u),u=this._dateAdapter.getValidDateOrNull(u),this._assignValue(u),this._formatValue(u)}_matchesFilter(u){const h=this._getDateFilter();return!h||h(u)}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(l.SBq),l.Y36(j._A,8),l.Y36(j.sG,8))},v.\u0275dir=l.lG2({type:v,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[l.TTD]}),v})();const xt={provide:Je.JU,useExisting:(0,l.Gpc)(()=>Yn),multi:!0},ci={provide:Je.Cf,useExisting:(0,l.Gpc)(()=>Yn),multi:!0};let Yn=(()=>{class v extends Pe{constructor(u,h,_,x){super(u,h,_),this._formField=x,this._closedSubscription=ce.w.EMPTY,this._validator=Je.kI.compose(super._getValidators())}set matDatepicker(u){u&&(this._datepicker=u,this._closedSubscription=u.closedStream.subscribe(()=>this._onTouched()),this._registerModel(u.registerInput(this)))}get min(){return this._min}set min(u){const h=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u));this._dateAdapter.sameDate(h,this._min)||(this._min=h,this._validatorOnChange())}get max(){return this._max}set max(u){const h=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(u));this._dateAdapter.sameDate(h,this._max)||(this._max=h,this._validatorOnChange())}get dateFilter(){return this._dateFilter}set dateFilter(u){const h=this._matchesFilter(this.value);this._dateFilter=u,this._matchesFilter(this.value)!==h&&this._validatorOnChange()}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(u){return u}_assignValueToModel(u){this._model&&this._model.updateSelection(u,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(u){return u.source!==this}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(l.SBq),l.Y36(j._A,8),l.Y36(j.sG,8),l.Y36(tt.G_,8))},v.\u0275dir=l.lG2({type:v,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(u,h){1&u&&l.NdJ("input",function(x){return h._onInput(x.target.value)})("change",function(){return h._onChange()})("blur",function(){return h._onBlur()})("keydown",function(x){return h._onKeydown(x)}),2&u&&(l.Ikx("disabled",h.disabled),l.uIk("aria-haspopup",h._datepicker?"dialog":null)("aria-owns",(null==h._datepicker?null:h._datepicker.opened)&&h._datepicker.id||null)("min",h.min?h._dateAdapter.toIso8601(h.min):null)("max",h.max?h._dateAdapter.toIso8601(h.max):null)("data-mat-calendar",h._datepicker?h._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:["matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[l._Bn([xt,ci,{provide:st.Jk,useExisting:v}]),l.qOj]}),v})(),sr=(()=>{class v{}return v.\u0275fac=function(u){return new(u||v)},v.\u0275dir=l.lG2({type:v,selectors:[["","matDatepickerToggleIcon",""]]}),v})(),lr=(()=>{class v{constructor(u,h,_){this._intl=u,this._changeDetectorRef=h,this._stateChanges=ce.w.EMPTY;const x=Number(_);this.tabIndex=x||0===x?x:null}get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(u){this._disabled=(0,ge.Ig)(u)}ngOnChanges(u){u.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(u){this.datepicker&&!this.disabled&&(this.datepicker.open(),u.stopPropagation())}_watchStateChanges(){const u=this.datepicker?this.datepicker.stateChanges:(0,at.of)(),h=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:(0,at.of)(),_=this.datepicker?(0,He.T)(this.datepicker.openedStream,this.datepicker.closedStream):(0,at.of)();this._stateChanges.unsubscribe(),this._stateChanges=(0,He.T)(this._intl.changes,u,h,_).subscribe(()=>this._changeDetectorRef.markForCheck())}}return v.\u0275fac=function(u){return new(u||v)(l.Y36(V),l.Y36(l.sBO),l.$8M("tabindex"))},v.\u0275cmp=l.Xpm({type:v,selectors:[["mat-datepicker-toggle"]],contentQueries:function(u,h,_){if(1&u&&l.Suo(_,sr,5),2&u){let x;l.iGM(x=l.CRH())&&(h._customIcon=x.first)}},viewQuery:function(u,h){if(1&u&&l.Gf(nn,5),2&u){let _;l.iGM(_=l.CRH())&&(h._button=_.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(u,h){1&u&&l.NdJ("click",function(x){return h._open(x)}),2&u&&(l.uIk("tabindex",null)("data-mat-calendar",h.datepicker?h.datepicker.id:null),l.ekj("mat-datepicker-toggle-active",h.datepicker&&h.datepicker.opened)("mat-accent",h.datepicker&&"accent"===h.datepicker.color)("mat-warn",h.datepicker&&"warn"===h.datepicker.color))},inputs:{datepicker:["for","datepicker"],tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],disabled:"disabled",disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[l.TTD],ngContentSelectors:oe,decls:4,vars:6,consts:[["mat-icon-button","","type","button",3,"disabled","disableRipple"],["button",""],["class","mat-datepicker-toggle-default-icon","viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",4,"ngIf"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(u,h){1&u&&(l.F$t(J),l.TgZ(0,"button",0,1),l.YNc(2,rn,2,0,"svg",2),l.Hsn(3),l.qZA()),2&u&&(l.Q6J("disabled",h.disabled)("disableRipple",h.disableRipple),l.uIk("aria-haspopup",h.datepicker?"dialog":null)("aria-label",h.ariaLabel||h._intl.openCalendarLabel)("tabindex",h.disabled?-1:h.tabIndex),l.xp6(2),l.Q6J("ngIf",!h._customIcon))},directives:[ve.lW,X.O5],styles:[".mat-form-field-appearance-legacy .mat-form-field-prefix .mat-datepicker-toggle-default-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-datepicker-toggle-default-icon{width:1em}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-datepicker-toggle-default-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-datepicker-toggle-default-icon{display:block;width:1.5em;height:1.5em}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-datepicker-toggle-default-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-datepicker-toggle-default-icon{margin:auto}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}\n"],encapsulation:2,changeDetection:0}),v})(),Hn=(()=>{class v{}return v.\u0275fac=function(u){return new(u||v)},v.\u0275mod=l.oAB({type:v}),v.\u0275inj=l.cJS({providers:[V,Y],imports:[[X.ez,ve.ot,I.U8,B.rt,he.eL,j.BQ],Se.ZD]}),v})()}}]);